(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("Clappr"));
	else if(typeof define === 'function' && define.amd)
		define(["Clappr"], factory);
	else if(typeof exports === 'object')
		exports["ClapprDashShaka"] = factory(require("Clappr"));
	else
		root["ClapprDashShaka"] = factory(root["Clappr"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=(function(){function defineProperties(target,props){for(var i=0;i < props.length;i++) {var descriptor=props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if('value' in descriptor)descriptor.writable = true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};})();var _get=function get(_x,_x2,_x3){var _again=true;_function: while(_again) {var object=_x,property=_x2,receiver=_x3;_again = false;if(object === null)object = Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc === undefined){var parent=Object.getPrototypeOf(object);if(parent === null){return undefined;}else {_x = parent;_x2 = property;_x3 = receiver;_again = true;desc = parent = undefined;continue _function;}}else if('value' in desc){return desc.value;}else {var getter=desc.get;if(getter === undefined){return undefined;}return getter.call(receiver);}}};function _interopRequireDefault(obj){return obj && obj.__esModule?obj:{'default':obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function');}}function _inherits(subClass,superClass){if(typeof superClass !== 'function' && superClass !== null){throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__ = superClass;}var _clappr=__webpack_require__(1);var _shakaPlayer=__webpack_require__(2);var _shakaPlayer2=_interopRequireDefault(_shakaPlayer);var ClapprDashShaka=(function(_HTML5Video){_inherits(ClapprDashShaka,_HTML5Video);function ClapprDashShaka(options){_classCallCheck(this,ClapprDashShaka);_get(Object.getPrototypeOf(ClapprDashShaka.prototype),'constructor',this).call(this,options);this._setup();} // skipping ready event on video tag in favor of ready on shaka
	_createClass(ClapprDashShaka,[{key:'ready',value:function ready(){} // skipping buffering handling on video tag in favor of buffering on shaka
	},{key:'bufferFull',value:function bufferFull(){} // skipping error handling on video tag in favor of error on shaka
	},{key:'error',value:function error(event){_clappr.Log.error('an error was raised by the video tag',event,this.el.error);} // shouldn't we be open to 4k 8k ... something like isDefinitionInUse("HD" || VideoDefinition.V4K)
	},{key:'isHighDefinitionInUse',value:function isHighDefinitionInUse(){return !!this.highDefinition;} // I think we should enforce PlaybackType.LIVE and VOD (maybe) I documented it wront as it was for name
	},{key:'getPlaybackType',value:function getPlaybackType(){return this._player && (this._player.isLive()?'live':'vod');}},{key:'destroy',value:function destroy(){ // should I do that on stop too? I think so... it's not pause and resume
	clearInterval(this.sendStats);this._player.destroy().then(this._destroy)['catch'](function(){return _clappr.Log.error('shaka could not be destroyed');});}},{key:'version',value:function version(){return _shakaPlayer2['default'].player.Player.version;}},{key:'_setup',value:function _setup(){var frequencyToSendStats=60 * 1000;this._player = new _shakaPlayer2['default'].player.Player(this.el);this._player.addEventListener('bufferingStart',this._bufferingHandler);this._player.addEventListener('bufferingEnd',this._bufferingFullHandler);this._player.addEventListener('error',this._error);this._player.addEventListener('adaptation',this._onAdaptation);var shakaLoaded=this._player.load(new _shakaPlayer2['default'].player.DashVideoSource(this.options.src));shakaLoaded.then(this._loaded)['catch'](this._setupError);}},{key:'_loaded',value:function _loaded(){var _this=this;this._ready();this.sendStats = setInterval(function(){_this.trigger(_clappr.Events.PLAYBACK_STATS_ADD,_this._player.getStats());},frequencyToSendStats);}},{key:'_setupError',value:function _setupError(e){this._error({detail:'shaka could not be setup: ' + e});}},{key:'_bufferingHandler',value:function _bufferingHandler(){this.trigger(_clappr.Events.PLAYBACK_BUFFERING,this.name);}},{key:'_bufferingFullHandler',value:function _bufferingFullHandler(){this.trigger(_clappr.Events.PLAYBACK_BUFFERFULL,this.name);}},{key:'_error',value:function _error(error){_clappr.Log.error('an error was raised by shaka player',error.detail);this.trigger(_clappr.Events.PLAYBACK_ERROR,error.detail,this.name);}},{key:'_onAdaptation',value:function _onAdaptation(event){if(!!event.size)return;_clappr.Log.debug('an adaptation happened: ',event);this.highDefinition = event.size.height >= 720; // define expected object from this event
	this.trigger(_clappr.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition); // define expected object from this event
	this.trigger(_clappr.Events.PLAYBACK_BITRATE,{bitrate:event.size.height});}},{key:'_destroy',value:function _destroy(){_get(Object.getPrototypeOf(ClapprDashShaka.prototype),'destroy',this).call(this);_clappr.Log.debug('shaka was destroyed');}},{key:'_ready',value:function _ready(){_get(Object.getPrototypeOf(ClapprDashShaka.prototype),'ready',this).call(this);}}]);return ClapprDashShaka;})(_clappr.HTML5Video);exports['default'] = ClapprDashShaka;ClapprDashShaka.canPlay = function(resource,mimeType){_shakaPlayer2['default'].polyfill.installAll();if(!_shakaPlayer2['default'].player.Player.isBrowserSupported()){_clappr.Log.debug('This browser does not support this video');return false;}var resourceParts=resource.split('?')[0].match(/.*\.(.*)$/) || [];return "mpd" === resourceParts[1];};module.exports = exports['default'];

/***/ },
/* 1 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_RESULT__;"use strict";(function(){var g={};(function(window){var l,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0] in d || !d.execScript || d.execScript("var " + c[0]);for(var e;c.length && (e = c.shift());) c.length || void 0 === b?d[e]?d = d[e]:d = d[e] = {}:d[e] = b;}function q(a,b){function c(){}c.prototype = b.prototype;a.Ob = b.prototype;a.prototype = new c();a.prototype.constructor = a;a.Mb = function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2));};}; /*

	 Copyright 2015 Google Inc.

	 Licensed under the Apache License, Version 2.0 (the "License");
	 you may not use this file except in compliance with the License.
	 You may obtain a copy of the License at

	     http://www.apache.org/licenses/LICENSE-2.0

	 Unless required by applicable law or agreed to in writing, software
	 distributed under the License is distributed on an "AS IS" BASIS,
	 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 See the License for the specific language governing permissions and
	 limitations under the License.
	*/function ba(a,b){this.id = a;this.lang = b || "unknown";this.enabled = this.active = !1;}n("shaka.player.TextTrack.compare",function(a,b){return a.lang < b.lang?-1:a.lang > b.lang?1:0;});function ca(){this.minBandwidth = this.maxBandwidth = this.maxWidth = this.maxHeight = null;}ca.prototype.clone = function(){var a=new ca();a.maxHeight = this.maxHeight;a.maxWidth = this.maxWidth;a.maxBandwidth = this.maxBandwidth;a.minBandwidth = this.minBandwidth;return a;};function da(a,b,c,d){this.id = a;this.bandwidth = b || 0;this.width = c || 0;this.height = d || 0;this.active = !1;}function ea(a,b){var c=a.width * a.height,d=b.width * b.height;return c < d?-1:c > d?1:a.bandwidth < b.bandwidth?-1:a.bandwidth > b.bandwidth?1:0;}n("shaka.player.VideoTrack.compare",ea);function fa(a,b,c){this.id = a;this.bandwidth = b || 0;this.lang = c || "unknown";this.active = !1;}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang < b.lang?-1:a.lang > b.lang?1:a.bandwidth < b.bandwidth?-1:a.bandwidth > b.bandwidth?1:0;});function r(){var a,b,c=new Promise(function(c,e){a = c;b = e;});c.resolve = a;c.reject = b;c.destroy = r.prototype.destroy;return c;}r.prototype.destroy = function(){this["catch"](function(){});var a=Error("Destroyed!");a.type = "destroy";this.reject(a);};function w(a,b){return b.bind(a);};function ga(a){return Object.keys(a).map(function(b){return a[b];});}function ha(a,b){var c=ia(a,b,"number");if(null == c)return null;if(isNaN(c) || c == Number.NEGATIVE_INFINITY || c == Number.POSITIVE_INFINITY)throw new RangeError("'" + b + "' must be finite.");if(0 > c)throw new RangeError("'" + b + "' must be >= 0");return c;}function ja(a,b){return ia(a,b,"string");}function ia(a,b,c){a = a[b];if(null == a)return null;if(typeof a != c)throw new TypeError("'" + b + "' must be a " + c + ".");return a;}function ka(a,b,c){a = a[b];if(null == a)return null;if(!(a instanceof c))throw new TypeError("'" + b + "' must be an instance of " + c.name + ".");return a;};function la(a){return a.split("").reduce(function(a,c,d){return a + (d && 0 == d % 4?" " + c:c);});};function na(a,b){for(var c={},d=0;d < a.length;++d) {var e=b?b(a[d]):a[d].toString();c[e] = a[d];}var d=[],f;for(f in c) d.push(c[f]);return d;};var oa={"output-restricted":"The required output protection is not available.","output-not-allowed":"The required output protection is not available.",expired:"The decryption key has expired.","internal-error":"The key system has encountered an unspecified error."};function pa(a){return String.fromCharCode.apply(null,a);}n("shaka.util.Uint8ArrayUtils.toString",pa);function qa(a){for(var b=new Uint8Array(a.length),c=0;c < a.length;++c) b[c] = a.charCodeAt(c);return b;}n("shaka.util.Uint8ArrayUtils.fromString",qa);function ra(a,b){var c=void 0 == b?!0:b,d=window.btoa(pa(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"");}n("shaka.util.Uint8ArrayUtils.toBase64",ra);function sa(a){return qa(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")));}n("shaka.util.Uint8ArrayUtils.fromBase64",sa);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length / 2),c=0;c < a.length;c += 2) b[c / 2] = window.parseInt(a.substr(c,2),16);return b;});function ta(a){for(var b="",c=0;c < a.length;++c) {var d=a[c].toString(16);1 == d.length && (d = "0" + d);b += d;}return b;}n("shaka.util.Uint8ArrayUtils.toHex",ta);function ua(a,b){if(!a && !b)return !0;if(!a || !b || a.length != b.length)return !1;for(var c=0;c < a.length;++c) if(a[c] != b[c])return !1;return !0;};function va(a){this.b = a;this.a = new wa(a);xa || (xa = [new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]);}var xa;function x(a){var b;b = ya(a);if(7 < b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d < b.length;d++) c = 256 * c + b[d];b = c;c = ya(a);a: {for(d = 0;d < xa.length;d++) if(ua(c,xa[d])){d = !0;break a;}d = !1;}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8 == c.length && c[1] & 224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0] & (1 << 8 - c.length) - 1,e=1;e < c.length;e++) d = 256 * d + c[e];c = d;c = a.a.a + c <= a.b.byteLength?c:a.b.byteLength - a.a.a;d = new DataView(a.b.buffer,a.b.byteOffset + a.a.a,c);z(a.a,c);return new za(b,d);}function ya(a){var b=Aa(a.a),c;for(c = 1;8 >= c && !(b & 1 << 8 - c);c++);if(8 < c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0] = b;for(b = 1;b < c;b++) d[b] = Aa(a.a);return d;}function za(a,b){this.id = a;this.a = b;}function Ba(a){if(8 < a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8 == a.a.byteLength && a.a.getUint8(0) & 224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c < a.a.byteLength;c++) var d=a.a.getUint8(c),b=256 * b + d;return b;};function A(){this.a = {};}A.prototype.push = function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a] = [b];};A.prototype.get = function(a){return (a = this.a[a])?a.slice():null;};function Ca(a){var b=[],c;for(c in a.a) b.push.apply(b,a.a[c]);return b;}function Da(a,b,c){if(a = a.a[b])for(b = 0;b < a.length;++b) a[b] == c && (a.splice(b,1),--b);}function Ea(a){var b=[],c;for(c in a.a) b.push(c);return b;};function Ga(){return Date.now() + Ha;}var Ha=0;function Ia(){};function Ja(){this.j = this.a = "";this.l = !1;this.i = this.h = null;this.o = this.g = !1;this.v = this.f = "";this.c = null;this.b = [];}function Ka(a){var b=new Ja();if(!a)return b;var c=ja(a,"keySystem");if(null != c)b.a = c;else throw Error("'keySystem' cannot be null.");var d=ja(a,"licenseServerUrl");if(null != d)b.j = d;else if(c)throw Error("For encrypted streaming content, 'licenseServerUrl' cannot be null or empty.");c = ia(a,"withCredentials","boolean");null != c && (b.l = c);c = ka(a,"licensePostProcessor",Function);null != c && (b.h = c);c = ka(a,"licensePreProcessor",Function);null != c && (b.i = c);c = ia(a,"distinctiveIdentifierRequired","boolean");null != c && (b.g = c);c = ia(a,"persistentStateRequired","boolean");null != c && (b.o = c);c = ja(a,"audioRobustness");null != c && (b.f = c);c = ja(a,"videoRobustness");null != c && (b.v = c);c = ka(a,"serverCertificate",Uint8Array);null != c && (b.c = c);if(c = ka(a,"initData",Object)){a = ka(c,"initData",Uint8Array);if(null == a)throw Error("'initData.initData' cannot be null.");c = ja(c,"initDataType");if(null == c)throw Error("'initData.initDataType' cannot be null.");b.b.push({initData:new Uint8Array(a.buffer),initDataType:c});}return b;}function La(a,b){var c=a.b.concat(b.map(function(a){return {initData:new Uint8Array(a.initData.buffer),initDataType:a.initDataType};}));a.b = na(c,function(a){return Array.prototype.join.apply(a.initData) + "," + a.initDataType;});};function Ma(a,b,c,d,e,f,g,h,k,m,p){this.g = a;this.j = b;this.o = c;this.a = [];this.h = e || null;this.i = f || null;this.f = g == Na;this.v = h == Oa;this.c = k || "";this.l = m || "";this.b = p || null;d && this.a.push(d);}n("shaka.player.DrmSchemeInfo",Ma);var Na=1;Ma.DistinctiveIdentifier = {OPTIONAL:0,REQUIRED:Na};var Oa=1;Ma.PersistentState = {OPTIONAL:0,REQUIRED:Oa};Ma.createUnencrypted = function(){return new Ma("","",!1,null);};function Pa(a){this.c = Math.exp(Math.log(.5) / a);this.a = this.b = 0;}Pa.prototype.sample = function(a,b){var c=Math.pow(this.c,a);this.b = b * (1 - c) + c * this.b;this.a += a;};function Qa(a){return a.b / (1 - Math.pow(a.c,a.a));};function B(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a) c in b || (b[c] = a[c]);return b;}function C(a){return new CustomEvent("error",{detail:a,bubbles:!0});};function Ra(a,b,c){Sa(b);Sa(c);return c == b || a >= Ta && c == b.split("-")[0] || a >= Ua && c.split("-")[0] == b.split("-")[0]?!0:!1;}var Ta=1,Ua=2;function Sa(a){a = a.toLowerCase().split("-");var b=Va[a[0]];b && (a[0] = b);return a.join("-");}var Va={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function D(a){this.xa = new A();this.v = a;}n("shaka.util.FakeEventTarget",D);D.prototype.addEventListener = function(a,b,c){c || this.xa.push(a,b);};D.prototype.removeEventListener = function(a,b,c){c || Da(this.xa,a,b);};D.prototype.dispatchEvent = function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return Wa(this,a);};function Wa(a,b){b.currentTarget = a;for(var c=a.xa.get(b.type) || [],d=0;d < c.length;++d) {var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b);}catch(f) {}}a.v && b.bubbles && Wa(a.v,b);return b.defaultPrevented;};function Xa(){D.call(this,null);this.a = new Pa(3);this.c = new Pa(10);this.b = 0;}q(Xa,D);n("shaka.util.EWMABandwidthEstimator",Xa);Xa.prototype.sample = function(a,b){if(!(65536 > b)){a = Math.max(a,50);var c=8E3 * b / a,d=a / 1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(B({type:"bandwidth"}));this.b = Date.now();}};Xa.prototype.getBandwidth = function(){return .5 > this.a.a?5E5:Math.min(Qa(this.a),Qa(this.c));};Xa.prototype.getDataAge = function(){return (Date.now() - this.b) / 1E3;};Xa.prototype.supportsCaching = function(){return !1;};function wa(a){var b=Ya;this.b = a;this.c = b == Za;this.a = 0;}var Ya=0,Za=1;function $a(a){return a.a < a.b.byteLength;}function Aa(a){var b=a.b.getUint8(a.a);a.a += 1;return b;}function E(a){var b=a.b.getUint32(a.a,a.c);a.a += 4;return b;}function ab(a){var b,c;a.c?(b = a.b.getUint32(a.a,!0),c = a.b.getUint32(a.a + 4,!0)):(c = a.b.getUint32(a.a,!1),b = a.b.getUint32(a.a + 4,!1));if(2097151 < c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a += 8;return c * Math.pow(2,32) + b;}function bb(a){if(a.a + 16 > a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a += 16;return b;}function z(a,b){if(a.a + b > a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a += b;};function cb(){this.g = new r();this.f = !1;this.a = null;this.b = [];this.c = null;}function db(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b);}cb.prototype.start = function(){if(this.f)throw Error("Task already started!");this.f = !0;this.b.unshift(function(){});eb(this,void 0);};cb.prototype.end = function(){this.b.splice(1);};function eb(a,b){var c=a.b[0](b),d;c?(d = c[0],a.c = c[1]):(d = Promise.resolve(),a.c = null);d.then(w(a,function(a){this.a?(this.b = [],this.c = null,fb(this)):(this.b.shift(),this.b.length?eb(this,a):(this.g.resolve(a),this.c = null));}))["catch"](w(a,function(a){this.b = [];this.c = null;this.a?fb(this):this.g.reject(a);}));}function fb(a){var b=Error("Task aborted.");b.type = "aborted";a.g.reject(b);window.setTimeout((function(){this.a.resolve();this.a = null;}).bind(a),5);};function gb(){this.a = new A();}gb.prototype.destroy = function(){hb(this);this.a = null;};function F(a,b,c,d){b = new ib(b,c,d);a.a.push(c,b);}gb.prototype.sa = function(a,b){for(var c=this.a.get(b) || [],d=0;d < c.length;++d) {var e=c[d];e.target == a && (e.sa(),Da(this.a,b,e));}};function hb(a){for(var b=Ca(a.a),c=0;c < b.length;++c) b[c].sa();a.a.a = {};}function ib(a,b,c){this.target = a;this.type = b;this.a = c;this.target.addEventListener(b,c,!1);}ib.prototype.sa = function(){this.target && (this.target.removeEventListener(this.type,this.a,!1),this.a = this.target = null);};function jb(a,b,c){MediaSource.isTypeSupported(b);b = a.addSourceBuffer(b);this.j = a;this.c = b;this.v = c;this.h = new gb();this.b = [];this.o = 0;this.f = this.a = null;this.l = 0;F(this.h,this.c,"updateend",this.w.bind(this));}var kb=1 / 60;jb.prototype.destroy = function(){lb(this)["catch"](function(){});this.f && this.f.destroy();this.b = this.a = this.f = null;this.h.destroy();this.j = this.c = this.h = null;};function mb(a,b){for(var c=a.c.buffered,d=0;d < c.length;++d) {var e=c.start(d) - kb,f=c.end(d) + kb;if(b >= e && b <= f)return c.end(d) - b;}return 0;}function nb(a,b,c,d){if(a.a)return a = Error("Cannot fetch (" + a.i + "): previous operation not complete."),a.type = "stream",Promise.reject(a);a.a = new cb();c != a.c.timestampOffset && (a.c.timestampOffset = c);d && db(a.a,(function(){return [ob(this,d),this.g.bind(this)];}).bind(a));db(a.a,(function(){var a=b.a?b.a - b.b:1,c=new pb();c.a = 3;c.h = 1E3 * a;c.c = 1E3 * this.l;return [qb(b.url,c,this.v),G.prototype.g.bind(b.url)];}).bind(a));db(a.a,w(a,function(a){this.v.getBandwidth();return [ob(this,a),this.g.bind(this)];}));var e=0 == a.c.buffered.length && 0 == a.b.length,f=null;db(a.a,(function(){if(0 == this.c.buffered.length){var a=Error("Failed to buffer segment (" + this.i + ").");a.type = "stream";return [Promise.reject(a)];}e && (a = b.b,f = this.c.buffered.start(0) - a);a = rb(this.b,b.b);0 <= a?this.b.splice(a + 1,0,b):this.b.push(b);}).bind(a));return sb(a).then((function(){return Promise.resolve(f);}).bind(a));}function tb(a){if(a.a)return a = Error("Cannot clear (" + a.i + "): previous operation not complete."),a.type = "stream",Promise.reject(a);a.a = new cb();db(a.a,(function(){var a;a: if(0 == this.c.buffered.length)a = Promise.resolve();else {try{this.c.remove(0,Number.POSITIVE_INFINITY);}catch(c) {a = Promise.reject(c);break a;}this.b = [];a = this.f = new r();}return [a,this.g.bind(this)];}).bind(a));return sb(a);}function ub(a,b){if(a.a){var c=Error("Cannot clearAfter (" + a.i + "): previous operation not complete.");c.type = "stream";return Promise.reject(c);}a.a = new cb();db(a.a,(function(){return [vb(this,b),this.g.bind(this)];}).bind(a));return sb(a);}function lb(a){a.a?(a = a.a,a.a?a = a.a:a.f?(a.c && a.c(),a.a = new r(),a = a.a):(a.f = !0,a = Promise.resolve())):a = Promise.resolve();return a;}function sb(a){a.a.start();return a.a.g.then(w(a,function(){this.a = null;}))["catch"](w(a,function(a){this.a = null;return Promise.reject(a);}));}function ob(a,b){try{a.c.appendBuffer(b);}catch(c) {return Promise.reject(c);}a.f = new r();return a.f;}function vb(a,b){if(0 == a.c.buffered.length)return Promise.resolve();var c=rb(a.b,b);if(-1 == c || c == a.b.length - 1)return Promise.resolve();try{a.c.remove(a.b[c + 1].b,Number.POSITIVE_INFINITY);}catch(d) {return Promise.reject(d);}a.b = a.b.slice(0,c + 1);a.f = new r();return a.f;}jb.prototype.g = function(){"open" == this.j.readyState && this.c.abort();};jb.prototype.w = function(){this.f.resolve();this.f = null;};function wb(a,b){D.call(this,b);this.a = null;this.h = a;}q(wb,D);function xb(a){if(!window.indexedDB)return a = Error("Persistant storage requires IndexedDB support."),a.type = "storage",Promise.reject(a);if(a.a)return a = Error("A database connection is already open."),a.type = "storage",Promise.reject(a);var b=new r(),c=window.indexedDB.open("content_database",1);c.onupgradeneeded = w(a,function(a){this.a = a.target.result;yb(this,"group_store",{keyPath:"group_id"});yb(this,"stream_index_store",{keyPath:"stream_id"});a = yb(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],{unique:!0});a.createIndex("stream","stream_id",{unique:!1});});c.onsuccess = w(a,function(a){this.a = a.target.result;b.resolve();});c.onerror = function(){b.reject(c.error);};return b;}function H(a){a.a && (a.a.close(),a.a = null);}function yb(a,b,c){a.a.objectStoreNames.contains(b) && a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c);}function zb(a){return Bb(a,"content_store");}function Cb(a){return Bb(a,"stream_index_store");}function Db(a){return Bb(a,"group_store");}function Bb(a,b){return a.a.transaction([b],a.h).objectStore(b);}function Eb(a,b){var c=new r(),d=a.get(b);d.onerror = function(){c.reject(d.error);};d.onsuccess = function(){if(d.result)c.resolve(d.result);else {var a=Error("Item not found.");a.type = "storage";c.reject(a);}};return c;};function Fb(){wb.call(this,"readonly",null);}q(Fb,wb);function Gb(a){var b=new r(),c=[],d=Db(a).openCursor();d.onerror = function(){b.reject(d.error);};d.onsuccess = function(a){(a = a.target.result)?(c.push(a.key),a["continue"]()):b.resolve(c);};return b;}function Hb(a,b){return Eb(Db(a),b).then(w(a,function(a){a.session_ids = na(a.session_ids);return a.hasOwnProperty("duration") || a.hasOwnProperty("key_system")?Promise.resolve(a):Ib(this,a.stream_ids[0]).then(function(b){a.duration = b.duration;a.key_system = b.key_system;a.license_server = b.license_server;a.with_credentials = b.with_credentials;a.distinctive_identifier = b.distinctive_identifier;a.audio_robustness = b.audio_robustness;a.video_robustness = b.video_robustness;return Promise.resolve(a);});}));}function Ib(a,b){return Eb(Cb(a),b);}function Jb(a,b,c){return Eb(zb(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content);});};function Kb(a){var b=console[a];b?b.bind || (console[a] = function(){b.apply(console,arguments);}):console[a] = function(){};}Kb("error");Kb("warn");Kb("info");Kb("log");Kb("debug");function I(){this.fontSize = "100%";this.fontColor = Lb;this.fontOpacity = Mb;this.backgroundColor = Nb;this.backgroundOpacity = Mb;this.fontEdge = Ob;}n("shaka.player.TextStyle",I);I.prototype.a = function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b = JSON.parse(a);}catch(c) {return;}if(b && "object" == typeof b){var a=b,d;for(d in a) d in this && (this[d] = a[d]);}}};I.prototype.load = I.prototype.a;I.prototype.b = function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this));};I.prototype.store = I.prototype.b;function Pb(a){var b=[];b.push("font-size: " + a.fontSize);b.push("color: " + Qb(a.fontColor,a.fontOpacity));b.push("background-color: " + Qb(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d < a.fontEdge.length;++d) {var e=a.fontEdge[d].slice(3,6);c.push(Qb(a.fontEdge[d].slice(0,3),a.fontOpacity) + " " + e.join("px ") + "px");}b.push("text-shadow: " + c.join(","));return b.join("; ");}function Qb(a,b){return "rgba(" + a.concat(b).join(",") + ")";}var Lb=[255,255,255],Nb=[0,0,0];I.StandardColors = {WHITE:Lb,BLACK:Nb,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var Mb=1;I.StandardOpacities = {OPAQUE:Mb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var Ob=[];I.EdgeStyles = {NONE:Ob,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function Rb(a){this.systemIds = [];this.cencKeyIds = [];a = new wa(new DataView(a.buffer));try{for(;$a(a);) {var b=a.a,c=E(a),d=E(a);1 == c?c = ab(a):0 == c && (c = a.b.byteLength - b);if(1886614376 != d)z(a,c - (a.a - b));else {var e=Aa(a);if(1 < e)z(a,c - (a.a - b));else {z(a,3);var f=ta(bb(a)),g=[];if(0 < e)for(var h=E(a),k=0;k < h;++k) {var m=ta(bb(a));g.push(m);}var p=E(a);z(a,p);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a != b + c && z(a,c - (a.a - b));}}}}catch(t) {}};function Sb(a){Tb[a] = {na:Ub(),end:NaN};}function Vb(a){if(a = Tb[a])a.end = Ub();}function Wb(a){return (a = Tb[a]) && a.end?a.end - a.na:NaN;}var Ub=window.performance && window.performance.now?window.performance.now.bind(window.performance):Date.now,Tb={};function Xb(){var a=("CustomEvent" in window);if(a)try{new CustomEvent("");}catch(b) {a = !1;}a || (window.CustomEvent = Yb);}n("shaka.polyfill.CustomEvent.install",Xb);function Yb(a,b){var c=document.createEvent("CustomEvent"),d=b || {bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c;};function Zb(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality && "webkitDroppedFrameCount" in a && (a.getVideoPlaybackQuality = $b);}n("shaka.polyfill.VideoPlaybackQuality.install",Zb);function $b(){return {droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0};};function ac(){var a=Element.prototype;a.requestFullscreen = a.requestFullscreen || a.mozRequestFullScreen || a.msRequestFullscreen || a.webkitRequestFullscreen;a = Document.prototype;a.exitFullscreen = a.exitFullscreen || a.mozCancelFullScreen || a.msExitFullscreen || a.webkitExitFullscreen;"fullscreenElement" in document || Object.defineProperty(document,"fullscreenElement",{get:function get(){return document.mozFullScreenElement || document.msFullscreenElement || document.webkitFullscreenElement;}});document.addEventListener("webkitfullscreenchange",bc);document.addEventListener("webkitfullscreenerror",bc);document.addEventListener("mozfullscreenchange",bc);document.addEventListener("mozfullscreenerror",bc);document.addEventListener("MSFullscreenChange",bc);document.addEventListener("MSFullscreenError",bc);}n("shaka.polyfill.Fullscreen.install",ac);function bc(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b);};function cc(){return Promise.reject(Error("The key system specified is not supported."));}function dc(a){return null == a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."));}function ec(){throw new TypeError("Illegal constructor.");}ec.prototype.createSession = function(){};ec.prototype.setServerCertificate = function(){};function fc(){throw new TypeError("Illegal constructor.");}fc.prototype.getConfiguration = function(){};fc.prototype.createMediaKeys = function(){};function gc(a,b){try{var c=new hc(a,b);return Promise.resolve(c);}catch(d) {return Promise.reject(d);}}function jc(a){var b=this.mediaKeys;b && b != a && kc(b,null);delete this.mediaKeys;(this.mediaKeys = a) && kc(a,this);return Promise.resolve();}function hc(a,b){this.a = this.keySystem = a;var c=!0;"org.w3.clearkey" == a && (this.a = "webkit-org.w3.clearkey",c = !1);var d=!1,e;e = document.getElementsByTagName("video");e = e.length?e[0]:document.createElement("video");for(var f=0;f < b.length;++f) {var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"]},k=!1;if(g.audioCapabilities)for(var m=0;m < g.audioCapabilities.length;++m) {var p=g.audioCapabilities[m];p.contentType && (k = !0,e.canPlayType(p.contentType.split(";")[0],this.a) && (h.audioCapabilities.push(p),d = !0));}if(g.videoCapabilities)for(m = 0;m < g.videoCapabilities.length;++m) p = g.videoCapabilities[m],p.contentType && (k = !0,e.canPlayType(p.contentType,this.a) && (h.videoCapabilities.push(p),d = !0));k || (d = e.canPlayType("video/mp4",this.a) || e.canPlayType("video/webm",this.a));"required" == g.persistentState && (c?(h.persistentState = "required",h.sessionTypes = ["persistent-license"]):d = !1);if(d){this.b = h;return;}}throw Error("None of the requested configurations were supported.");}hc.prototype.createMediaKeys = function(){var a=new lc(this.a);return Promise.resolve(a);};hc.prototype.getConfiguration = function(){return this.b;};function lc(a){this.g = a;this.b = null;this.a = new gb();this.c = [];this.f = {};}function kc(a,b){a.b = b;hb(a.a);b && (F(a.a,b,"webkitneedkey",a.Bb.bind(a)),F(a.a,b,"webkitkeymessage",a.Ab.bind(a)),F(a.a,b,"webkitkeyadded",a.yb.bind(a)),F(a.a,b,"webkitkeyerror",a.zb.bind(a)));}l = lc.prototype;l.createSession = function(a){var b=a || "temporary";if("temporary" != b && "persistent-license" != b)throw new TypeError("Session type " + a + " is unsupported on this platform.");a = this.b || document.createElement("video");a.src || (a.src = "about:blank");b = new mc(a,this.g,b);this.c.push(b);return b;};l.setServerCertificate = function(){return Promise.reject(Error("setServerCertificate not supported on this platform."));};l.Bb = function(a){a = B({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a);};l.Ab = function(a){var b=nc(this,a.sessionId);b && (a = B({type:"message",messageType:void 0 == b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b && (b.b.resolve(),b.b = null),b.dispatchEvent(a));};l.yb = function(a){if(a = nc(this,a.sessionId))oc(a,"usable"),a.a && a.a.resolve(),a.a = null;};l.zb = function(a){var b=nc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode = a.errorCode;c.errorCode.systemCode = a.systemCode;!a.sessionId && b.b?(c.method = "generateRequest",45 == a.systemCode && (c.message = "Unsupported session type."),b.b.reject(c),b.b = null):a.sessionId && b.a?(c.method = "update",b.a.reject(c),b.a = null):(c = a.systemCode,a.errorCode.code == MediaKeyError.MEDIA_KEYERR_OUTPUT?oc(b,"output-restricted"):1 == c?oc(b,"expired"):oc(b,"internal-error"));}};function nc(a,b){var c=a.f[b];return c?c:(c = a.c.shift())?(c.sessionId = b,a.f[b] = c):null;}function mc(a,b,c){D.call(this,null);this.f = a;this.h = !1;this.a = this.b = null;this.c = b;this.g = c;this.sessionId = "";this.expiration = NaN;this.closed = new r();this.keyStatuses = new pc();}q(mc,D);function qc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h = !0;var d;try{if("persistent-license" == a.g)if(c)d = qa("LOAD_SESSION|" + c);else {var e=new Uint8Array(b);d = qa("PERSISTENT|" + pa(e));}else d = new Uint8Array(b);}catch(f) {return Promise.reject(f);}a.b = new r();try{a.f.webkitGenerateKeyRequest(a.c,d);}catch(g) {if("InvalidStateError" != g.name)return a.b = null,Promise.reject(g);setTimeout((function(){try{this.f.webkitGenerateKeyRequest(this.c,d);}catch(a) {this.b.reject(a),this.b = null;}}).bind(a),10);}return a.b;}l = mc.prototype;l.Ja = function(a,b){if(this.a)this.a.then(this.Ja.bind(this,a,b))["catch"](this.Ja.bind(this,a,b));else {this.a = a;var c,d;"webkit-org.w3.clearkey" == this.c?(c = pa(new Uint8Array(b)),d = JSON.parse(c),"oct" != d.keys[0].kty && (this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a = null),c = sa(d.keys[0].k),d = sa(d.keys[0].kid)):(c = new Uint8Array(b),d = null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId);}catch(e) {this.a.reject(e),this.a = null;}}};function oc(a,b){var c=a.keyStatuses;c.size = void 0 == b?0:1;c.a = b;c = B({type:"keystatuseschange"});a.dispatchEvent(c);}l.generateRequest = function(a,b){return qc(this,b,null);};l.load = function(a){return "persistent-license" == this.g?qc(this,null,a):Promise.reject(Error("Not a persistent session."));};l.update = function(a){var b=new r();this.Ja(b,a);return b;};l.close = function(){if("persistent-license" != this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId);}this.closed.resolve();return this.closed;};l.remove = function(){return "persistent-license" != this.g?Promise.reject(Error("Not a persistent session.")):this.close();};function rc(a){this.b = a;this.a = 0;}rc.prototype.next = function(){return this.a >= this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1};};function pc(){this.size = 0;this.a = void 0;}var sc;l = pc.prototype;l.entries = function(){var a=sc,b=[];this.a && b.push([a,this.a]);return new rc(b);};l.forEach = function(a){this.a && a(this.a);};l.get = function(a){if(this.has(a))return this.a;};l.has = function(a){var b=sc;return this.a && ua(new Uint8Array(a),b)?!0:!1;};l.keys = function(){var a=sc,b=[];this.a && b.push(a);return new rc(b);};l.values = function(){var a=[];this.a && a.push(this.a);return new rc(a);};function tc(){Navigator.prototype.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration || (HTMLMediaElement.prototype.webkitGenerateKeyRequest?(sc = new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess = gc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys = null,HTMLMediaElement.prototype.setMediaKeys = jc,window.MediaKeys = lc,window.MediaKeySystemAccess = hc):(Navigator.prototype.requestMediaKeySystemAccess = cc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys = null,HTMLMediaElement.prototype.setMediaKeys = dc,window.MediaKeys = ec,window.MediaKeySystemAccess = fc));}n("shaka.polyfill.MediaKeys.install",tc);n("shaka.polyfill.installAll",function(){Xb();ac();tc();Zb();});var uc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function J(a){var b;a instanceof J?(vc(this,a.R),this.aa = a.aa,this.P = a.P,wc(this,a.fa),this.N = a.N,xc(this,a.a.clone()),this.$ = a.$):a && (b = String(a).match(uc))?(vc(this,b[1] || "",!0),this.aa = yc(b[2] || ""),this.P = yc(b[3] || "",!0),wc(this,b[4]),this.N = yc(b[5] || "",!0),xc(this,b[6] || "",!0),this.$ = yc(b[7] || "")):this.a = new zc(null);}l = J.prototype;l.R = "";l.aa = "";l.P = "";l.fa = null;l.N = "";l.$ = "";l.toString = function(){var a=[],b=this.R;b && a.push(Ac(b,Bc,!0),":");if(b = this.P){a.push("//");var c=this.aa;c && a.push(Ac(c,Bc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b = this.fa;null != b && a.push(":",String(b));}if(b = this.N)this.P && "/" != b.charAt(0) && a.push("/"),a.push(Ac(b,"/" == b.charAt(0)?Cc:Dc,!0));(b = this.a.toString()) && a.push("?",b);(b = this.$) && a.push("#",Ac(b,Ec));return a.join("");};l.resolve = function(a){var b=this.clone();"data" === b.R && (b = new J());var c=!!a.R;c?vc(b,a.R):c = !!a.aa;c?b.aa = a.aa:c = !!a.P;c?b.P = a.P:c = null != a.fa;var d=a.N;if(c)wc(b,a.fa);else if(c = !!a.N){if("/" != d.charAt(0))if(this.P && !this.N)d = "/" + d;else {var e=b.N.lastIndexOf("/");-1 != e && (d = b.N.substr(0,e + 1) + d);}if(".." == d || "." == d)d = "";else if(-1 != d.indexOf("./") || -1 != d.indexOf("/.")){for(var e=0 == d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g < d.length;) {var h=d[g++];"." == h?e && g == d.length && f.push(""):".." == h?((1 < f.length || 1 == f.length && "" != f[0]) && f.pop(),e && g == d.length && f.push("")):(f.push(h),e = !0);}d = f.join("/");}}c?b.N = d:c = "" !== a.a.toString();c?xc(b,a.a.clone()):c = !!a.$;c && (b.$ = a.$);return b;};l.clone = function(){return new J(this);};function vc(a,b,c){a.R = c?yc(b,!0):b;a.R && (a.R = a.R.replace(/:$/,""));}function wc(a,b){if(b){b = Number(b);if(isNaN(b) || 0 > b)throw Error("Bad port number " + b);a.fa = b;}else a.fa = null;}function xc(a,b,c){b instanceof zc?a.a = b:(c || (b = Ac(b,Fc)),a.a = new zc(b));}function yc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):"";}function Ac(a,b,c){return "string" == typeof a?(a = encodeURI(a).replace(b,Gc),c && (a = a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null;}function Gc(a){a = a.charCodeAt(0);return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);}var Bc=/[#\/\?@]/g,Dc=/[\#\?:]/g,Cc=/[\#\?]/g,Fc=/[\#\?@]/g,Ec=/#/g;function zc(a){this.b = a || null;}zc.prototype.a = null;zc.prototype.c = null;function Hc(a,b,c){if(!a.a && (a.a = {},a.c = 0,a.b))for(var d=a.b.split("&"),e=0;e < d.length;e++) {var f=d[e].indexOf("="),g=null,h=null;0 <= f?(g = d[e].substring(0,f),h = d[e].substring(f + 1)):g = d[e];g = decodeURIComponent(g.replace(/\+/g," "));h = h || "";Hc(a,g,decodeURIComponent(h.replace(/\+/g," ")));}a.b = null;(d = a.a.hasOwnProperty(b) && a.a[b]) || (a.a[b] = d = []);d.push(c);a.c++;}zc.prototype.toString = function(){if(this.b)return this.b;if(!this.a)return "";var a=[],b;for(b in this.a) for(var c=encodeURIComponent(b),d=this.a[b],e=0;e < d.length;e++) {var f=c;"" !== d[e] && (f += "=" + encodeURIComponent(d[e]));a.push(f);}return this.b = a.join("&");};zc.prototype.clone = function(){var a=new zc();a.b = this.b;if(this.a){var b={},c;for(c in this.a) b[c] = this.a[c].concat();a.a = b;a.c = this.c;}return a;};function Ic(a,b){this.url = a;this.b = b || new pb();this.g = this.i = this.h = 0;this.a = null;this.c = new r();this.f = null;}function pb(){this.body = null;this.a = 1;this.h = 1E3;this.c = 0;this.method = "GET";this.f = "arraybuffer";this.b = {};this.g = this.i = !1;}function Jc(a){Kc(a);a.b.body = null;a.c.destroy();a.c = null;a.f = null;}function Kc(a){a.a && (a.a.onload = null,a.a.onreadystatechange = null,a.a.onerror = null,a.a.ontimeout = null);a.a = null;}l = Ic.prototype;l.bb = function(){if(this.a)return this.c;if(0 == this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64" == a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer" == this.b.f && (b = qa(b).buffer);a = JSON.parse(JSON.stringify(new XMLHttpRequest()));a.response = b;a.responseText = b.toString();b = this.c;b.resolve(a);Jc(this);return b;}if(0 == this.url.lastIndexOf("idb:",0))return Lc(this);this.h++;this.i = Date.now();this.g || (this.g = this.b.h);this.a = new XMLHttpRequest();a = this.url;if(this.f && !this.f.supportsCaching() || this.b.g)a = new J(a),Hc(a.a,"_",Date.now()),a = a.toString();this.a.open(this.b.method,a,!0);this.a.responseType = this.b.f;this.a.timeout = this.b.c;this.a.withCredentials = this.b.i;this.a.onload = this.lb.bind(this);this.b.g && (this.a.onreadystatechange = this.pb.bind(this));this.a.onerror = this.Hb.bind(this);this.a.ontimeout = this.ub.bind(this);for(b in this.b.b) this.a.setRequestHeader(b,this.b.b[b]);this.a.send(this.b.body);return this.c;};function Lc(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Fb();return xb(e).then(function(){return Jb(e,c,d);}).then(w(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest()));b.response = a;a = this.c;a.resolve(b);H(e);Jc(this);return a;}))["catch"](w(a,function(a){H(e);Jc(this);return Promise.reject(a);}));}function Mc(a,b,c){b = Error(b);b.type = c;b.status = a.a.status;b.url = a.url;b.method = a.b.method;b.body = a.b.body;b.Lb = a.a;return b;}l.lb = function(a){this.f && this.f.sample(Date.now() - this.i,a.loaded);200 <= this.a.status && 299 >= this.a.status?(this.c.resolve(this.a),Jc(this)):this.h < this.b.a?Nc(this):(a = Mc(this,"HTTP error.","net"),this.c.reject(a),Jc(this));};l.pb = function(){if(this.a.readyState == XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a && (Ha = a - Date.now());}};l.Hb = function(){var a=Mc(this,"Network failure.","net");this.c.reject(a);Jc(this);};l.ub = function(){if(this.h < this.b.a)Nc(this);else {var a=Mc(this,"Request timed out.","net");this.c.reject(a);Jc(this);}};function Nc(a){Kc(a);window.setTimeout(a.bb.bind(a),a.g * (1 + .5 * (2 * Math.random() - 1)));a.g *= 2;};function G(a,b,c,d){this.c = b;this.f = c || 0;this.h = null != d?d:null;this.b = this.a = null;this.i = a;}function Oc(a,b){return a && 0 !== a.length?a.map(function(a){return a.resolve(b);}):[b];}function qb(a,b,c){if(a.a)return a.a;b = b || new pb();if(a.f || a.h)b.b.Range = "bytes=" + (a.f + "-" + (null != a.h?a.h:""));a.a = Pc(a,0,b,c);return a.a;}G.prototype.g = function(){if(this.b){this.a = null;var a=this.b;if(a.a && a.a.readyState != XMLHttpRequest.DONE){a.a.abort();var b=Mc(a,"Request aborted.","aborted");a.c.reject(b);Jc(a);}this.b = null;}};function Pc(a,b,c,d){var e=a.c[b].toString();a.i && (e = a.i(e,c.b) || e);a.b = new Ic(e,c);d && (a.b.f = d);e = a.b.bb().then(w(a,function(a){this.b = this.a = null;return Promise.resolve(a.response);}));return e = e["catch"](w(a,function(a){if(this.a && b + 1 < this.c.length)return this.a = Pc(this,b + 1,c,d);this.a = this.b = null;return Promise.reject(a);}));}G.prototype.clone = function(){return new G(this.i,this.c.map(function(a){return a.clone();}),this.f,this.h);};G.prototype.toString = function(){return this.c[0].toString();};function Qc(a){this.a = a;}Qc.prototype.destroy = function(){this.a && (this.a.g(),this.a = null);};Qc.prototype.create = function(){return this.a?qb(this.a):Promise.resolve(null);};function Rc(a,b,c){this.b = a;this.a = b;this.url = c;}function Sc(a,b,c){return new Rc(b,c,a.url);}function rb(a,b){for(var c=a.length - 1;0 <= c;--c) {var d=a[c];if(b >= d.b && (null == d.a || b < d.a))return c;}return -1;}function Tc(a,b){return a.map(function(a){return Sc(a,a.b + b,null != a.a?a.a + b:null);});};function Uc(){}Uc.prototype.parse = function(a,b,c,d){var e=null;try{a: {var f=[],g=new wa(a),h=E(g);if(1936286840 != E(g))e = null;else {1 == h && (h = ab(g));var k=Aa(g);z(g,3);z(g,4);var m=E(g);if(0 == m)e = null;else {var p,t;0 == k?(p = E(g),t = E(g)):(p = ab(g),t = ab(g));z(g,2);var y=g.b.getUint16(g.a,g.c);g.a += 2;a = p;b = b + h + t;for(h = 0;h < y;h++) {var u=E(g);t = (u & 2147483648) >>> 31;var k=u & 2147483647,v=E(g);E(g);if(1 == t){e = null;break a;}var ma=new G(d,c,b,b + k - 1);f.push(new Rc(a / m,(a + v) / m,ma));a += v;b += k;}e = f;}}}}catch(Ab) {if(!(Ab instanceof RangeError))throw Ab;}return e;};function Vc(){}Vc.prototype.parse = function(a,b,c,d){var e=null;try{var f;var g=new va(b);if(440786851 != x(g).id)f = null;else {var h=x(g);if(408125543 != h.id)f = null;else {var k=h.a.byteOffset,m;var p=new va(h.a);for(b = null;$a(p.a);) {var t=x(p);if(357149030 == t.id){b = t;break;}}if(b){for(var y=new va(b.a),p=1E6;$a(y.a);) {var u=x(y);if(2807729 == u.id){p = Ba(u);break;}}m = p / 1E9;}else m = null;f = m?{Db:k,Ib:m}:null;}}if(f){var v=x(new va(a));if(475249515 != v.id)e = null;else {var ma=f.Db,Ab=f.Ib;a = [];var Jd=new va(v.a);for(f = v = -1;$a(Jd.a);) {var Kd=x(Jd);if(187 == Kd.id){var Fa;var Ld=new va(Kd.a),Md=x(Ld);if(179 != Md.id)Fa = null;else {var Ye=Ba(Md),Nd=x(Ld);if(183 != Nd.id)Fa = null;else {for(var Od=new va(Nd.a),k=0;$a(Od.a);) {var Pd=x(Od);if(241 == Pd.id){k = Ba(Pd);break;}}Fa = {Kb:Ye,Cb:k};}}if(Fa){var Qd=Ab * Fa.Kb,Rd=ma + Fa.Cb;if(0 <= v){var ic=new G(d,c,f,Rd - 1);a.push(new Rc(v,Qd,ic));}v = Qd;f = Rd;}}}0 <= v && (ic = new G(d,c,f,null),a.push(new Rc(v,null,ic)));e = a;}}else e = null;}catch(Sd) {if(!(Sd instanceof RangeError))throw Sd;}return e;};function K(a){this.u = a;this.g = 0;}K.prototype.destroy = function(){this.u = null;};l = K.prototype;l.length = function(){return this.u.length;};function L(a){if(0 == a.u.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.u[0];}function M(a){if(0 == a.u.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.u[a.u.length - 1];}l.get = function(a){if(0 > a || a >= this.u.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.u[a];};l.ia = function(a){a = rb(this.u,a);return 0 <= a?this.u[a]:null;};l.Ca = function(a){Wc(this,a);return !0;};function Wc(a,b){a.g != b.g && (b = new K(Tc(b.u,a.g - b.g)));if(0 == a.length())a.u = b.u.slice(0);else if(0 != b.length() && null != M(a).a && !(null != M(b).a && M(b).a < M(a).a)){if(M(a).a <= L(b).b)var c=Sc(M(a),M(a).b,L(b).b),c=a.u.slice(0,-1).concat([c]);else {var d;for(d = 0;d < a.u.length && !(a.u[d].a >= L(b).b);++d);a.u[d].b < L(b).b?(c = Sc(a.u[d],a.u[d].b,L(b).b),c = a.u.slice(0,d).concat([c])):(L(a).b > L(b).b || L(b),c = a.u.slice(0,d));}a.u = c.concat(b.u);}}l.ha = function(a){var b=a - this.g;if(0 == b)return 0;this.u = Tc(this.u,b);this.g = a;return b;};l.Ba = function(){return 0 < this.length()?{start:L(this).b,end:M(this).a}:{start:0,end:0};};function Xc(a){this.b = a;this.a = null;}Xc.prototype.destroy = function(){this.a && (this.a.destroy(),this.a = null);};Xc.prototype.create = function(){if(this.a)return Promise.resolve(this.a);var a=new Rc(0,null,this.b);this.a = new K([a]);return Promise.resolve(this.a);};function Yc(a){this.b = a;this.a = null;}Yc.prototype.destroy = function(){this.b = null;this.a && (this.a.destroy(),this.a = null);};Yc.prototype.create = function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b < this.b.length;++b) {var c=this.b[b];a.push(new Rc(c.start_time,c.end_time,new G(null,[new J(c.url)],c.start_byte,null)));}this.b = null;this.a = new K(a);return Promise.resolve(this.a);};function Zc(){this.A = $c++;this.id = this.C = this.F = null;this.c = 0;this.height = this.width = this.bandwidth = null;this.b = this.a = "";this.f = [];this.L = !1;this.J = !0;}var $c=0;Zc.prototype.destroy = function(){this.F && (this.F.destroy(),this.F = null);this.C && (this.C.destroy(),this.C = null);};function ad(a){var b=a.a || "";a.b && (b += '; codecs="' + a.b + '"');return b;}function bd(){this.A = cd++;this.id = null;this.contentType = this.lang = "";this.b = !1;this.m = [];this.a = [];}var cd=0;bd.prototype.destroy = function(){for(var a=0;a < this.m.length;++a) this.m[a].destroy();this.a = this.m = null;};function dd(a){for(var b=[],c=0;c < a.a.length;++c) {var d=new ed();d.id = a.A;d.a = a.a[c];d.contentType = a.contentType;d.b = a.m.length?ad(a.m[0]):"";b.push(d);}return b;}function fd(){this.id = null;this.start = 0;this.b = null;this.a = [];}fd.prototype.destroy = function(){for(var a=0;a < this.a.length;++a) this.a[a].destroy();this.a = null;};function gd(){this.b = !1;this.g = this.f = null;this.c = 0;this.a = [];}gd.prototype.destroy = function(){for(var a=0;a < this.a.length;++a) this.a[a].destroy();this.a = null;};function ed(){this.id = 0;this.a = null;this.b = this.contentType = "";};function hd(a,b){D.call(this,a);this.b = b;this.h = !0;this.g = this.f = null;this.c = new r();this.a = null;}q(hd,D);hd.prototype.H = function(){};hd.prototype.destroy = function(){this.a && this.b.removeChild(this.a);this.c.destroy();this.v = this.b = this.f = this.g = this.a = this.c = null;};l = hd.prototype;l.oa = function(){return this.f;};l.Pa = function(){return this.g;};l.cb = function(){return this.c;};l.Qa = function(){return !0;};l.ra = function(a){a.F.create().then(w(this,function(b){if(this.b){if(0 == b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.f;this.f = a;this.g = b;b = L(b).url.c[0].toString();var d=this.Aa();this.a && (this.wa(!1),this.b.removeChild(this.a));this.a = document.createElement("track");this.b.appendChild(this.a);this.a.src = b;this.wa(d);b = B({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c || this.c.resolve(0);}}));};l.Va = function(){};l.wa = function(a){this.h = a;this.a && (this.a.track.mode = a?"showing":"disabled");};l.Aa = function(){return this.h;};l.Fa = function(){return 0;};function id(a,b,c,d,e){D.call(this,a);this.c = b;this.a = new jb(c,d,e);this.B = this.D = this.b = null;this.I = !1;this.g = null;this.l = !1;this.i = null;this.o = !1;this.h = new r();this.j = this.f = !1;this.K = 0;this.w = 15;this.G = !1;}q(id,D);id.prototype.H = function(a){null != a.initialStreamBufferSize && (this.K = Number(a.initialStreamBufferSize));null != a.streamBufferSize && (this.w = Number(a.streamBufferSize));null != a.segmentRequestTimeout && (this.a.l = Number(a.segmentRequestTimeout));};id.prototype.destroy = function(){jd(this);this.h.destroy();this.b = this.h = null;this.a.destroy();this.v = this.c = this.a = null;};l = id.prototype;l.oa = function(){return this.b;};l.Pa = function(){return this.D;};l.cb = function(a){this.f || a.then((function(){this.f = !0;this.g || kd(this,0);}).bind(this))["catch"](function(){});return this.h;};l.Qa = function(){return this.j;};l.ra = function(a,b,c){if(a != this.b){var d=[a.F.create(),a.C.create()];Promise.all(d).then(w(this,function(d){if(this.c){var f=this.b;this.b = a;this.D = d[0];this.B = d[1];this.I = !0;this.l || (f?b && ld(this,!0,c):kd(this,0));}}))["catch"](w(this,function(a){"aborted" != a.type && (this.f?(a = C(a),this.dispatchEvent(a)):this.h.reject(a));}));}};l.Va = function(){return ld(this,!1);};function ld(a,b,c){a.b && !a.l && (a.l = !0,jd(a),lb(a.a).then(w(a,function(){var a=this.c.currentTime;if(!b && 0 < mb(this.a,a) && 0 <= rb(this.a.b,a))return Promise.resolve();if(c)return ub(this.a,this.c.currentTime + c);this.G = !0;return tb(this.a);})).then(w(a,function(){this.l = !1;kd(this,0);}))["catch"](w(a,function(a){this.l = !1;this.f?(a = C(a),this.dispatchEvent(a)):this.h.reject(a);})));}l.wa = function(){};l.Aa = function(){return !0;};l.Fa = function(){return this.o?this.w:Math.min(this.K,this.w);};l.xb = function(){if(this.o && !this.f)this.g = null;else {var a;if(a = this.f && !this.j)a = 1 < this.a.c.buffered.length?!0:!1;if(a)ld(this,!0);else {this.g = null;a = this.b;var b=this.D,c=this.c.currentTime;mb(this.a,this.o?c:c + (this.i || 0)) >= this.Fa()?(md(this),kd(this,1E3 / (Math.abs(this.c.playbackRate) || 1))):(b = nd(this,c,b))?(b = nb(this.a,b,a.c,this.B),this.B = null,this.I && (this.I = !1,od(this,a)),this.j = !1,b.then(w(this,function(a){null == this.i && (this.i = a);this.G && 0 < mb(this.a,c) && (this.G = !1,this.c.currentTime += .001);kd(this,0);}))["catch"](w(this,function(a){if("aborted" != a.type){var b=[0,404,410];"net" == a.type && -1 != b.indexOf(a.Lb.status) && this.b && kd(this,5E3);a = C(a);this.dispatchEvent(a);}}))):(md(this),this.f && !this.j && (this.j = !0,pd(this)),kd(this,1E3));}}};function nd(a,b,c){a = a.a;var d=a.b.length;a = 0 < d?a.b[d - 1]:null;return null != a?null != a.a?c.ia(a.a):null:c.ia(b) || (c.length()?M(c):null);}function md(a){if(!a.o && null != a.i){a.o = !0;var b=a.a,c=a.i,d=c - b.o;0 != d && (b.b = Tc(b.b,d),b.o = c);a.h.resolve(a.i);}}function od(a,b){var c;c = b.a.split("/")[0];c = B({type:"adaptation",bubbles:!0,contentType:c,size:"video" != c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c);}function pd(a){var b=B({type:"ended"});a.dispatchEvent(b);}function kd(a,b){a.g = window.setTimeout(a.xb.bind(a),b);}function jd(a){null != a.g && (window.clearTimeout(a.g),a.g = null);};function qd(){this.streamStats = null;this.droppedFrames = this.decodedFrames = NaN;this.bufferingTime = this.playTime = this.estimatedBandwidth = 0;this.playbackLatency = NaN;this.bufferingHistory = [];this.bandwidthHistory = [];this.streamHistory = [];}function rd(a,b){var c=new sd(b);a.streamHistory.push(new td(c));if(c.videoHeight || !a.streamStats)a.streamStats = c;}function sd(a){this.videoWidth = a.width;this.videoHeight = a.height;this.videoMimeType = a.a;this.videoBandwidth = a.bandwidth;}function td(a){this.timestamp = Ga() / 1E3;this.value = a;};function ud(a,b,c,d,e,f){this.b = new G(null,[new J(a)]);this.a = new pb();this.a.body = b;this.a.method = c;this.a.a = 3;this.a.i = d;this.a.c = 1E3 * (null != f?f:0);a = e || {};for(var g in a) this.a.b[g] = a[g];}function vd(a){return qb(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a));});};function wd(a,b,c){D.call(this,a);this.g = b;this.b = c;this.a = this.h = null;this.l = new gb();this.j = {};this.f = [];this.o = 0;this.c = new r();this.i = null;this.w = 0;}q(wd,D);wd.prototype.destroy = function(){this.v = null;for(var a=0;a < this.f.length;++a) this.f[a].close()["catch"](function(){});this.f = [];this.j = this.a = this.h = null;this.c.destroy();this.c = null;this.l.destroy();this.l = null;this.i && (window.clearTimeout(this.i),this.i = null);this.g = this.b = null;};wd.prototype.initialize = function(){for(var a=new A(),b=this.b.Oa(),c=0;c < b.length;++c) {var d=b[c];d.a.a || d.b && !xd(d.b) || a.push(d.contentType,d);}for(var c={},d=!1,e=0;e < b.length;++e) {var f=b[e];if(f.a.a && !a.a.hasOwnProperty(f.contentType)){var g=f.a.a,h=c[g];h || (h = f.a,h = {audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:h.g?"required":"optional",persistentState:h.o || this.b.ea()?"required":"optional",sessionTypes:[this.b.ea()?"persistent-license":"temporary"]},c[g] = h);if(f.b && (g = f.contentType + "Capabilities",g in h)){d = !0;h[g] || (h[g] = []);var k;"audio" == f.contentType?k = f.a.f:"video" == f.contentType && (k = f.a.v);h[g].push({contentType:f.b,robustness:k});}}}if(!d)if(b.length)this.a = b[0].a;else throw (a = Error("No DrmInfo exists!"),a.type = "drm",a);if(0 == Object.keys(c).length)return this.b.Ea(a),this.c.resolve(),Promise.resolve();k = new r();c = yd(this,c,k);c = c.then(this.hb.bind(this,b,a));c = c.then(this.Eb.bind(this));k.reject(null);return c;};function zd(a,b){null == a.i && (a.i = window.setTimeout((function(){var a=Error("Timeout waiting for sessions.");a.type = "storage";this.c.reject(a);}).bind(a),b));return a.c;}function Ad(a){return Promise.all(a.f.map(function(a){return a.remove();}));}function yd(a,b,c){for(var d in b) c = c["catch"]((function(a,b){return navigator.requestMediaKeySystemAccess(a,[b]);}).bind(null,d,b[d]));a.b.ea() && (c = c["catch"](function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c;}l = wd.prototype;l.hb = function(a,b,c){if(!this.g)return Bd();for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g < f.length;++g) {var h=f[g];if(!b.a.hasOwnProperty(h)){var k=e[h + "Capabilities"];if(k && k.length){for(var k=k[0],m=[],p={},t=0;t < a.length;++t) {var y=a[t];if(y.a.a == d && y.b == k.contentType && !(y.id in p)){m.push(y);p[y.id] = !0;var u;if(this.a){u = this.a;var y=y.a,v=new Ja();v.a = u.a;v.j = u.j;v.l = u.l;v.h = u.h;v.i = u.i;v.g = u.g;v.o = u.o;v.f = u.f;v.v = u.v;v.c = u.c?new Uint8Array(u.c.buffer):null;La(v,u.b);La(v,y.b);u = v;}else u = y.a;this.a = u;}}b.a[h] = m;}}}this.b.Ea(b);return c.createMediaKeys();};l.Eb = function(a){if(!this.g)return Bd();this.h = a;return this.g.setMediaKeys(this.h).then(w(this,function(){return this.g?this.a.c?this.h.setServerCertificate(this.a.c):Promise.resolve():Bd();})).then(w(this,function(){if(!this.g)return Bd();if(0 < this.b.va().length)Cd(this);else {for(var a=0;a < this.a.b.length;++a) {var c=this.a.b[a];this.Ra({type:"encrypted",initDataType:c.initDataType,initData:c.initData});}0 == this.a.b.length && F(this.l,this.g,"encrypted",this.Ra.bind(this));}}));};function Bd(){var a=Error("EmeManager destroyed");a.type = "destroy";return Promise.reject(a);}l.Ra = function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.j[c]){try{var d=Dd(this);}catch(e) {d = C(e);this.dispatchEvent(d);this.c.reject(e);return;}a = d.generateRequest(a.initDataType,a.initData);this.j[c] = !0;a["catch"](w(this,function(a){if(this.j){this.j[c] = !1;var b=C(a);this.dispatchEvent(b);this.c.reject(a);}}));this.f.push(d);}};function Cd(a){for(var b=a.b.va(),c=0;c < b.length;++c) {var d=Dd(a),e=d.load(b[c]);a.f.push(d);e.then(w(a,function(){this.o++;this.o >= this.f.length && this.c.resolve();}))["catch"](w(a,function(a){a = C(a);this.dispatchEvent(a);}));}}function Dd(a){var b=null;if(a.b.ea())try{b = a.h.createSession("persistent-license");}catch(c) {throw Error("Persistent licenses are not supported by this key system or platform.");}else b = a.h.createSession();F(a.l,b,"message",a.sb.bind(a));F(a.l,b,"keystatuseschange",a.kb.bind(a));return b;}l.sb = function(a){Ed(this,a.target,this.a,a.message);};l.kb = function(a){a = a.target.keyStatuses;for(var b={},c=a.keys(),d=c.next();!d.done;d = c.next()) {var e=ta(new Uint8Array(d.value)),d=a.get(d.value);b[e] = d;}this.b.Sa(b);};function Ed(a,b,c,d){d = Fd(c,d);vd(new ud(d.url,d.body,d.method,c.l,d.headers,a.w)).then(w(a,function(a){c.h && (a = c.h(a));return b.update(a);})).then(w(a,function(){var a=B({type:"sessionReady",detail:b});this.dispatchEvent(a);this.o++;this.o >= this.f.length && this.c.resolve();}))["catch"](w(a,function(a){a.Nb = b;a = C(a);this.dispatchEvent(a);}));}function Fd(a,b){var c={url:a.j,body:b.slice(0),method:"POST",headers:{}};if(!a.i)return c;a.i(c);c.url = ja(c,"url");if(null == c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer || "string" == typeof c.body || null == c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method = ja(c,"method");if("GET" != c.method && "POST" != c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers = ka(c,"headers",Object);if(null == c.headers)throw Error("'headers' cannot be null.");return c;};function N(a){D.call(this,null);this.a = a;this.b = null;this.f = new gb();this.j = this.l = null;this.H = 0;this.B = null;this.i = !1;this.g = new qd();this.c = {enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new ca()};this.o = 1;this.D = null;}q(N,D);n("shaka.player.Player",N);N.version = "v1.5.1";N.isBrowserSupported = function(){return !!window.MediaSource && !!window.MediaKeys && !!window.navigator && !!window.navigator.requestMediaKeySystemAccess && !!window.MediaKeySystemAccess && !!window.MediaKeySystemAccess.prototype.getConfiguration && !!window.Promise && !!Element.prototype.requestFullscreen && !!document.exitFullscreen && "fullscreenElement" in document && !!window.Uint8Array;};function xd(a){return "text/vtt" == a?!!window.VTTCue:MediaSource.isTypeSupported(a);}N.isTypeSupported = xd;N.setTextStyle = function(a){var b=document.getElementById("ShakaPlayerTextStyle");b || (b = document.createElement("style"),b.id = "ShakaPlayerTextStyle",document.head.appendChild(b));for(b = b.sheet;b.cssRules.length;) b.deleteRule(0);b.insertRule("::cue { " + Pb(a) + " }",0);};N.prototype.destroy = function(){return this.w().then(w(this,function(){this.f.destroy();this.a = this.f = null;}))["catch"](function(){});};N.prototype.destroy = N.prototype.destroy;N.prototype.w = function(){if(!this.b)return Promise.resolve();this.i && Gd(this);this.a.pause();hb(this.f);Hd(this);Id(this);this.l && (this.l.destroy(),this.l = null);this.a.src = "";var a=this.a.setMediaKeys(null);this.b && (this.b.destroy(),this.b = null);this.i = !1;this.g = new qd();return a;};N.prototype.unload = N.prototype.w;N.prototype.ma = function(a){var b=this.w();this.a.autoplay && (Sb("load"),F(this.f,this.a,"timeupdate",this.jb.bind(this)));a.I(this.c);a.$a(this.D);this.D = null;b = b.then(w(this,function(){return a.U();}));b["catch"](w(this,function(b){a.destroy();return Promise.reject(b);}));return b.then(w(this,function(){if(!this.a)return Td();this.b = a;F(this.f,this.b,"seekrangechanged",this.qb.bind(this));this.l = new wd(this,this.a,this.b);return this.l.initialize();})).then(w(this,function(){if(!this.a)return Td();F(this.f,this.a,"error",this.Fb.bind(this));F(this.f,this.a,"playing",this.ob.bind(this));F(this.f,this.a,"pause",this.nb.bind(this));return this.b.Ka(this,this.a);})).then(w(this,function(){if(!this.a)return Td();Ud(this);}))["catch"](w(this,function(a){if(!this.a)return Td();if("destroy" != a.type){var b=C(a);this.dispatchEvent(b);}return this.w().then(function(){return Promise.reject(a);});}));};N.prototype.load = N.prototype.ma;function Td(){var a=Error("Player destroyed");a.type = "destroy";return Promise.reject(a);}l = N.prototype;l.jb = function(){Vb("load");this.g.playbackLatency = Wb("load") / 1E3;this.f.sa(this.a,"timeupdate");};l.Fb = function(){if(this.a.error){var a=this.a.error.code;a != MediaError.MEDIA_ERR_ABORTED && (a = Error(Vd[a] || "Unknown playback error."),a.type = "playback",a = C(a),this.dispatchEvent(a));}};l.ob = function(){Sb("playing");!this.j && 0 > this.o && (this.a.playbackRate = 0,this.G(this.a.currentTime,Date.now(),this.o));this.i && Gd(this);};l.nb = function(){Vb("playing");var a=Wb("playing");if(!isNaN(a)){var b=this.g;b.playTime += a / 1E3;}Id(this);};l.qb = function(a){this.H = a.start;};l.ab = function(){if(!this.a.paused){Vb("playing");var a=Wb("playing");if(!isNaN(a)){var b=this.g;b.playTime += a / 1E3;Sb("playing");}}a = this.g;b = this.a;b.getVideoPlaybackQuality && (b = b.getVideoPlaybackQuality(),a.decodedFrames = b.totalVideoFrames,a.droppedFrames = b.droppedVideoFrames);return this.g;};N.prototype.getStats = N.prototype.ab;N.prototype.la = function(){return this.b?this.b.ja():[];};N.prototype.getVideoTracks = N.prototype.la;N.prototype.ta = function(){return this.b?this.b.pa():[];};N.prototype.getAudioTracks = N.prototype.ta;N.prototype.ka = function(){return this.b?this.b.Ha():[];};N.prototype.getTextTracks = N.prototype.ka;N.prototype.selectVideoTrack = function(a,b){return this.b?this.b.selectVideoTrack(a,void 0 == b?!0:b):!1;};N.prototype.selectVideoTrack = N.prototype.selectVideoTrack;N.prototype.ya = function(a,b){return this.b?this.b.Ya(a,void 0 == b?!0:b):!1;};N.prototype.selectAudioTrack = N.prototype.ya;N.prototype.fb = function(a){return this.b?this.b.Za(a,!1):!1;};N.prototype.selectTextTrack = N.prototype.fb;N.prototype.T = function(a){this.b && this.b.Ga(a);};N.prototype.enableTextTrack = N.prototype.T;N.prototype.K = function(a){this.h({enableAdaptation:a});};N.prototype.enableAdaptation = N.prototype.K;N.prototype.S = function(){return this.c.enableAdaptation;};N.prototype.getAdaptationEnabled = N.prototype.S;N.prototype.da = function(a){this.h({streamBufferSize:a});};N.prototype.setStreamBufferSize = N.prototype.da;N.prototype.X = function(){return Number(this.c.streamBufferSize);};N.prototype.getStreamBufferSize = N.prototype.X;N.prototype.gb = function(a){this.h({licenseRequestTimeout:a / 1E3});};N.prototype.setLicenseRequestTimeout = N.prototype.gb;N.prototype.Z = function(a){this.h({mpdRequestTimeout:a / 1E3});};N.prototype.setMpdRequestTimeout = N.prototype.Z;N.prototype.M = function(a){this.h({segmentRequestTimeout:a / 1E3});};N.prototype.setRangeRequestTimeout = N.prototype.M;N.prototype.ca = function(a){this.h({preferredLanguage:a});};N.prototype.setPreferredLanguage = N.prototype.ca;N.prototype.ba = function(a){Id(this);0 <= a?this.a.playbackRate = a:this.a.paused || (this.a.playbackRate = 0,this.G(this.a.currentTime,Date.now(),a));this.o = a;};N.prototype.setPlaybackRate = N.prototype.ba;N.prototype.V = function(){return this.o;};N.prototype.getPlaybackRate = N.prototype.V;N.prototype.O = function(a){this.h({restrictions:a});};N.prototype.setRestrictions = N.prototype.O;N.prototype.W = function(){return this.c.restrictions.clone();};N.prototype.getRestrictions = N.prototype.W;N.prototype.eb = function(a){this.D = a;};N.prototype.setPlaybackStartTime = N.prototype.eb;N.prototype.I = function(){return this.b?this.b.Xa():!1;};N.prototype.isLive = N.prototype.I;N.prototype.h = function(a){if(a){var b=ia(a,"enableAdaptation","boolean");null != b && (this.c.enableAdaptation = b);b = ha(a,"streamBufferSize");null != b && (this.c.streamBufferSize = b);b = ha(a,"licenseRequestTimeout");null != b && (this.c.licenseRequestTimeout = b);b = ha(a,"mpdRequestTimeout");null != b && (this.c.mpdRequestTimeout = b);b = ha(a,"segmentRequestTimeout");null != b && (this.c.segmentRequestTimeout = b);b = ja(a,"preferredLanguage");null != b && (this.c.preferredLanguage = b);a = ka(a,"restrictions",ca);null != a && (this.c.restrictions = a.clone());this.b && this.b.I(this.c);}};N.prototype.configure = N.prototype.h;N.prototype.ua = function(){return this.c;};N.prototype.getConfiguration = N.prototype.ua;function Id(a){a.j && (window.clearTimeout(a.j),a.j = null);}function Ud(a){Hd(a);a.B = window.setTimeout(a.Y.bind(a),100);}function Hd(a){a.B && (window.clearTimeout(a.B),a.B = null);}N.prototype.G = function(a,b,c){this.j = null;var d=(Date.now() - b) / 1E3 * c;this.a.currentTime < this.H + (this.I()?1:.05)?this.a.pause():(d = Math.max(this.H,a + d),this.a.currentTime = d,this.j = window.setTimeout(this.G.bind(this,a,b,c),250));};function Gd(a){Vb("buffering");var b=a.g;b.bufferingTime += Wb("buffering") / 1E3;a.i = !1;a.dispatchEvent(B({type:"bufferingEnd"}));}N.prototype.Y = function(){Ud(this);if(!this.a.ended && !this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length - 1):0,a=Math.max(b - this.a.currentTime,0);if(this.i)b = this.b.Wa(),a > b && (Gd(this),this.a.play());else {var c=this.a.duration,c=isNaN(c)?0:Math.max(c - .05,0),b=b >= c || this.a.currentTime >= c;!this.a.paused && !b && .2 > a && (this.i = !0,this.a.pause(),this.g.bufferingHistory.push(Ga() / 1E3),Sb("buffering"),this.dispatchEvent(B({type:"bufferingStart"})));}}};var Vd={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Wd(a){for(var b=0;b < a.length;++b) for(var c=a[b],d=0;d < c.a.length;++d) {for(var e=c.a[d],f=e,g=0;g < f.m.length;++g) xd(ad(f.m[g])) || (f.m.splice(g,1),--g);0 == e.m.length && (c.a.splice(d,1),--d);}}function Xd(a){for(var b=0;b < a.length;++b) for(var c=a[b],d=0;d < c.a.length;++d) c.a[d].m.sort(Yd);}function Yd(a,b){var c=a.bandwidth || Number.MAX_VALUE,d=b.bandwidth || Number.MAX_VALUE;return c < d?-1:c > d?1:0;};function Zd(a){this.a = a;}Zd.prototype.destroy = function(){this.a.destroy();this.a = null;};function $d(a,b){var c=ae(b),d=ae(a.a);return Promise.all([c,d]).then(w(a,function(a){var c=a[0];a = a[1];var d=this.a.a;Wd(d);Xd(d);b.f = this.a.f;b.g = this.a.g?this.a.g.clone():null;b.c = this.a.c;d = [];be(b,this.a,c,a,d);c = b.a;Wd(c);Xd(c);return Promise.resolve(d);}));}function ae(a){function b(a,b){return a.concat(b);}var c=a.a.map(function(a){return a.a;}).reduce(b,[]).map(function(a){return a.m;}).reduce(b,[]);a = c.map(function(a){return a.F.create();});return Promise.all(a).then(function(a){for(var b={},f=0;f < c.length;++f) b[c[f].A] = a[f];return Promise.resolve(b);});}function be(a,b,c,d,e){var f=new A();a.a.forEach(function(a,b){f.push(a.id || "" + b,a);});var g=new A();b.a.forEach(function(a,b){g.push(a.id || "" + b,a);});a = Ea(f);for(b = 0;b < a.length;++b) {var h=a[b],k=f.get(h);1 < k.length || (h = g.get(h)) && 0 != h.length && 1 == h.length && (ce(k[0],h[0],c,d,e),k[0].b = h[0].b);}}function ce(a,b,c,d,e){var f=new A();a.a.forEach(function(a,b){f.push(a.id || "" + b,a);});var g=new A();b.a.forEach(function(a,b){g.push(a.id || "" + b,a);});a = Ea(f);for(b = 0;b < a.length;++b) {var h=a[b],k=f.get(h);1 < k.length || (h = g.get(h)) && 0 != h.length && 1 == h.length && de(k[0],h[0],c,d,e);}}function de(a,b,c,d,e){var f=new A();a.m.forEach(function(a,b){f.push(a.id || "" + b,a);});var g=new A();b.m.forEach(function(a,b){g.push(a.id || "" + b,a);});b = {};for(var h=Ea(f),k=0;k < h.length;++k) {var m=h[k];b[m] = m;var p=f.get(m);1 < p.length || ((m = g.get(m)) && 0 != m.length?1 == m.length && (ee(p[0],m[0],c,d),p[0].C = m[0].C,m[0].C = null,p[0].c = m[0].c):(e.push(p[0]),a.m.splice(a.m.indexOf(p[0]),1)));}h = Ea(g);for(k = 0;k < h.length;++k) m = h[k],b[m] || (b[m] = m,m = g.get(m),a.m.push(m[0]));}function ee(a,b,c,d){a = c[a.A];b = d[b.A];a.length();a.Ca(b) && a.length();};function O(){this.a = this.b = null;this.f = new gb();this.c = Number.POSITIVE_INFINITY;this.i = !0;this.g = !1;}n("shaka.media.SimpleAbrManager",O);O.prototype.destroy = function(){this.f.destroy();this.a = this.b = this.f = null;};O.prototype.initialize = function(a,b){this.b || this.a || (this.b = a,this.a = b);};O.prototype.start = function(){this.b && this.a && !this.g && (this.c = Date.now() + 4E3,F(this.f,this.b,"bandwidth",this.v.bind(this)),F(this.f,this.a,"adaptation",this.j.bind(this)),F(this.f,this.a,"trackschanged",this.h.bind(this)),this.g = !0);};O.prototype.enable = function(a){this.i = a;};O.prototype.getInitialVideoTrackId = function(){if(!this.b || !this.a)return null;var a=fe(this);return a?a.id:null;};O.prototype.selectVideoTrack = function(a,b,c){this.g && this.a.selectVideoTrack(a.id,b,c);};O.prototype.v = function(){Date.now() < this.c || this.h();};O.prototype.h = function(){if(this.i){var a=fe(this);if(a){if(a.active){this.c = Date.now() + 3E3;return;}this.selectVideoTrack(a,!1);}this.c = Number.POSITIVE_INFINITY;}};O.prototype.j = function(){this.c == Number.POSITIVE_INFINITY && (this.c = Date.now() + 3E4);};function fe(a){var b=a.a.ja();if(0 == b.length)return null;b.sort(ea);var c;a: {c = a.a.pa();for(var d=0;d < c.length;++d) if(c[d].active){c = c[d];break a;}c = null;}c = c?c.bandwidth:0;a = a.b.getBandwidth();for(var d=b[0],e=0;e < b.length;++e) {var f=b[e],g=e + 1 < b.length?b[e + 1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth && (g = (g.bandwidth + c) / .85,a >= (f.bandwidth + c) / .95 && a <= g && (d = f,d.active)))break;}return d;};function ge(a,b,c){D.call(this,null);this.f = a;this.c = b;this.b = Ka(c);this.a = null;}q(ge,D);n("shaka.player.HttpVideoSource",ge);ge.prototype.I = function(){};ge.prototype.destroy = function(){this.a && (this.a.parentElement.removeChild(this.a),this.a = null);this.v = this.b = null;};l = ge.prototype;l.Ka = function(a,b){this.v = a;var c=b.mediaKeys;b.src = this.f;c = b.setMediaKeys(c);this.c && (this.a = document.createElement("track"),this.a.src = this.c,b.appendChild(this.a),this.a.track.mode = "showing");return c;};l.U = function(){return Promise.resolve();};l.ja = function(){return [];};l.pa = function(){return [];};l.Ha = function(){return [];};l.Wa = function(){return 5;};l.Oa = function(){var a=new ed();a.a = this.b;return [a];};l.Ea = function(){};ge.prototype.selectVideoTrack = function(){return !1;};l = ge.prototype;l.Ya = function(){return !1;};l.Za = function(){return !1;};l.Ga = function(a){this.a && (this.a.track.mode = a?"showing":"disabled");};l.$a = function(){};l.va = function(){return [];};l.ea = function(){return !1;};l.Xa = function(){return !1;};l.Sa = function(a){for(var b in a) {var c=a[b],d=oa[c] || null;if(d){var e=la(b),d=Error("Key " + e + " is not usable. " + d);d.type = "drm";d.code = c;c = C(d);this.dispatchEvent(c);}}};function P(a,b,c){D.call(this,null);this.a = a;this.X = b;this.i = new gb();this.g = new MediaSource();this.f = null;this.ba = 0;this.b = new A();this.G = c;this.G.initialize(b,this);this.D = !1;this.H = "en";this.da = !1;this.K = null;this.w = new r();this.h = new ca();this.B = null;this.ua = 1;this.c = {};this.ca = new r();this.V = 0;this.ta = !1;this.o = {};this.Y = this.W = this.Z = null;this.S = {};}q(P,D);n("shaka.player.StreamVideoSource",P);P.prototype.I = function(a){null != a.streamBufferSize && (this.S.streamBufferSize = a.streamBufferSize);null != a.segmentRequestTimeout && (this.S.segmentRequestTimeout = a.segmentRequestTimeout);he(this);null != a.enableAdaptation && this.G.enable(Boolean(a.enableAdaptation));null != a.mpdRequestTimeout && (this.ba = Number(a.mpdRequestTimeout));null != a.preferredLanguage && (this.H = Sa(String(a.preferredLanguage)));null != a.restrictions && (this.h = a.restrictions,this.D && ie(this));};P.prototype.destroy = function(){this.w.destroy();this.ca.destroy();this.ca = this.w = null;this.W && (window.clearTimeout(this.W),this.W = null);this.Z && (window.clearTimeout(this.Z),this.Z = null);this.o = null;this.i.destroy();this.i = null;ga(this.c).forEach(function(a){a.destroy();});this.b = this.c = null;this.a && (this.a.destroy(),this.a = null);this.G.destroy();this.v = this.h = this.K = this.f = this.g = this.X = this.G = null;};l = P.prototype;l.Ka = function(a,b){if(!this.D){var c=Error("Cannot call attach() right now.");c.type = "app";return Promise.reject(c);}this.v = a;this.f = b;this.K = a.ab();F(this.i,this.g,"sourceopen",this.mb.bind(this));F(this.i,this.X,"bandwidth",this.Gb.bind(this));c = this.f.mediaKeys;this.f.src = window.URL.createObjectURL(this.g);c = this.f.setMediaKeys(c);return Promise.all([this.w,c]);};l.U = function(){if(this.D){var a=Error("Cannot call load() right now.");a.type = "app";return Promise.reject(a);}if(!this.a || 0 == this.a.a.length)return a = Error("The manifest does not specify any content."),a.type = "stream",Promise.reject(a);a = this.a.a;Wd(a);Xd(a);if(0 == this.a.a.length || 0 == this.a.a[0].a.length)return a = Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type = "stream",Promise.reject(a);this.D = !0;this.S.initialStreamBufferSize = this.a.c;he(this);ie(this);return Promise.resolve();};l.vb = function(){var a=Date.now(),b=this.Z = null;this.Ta(this.a.g).then(w(this,function(a){b = new Zd(a);return $d(b,this.a);})).then(w(this,function(c){b.destroy();b = null;for(var d=0;d < c.length;++d) je(this,c[d]);this.S.initialStreamBufferSize = this.a.c;he(this);ie(this);0 == Object.keys(this.c).length?ke(this):le(this,(Date.now() - a) / 1E3);}))["catch"](w(this,function(a){b && (b.destroy(),b = null);"aborted" != a.type && (a = C(a),this.dispatchEvent(a),this.a && le(this,0));}));};l.Ta = function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.");};function je(a,b){var c=b.a.split("/")[0],d=a.c[c];if(d && d.oa() == b){var e=a.b.get(b.a.split("/")[0]),f=e.map(function(a){return a.m;}).reduce(function(a,b){return a.concat(b);},[]).filter(function(a){return a.L && a.J;});if(0 == f.length){e.push(b);return;}a.o[c].Ia == b && delete a.o[c];d.ra(f[0],!0);b.destroy();}b.destroy();}l.ja = function(){if(!this.b.a.hasOwnProperty("video"))return [];for(var a=this.c.video,a=(a = a?a.oa():null)?a.A:0,b=[],c=this.b.get("video"),d=0;d < c.length;++d) for(var e=c[d],f=0;f < e.m.length;++f) {var g=e.m[f];if(g.L && g.J){var h=g.A,g=new da(h,g.bandwidth,g.width,g.height);h == a && (g.active = !0);b.push(g);}}return b;};P.prototype.getVideoTracks = P.prototype.ja;P.prototype.pa = function(){if(!this.b.a.hasOwnProperty("audio"))return [];for(var a=this.c.audio,a=(a = a?a.oa():null)?a.A:0,b=[],c=this.b.get("audio"),d=0;d < c.length;++d) for(var e=c[d],f=e.lang,g=0;g < e.m.length;++g) {var h=e.m[g];if(h.L && h.J){var k=h.A,h=new fa(k,h.bandwidth,f);k == a && (h.active = !0);b.push(h);}}return b;};P.prototype.getAudioTracks = P.prototype.pa;P.prototype.Ha = function(){if(!this.b.a.hasOwnProperty("text"))return [];for(var a=this.c.text,b=a?a.oa():null,b=b?b.A:0,c=[],d=this.b.get("text"),e=0;e < d.length;++e) for(var f=d[e],g=f.lang,h=0;h < f.m.length;++h) {var k=f.m[h].A,m=new ba(k,g);k == b && (m.active = !0,m.enabled = a.Aa());c.push(m);}return c;};P.prototype.getTextTracks = P.prototype.Ha;P.prototype.Wa = function(){var a=null,b;for(b in this.c) {var c=this.c[b].Fa();0 < c && (a = null != a?Math.min(a,c):c);}return a || 0;};P.prototype.Oa = function(){var a;if(this.D){a = this.a.a[0];for(var b=[],c=0;c < a.a.length;++c) b.push.apply(b,dd(a.a[c]));a = b;}else a = [];return a;};P.prototype.Ea = function(a){if(this.D){for(var b={},c=this.a.a[0],d=0;d < c.a.length;++d) {var e=c.a[d];b[e.A] = e;}this.b.a = {};c = Ea(a);for(d = 0;d < c.length;++d) {var e=c[d],f=a.get(e);if("video" == e){var g=f[0].id;this.b.push(e,b[g]);}else if("audio" == e)for(var g=f[0].b.split(";")[0],h=0;h < f.length;++h) {var k=f[h];k.b.split(";")[0] == g && this.b.push(e,b[k.id]);}else for(h = 0;h < f.length;++h) g = f[h].id,this.b.push(e,b[g]);}this.da = !0;if(a = this.b.get("audio"))me(this,a),this.b.a.audio = a,a = a[0].lang || this.H,Ra(2,this.H,a) && (this.da = !1);if(a = this.b.get("text"))me(this,a),this.b.a.text = a,a = a[0].lang || this.H,Ra(2,this.H,a) || (this.da = !1);}};P.prototype.selectVideoTrack = function(a,b,c){return ne(this,"video",a,b,c);};l = P.prototype;l.Ya = function(a,b){return ne(this,"audio",a,b);};l.Za = function(a,b){return ne(this,"text",a,b);};l.Ga = function(a){var b=this.c.text;b && b.wa(a);};l.$a = function(a){this.Y = a;};function ie(a){if(a.h){for(var b=!1,c=0;c < a.a.a.length;++c) for(var d=a.a.a[c],e=0;e < d.a.length;++e) {var f=d.a[e];if("video" == f.contentType)for(var g=0;g < f.m.length;++g) {var h=f.m[g],k=h.J;h.J = !0;a.h.maxWidth && h.width > a.h.maxWidth && (h.J = !1);a.h.maxHeight && h.height > a.h.maxHeight && (h.J = !1);a.h.maxBandwidth && h.bandwidth > a.h.maxBandwidth && (h.J = !1);a.h.minBandwidth && h.bandwidth < a.h.minBandwidth && (h.J = !1);k != h.J && (b = !0);}}0 != Ca(a.b).length && b && (oe(a),0 < a.ja().length || (b = Error("The application has restricted all video tracks!"),b.type = "app",b = C(b),a.dispatchEvent(b)));}}l.va = function(){return [];};l.ea = function(){return !1;};l.Xa = function(){return this.a?this.a.b:!1;};l.Sa = function(a){for(var b,c=!1,d=new A(),e=Ca(this.b),f=0;f < e.length;++f) for(var g=e[f],h=0;h < g.m.length;++h) {var k=g.m[h];k.f.forEach(function(a){d.push(a,k);});}for(b in a) if((e = oa[a[b]] || null,g = d.get(b)))for(f = 0;f < g.length;++f) k = g[f],h = k.L,k.L = !e,h != k.L && (c = !0);else la(b);c && (oe(this),b = this.pa(),a = this.ja(),b = this.b.a.hasOwnProperty("audio") && 0 == b.length,a = this.b.a.hasOwnProperty("video") && 0 == a.length,b || a) && (a = Error("The key system has restricted all " + (b && a?"audio and video tracks.":b?"audio tracks.":"video tracks.")),a.type = "drm",a = C(a),this.dispatchEvent(a));};function oe(a){var b=B({type:"trackschanged",bubbles:!0});a.dispatchEvent(b);}function ne(a,b,c,d,e){if(!a.b.a.hasOwnProperty(b) || !a.c[b])return !1;for(var f=a.b.get(b),g=0;g < f.length;++g) for(var h=f[g],k=0;k < h.m.length;++k) {var m=h.m[k];if(m.A == c){if(!m.L || !m.J)return !1;if("text" != b && !a.ta)return c = a.o[b],a.o[b] = {Ia:m,La:null != c && c.La || d,Ma:null != c && c.Ma || e},!0;rd(a.K,m);a.c[b].ra(m,d,e);return !0;}}return !1;}function me(a,b){for(var c=0;2 >= c;++c) for(var d=0;d < b.length;++d) {var e=b[d];if(Ra(c,a.H,e.lang)){b.splice(d,1);b.splice(0,0,e);return;}}for(d = 0;d < b.length;++d) if((e = b[d],e.b)){b.splice(d,1);b.splice(0,0,e);break;}}l.mb = function(){this.i.sa(this.g,"sourceopen");ke(this).then(w(this,function(){this.w && this.w.resolve();}))["catch"](w(this,function(a){this.w && this.w.reject(a);}));};function ke(a){for(var b=[],c=["audio","video","text"],d=0;d < c.length;++d) {var e=c[d];a.b.a.hasOwnProperty(e) && b.push(a.b.get(e)[0]);}for(var f=pe(a,b),d=0;d < c.length;++d) if((e = c[d],a.b.a.hasOwnProperty(e) && !f[e]))return a = Error("Unable to select an initial " + e + " stream: all " + e + " streams have been restricted (by the application or by the key system)."),a.type = "stream",Promise.reject(a);b = ga(f).map(function(a){return a.F.create();});return Promise.all(b).then(w(a,function(a){if(!a.every(function(a){return a.length();}))return a = Error("Some streams are not available."),a.type = "stream",Promise.reject(a);a = qe(this,a);if(!a)return a = Error("Some streams are not available."),a.type = "stream",Promise.reject(a);if(!re(this,f))return a = Error("Failed to create Stream objects."),a.type = "stream",Promise.reject(a);this.G.start();se(this,f,a);return Promise.resolve();}))["catch"](w(a,function(a){if("aborted" != a.type)return Object.keys(this.c),this.a.b?(le(this,0),Promise.resolve()):Promise.reject(a);}));}function pe(a,b){for(var c={},d=0;d < b.length;++d) {var e=b[d],f=null;if("video" == e.contentType){var g=a.G.getInitialVideoTrackId();if(null == g)continue;f = e.m.filter(function(a){return a.A == g;});if(0 == f.length)continue;f = f[0];}else if("audio" == e.contentType){f = e.m.filter(function(a){return a.L && a.J;});if(0 == f.length)continue;f = e.m[Math.floor(f.length / 2)];}else 0 < e.m.length && (f = e.m[0]);c[e.contentType] = f;}return c;}function re(a,b){var c={},d;for(d in b) {var e=b[d],e="text" == d?new hd(a,a.f):te(a,e);if(!e)return ga(c).forEach(function(a){a.destroy();}),!1;c[d] = e;}a.c = c;return !0;}function te(a,b){var c=new id(a,a.f,a.g,ad(b),a.X);c.H(a.S);return c;}function se(a,b,c){a.ua = a.f.playbackRate;a.f.playbackRate = 0;ue(a,c);var d;d = a.a.b?c.end:a.Y && a.Y <= c.end && a.Y >= c.start?a.Y:c.start;F(a.i,a.f,"seeking",a.rb.bind(a));a.f.currentTime != d && (a.f.currentTime = d,a.B = d);ve(a,c.start,c.end);c = [];for(var e in a.c) {d = a.c[e];c.push(d.cb(a.ca));F(a.i,d,"ended",a.tb.bind(a));var f=b[e];rd(a.K,f);d.ra(f,!1);}Promise.all(c).then(a.ib.bind(a))["catch"](w(a,function(a){"destroy" != a.type && (a = C(a),this.dispatchEvent(a));}));a.Ga(a.da);}l.ib = function(a){Ia(a && a.length == Object.keys(this.c).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d < a.length;++d) var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a = we(this);for(d = 0;d < a.length;++d) a[d].ha(c);xe(this,a,c);d = Ca(this.b).map(function(a){return a.m;}).reduce(function(a,b){return a.concat(b);},[]).map(function(a){var b=[a.F.create()];a.C && b.push(a.C.create());return Promise.all(b);});Promise.all(d).then(w(this,function(a){for(var b=0;b < a.length;++b) a[b][0].ha(c);this.ta = !0;for(var d in this.o) a = this.o[d],b = this.c[d],rd(this.K,a.Ia),b.ra(a.Ia,a.La,a.Ma);this.o = {};}))["catch"](w(this,function(a){"aborted" != a.type && (a = C(a),this.dispatchEvent(a));}));};function xe(a,b,c){if(b = qe(a,b))ue(a,b),ve(a,b.start,b.end);0 != c?(c = a.f.currentTime + c,a.f.currentTime = c,a.B = c):c = a.f.currentTime;a.a.b && b && (a.V = b.end - c,a.V = Math.max(a.V,0));a.f.playbackRate = a.ua;a.a.b && null != a.a.f && le(a,a.V);ye(a);a.ca.resolve();}function ue(a,b){if(a.a.b)isNaN(a.g.duration) && (a.g.duration = b.end + 2592E3);else if(isNaN(a.g.duration) || b.end > a.g.duration){a.g.duration = b.end;for(var c=0;c < a.g.sourceBuffers.length;++c) a.g.sourceBuffers[c].appendWindowEnd = b.end;}}l.wb = function(){this.W = null;ye(this);var a=qe(this,we(this));a && (ve(this,a.start,a.end),this.f.paused || ze(this,this.f.currentTime,a.start,a.end));};function ve(a,b,c){b = B({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b);}l.rb = function(){var a=this.f.currentTime;if(null != this.B){if(a >= this.B - .01 && a <= this.B + .01){this.B = null;return;}this.B = null;}var b=qe(this,we(this));if(b){var c=b.end;(b = ze(this,a,b.start,c)) || (a <= c + .01?b = !1:(this.f.currentTime = c,b = !0));if(!b)for(var d in this.c) this.c[d].Va();}};function ze(a,b,c,d){if(b >= c - .01)return !1;a.f.currentTime = Math.min(c + (a.a.b?a.a.c:0),d);return !0;}l.tb = function(){if(!this.a.b){for(var a in this.c) if(!this.c[a].Qa())return;this.g.endOfStream();}};l.Gb = function(){var a=this.K,b=this.X.getBandwidth();a.estimatedBandwidth = b;a.bandwidthHistory.push(new td(b));};function we(a){return ga(a.c).map(function(a){return a.Pa();}).filter(function(a){return null != a;});}function qe(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e < b.length;++e) {var f=b[e].Ba(),c=Math.max(c,f.start);null != f.end && (d = Math.min(d,f.end));}if(d == Number.POSITIVE_INFINITY)if((d = a.a.a[0],d.b))d = (d.start || 0) + d.b;else return null;a.a.b && (d = Math.max(d - (a.a.c + a.V),c));return c > d?null:{start:c,end:d};}function le(a,b){if(null != a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c - b,0);a.Z = window.setTimeout(a.vb.bind(a),1E3 * c);}}function ye(a){a.a.b && (a.W = window.setTimeout(a.wb.bind(a),1E3));}function he(a){for(var b in a.c) a.c[b].H(a.S);};function Ae(a,b){wb.call(this,"readwrite",b);this.j = a;this.b = 0;}q(Ae,wb);function Be(a,b,c,d,e){for(var f=[],g=[],h=0,k=0,m=[],p=b.map(function(a){return a.F.create();}),p=Promise.all(p),t=b.map(function(a){return a.C.create();}),t=Promise.all(t),p=Promise.all([p,t]).then(function(a){f = a[0];g = a[1];h = f.reduce(function(a,b){return a + b.length();},0);}),t=0;t < b.length;++t) p = p.then((function(a){return Ce(this,b[a],f[a],g[a],h,k);}).bind(a,t)),p = p.then((function(a,b){k += f[a].length();m.push(b);}).bind(a,t));return p.then(w(a,function(){return De(Db(this));})).then(w(a,function(a){var b=new r();c = na(c);var f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.a,license_server:e.j,with_credentials:e.l,distinctive_identifier:e.g,audio_robustness:e.f,video_robustness:e.v},g=Db(this).put(f);g.onsuccess = function(){b.resolve(a);};g.onerror = function(){b.reject(g.error);};return b;}));}function Ee(a,b){return Eb(Db(a),b).then(w(a,function(a){var d=[],e;for(e in a.stream_ids) d.push(Fe(this,a.stream_ids[e]));a = Db(this);d.push(a["delete"](b));return Promise.all(d);}));}function Ce(a,b,c,d,e,f){var g=[De(Cb(a)),De(zb(a).index("stream"))],g=Promise.all(g).then(w(a,function(a){return {qa:Math.max(a[0],a[1]),ga:new ArrayBuffer(0),Da:0,u:[],za:null,Jb:e,Ua:f};})),g=g.then(a.f.bind(a,c));return g = g.then(a.g.bind(a,b,d));}function De(a){var b=new r(),c=a.openCursor(null,"prev");c.onsuccess = function(a){a.target.result?b.resolve(a.target.result.key + 1):b.resolve(0);};c.onerror = function(){b.reject(c.error);};return b;}Ae.prototype.g = function(a,b,c){var d=new r();a = {stream_id:c.qa,mime_type:a.a,codecs:a.b,init_segment:b,references:c.u};var e=Cb(this).put(a);e.onsuccess = function(){d.resolve(c.qa);};e.onerror = function(){d.reject(e.error);};return d;};Ae.prototype.f = function(a,b){for(var c=Promise.resolve(),d=0;d < a.length();++d) var e=a.get(d),f=d == a.length() - 1,f=this.c.bind(this,e,b,f),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b);})["catch"](w(this,function(a){Fe(this,b.qa);return Promise.reject(a);}));};Ae.prototype.c = function(a,b,c,d){var e=new r();0 == b.ga.byteLength && (b.za = a);b.ga = Ge(b.ga,d);b.Ua++;var f=B({type:"progress",detail:b.Ua / b.Jb * 100,bubbles:!0});if(1048576 <= b.ga.byteLength || c){c = {stream_id:b.qa,segment_id:b.Da,content:b.ga};var g=zb(this).put(c);b.u.push({start_time:b.za.b,start_byte:b.za.url.f,end_time:a.a,url:"idb://" + b.qa + "/" + b.Da});b.Da++;b.ga = new ArrayBuffer(0);g.onerror = function(){e.reject(g.error);};g.onsuccess = w(this,function(){this.dispatchEvent(f);e.resolve();});}else this.dispatchEvent(f),e.resolve();return e;};function Ge(a,b){var c=new Uint8Array(a.byteLength + b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer;}Ae.prototype.i = function(a){var b=new pb();b.c = 1E3 * this.b;return qb(a.url,b,this.j);};function Fe(a,b){var c=new r(),d=Cb(a)["delete"](b);d.onerror = function(){c.reject(d.error);};var e=zb(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess = function(a){if(a = a.target.result)e["delete"](a.primaryKey),a["continue"]();};e.transaction.oncomplete = function(){c.resolve();};return c;};function Q(a,b,c,d){K.call(this,a);this.f = b;this.o = c;this.v = d;this.c = this.j = this.a = null;He(this);}q(Q,K);Q.prototype.destroy = function(){this.o = this.f = null;K.prototype.destroy.call(this);};Q.prototype.ia = function(a){Ie(this,Ga() / 1E3);return K.prototype.ia.call(this,a);};Q.prototype.Ca = function(a){Wc(this,a);null == this.a && He(this);return !0;};function He(a){if(0 != a.length()){a.length();var b=null != M(a).a?M(a).a:M(a).b;if(a.f.b > a.v)a.a = b;else {var c=a.v - (a.f.b + a.o.start);0 > c?a.a = b:c < Math.max(M(a).b,M(a).a || 0)?(M(a),a.a = b):a.a = c;}a.j = M(a).b;a.c = L(a).b;}}Q.prototype.ha = function(a){a = K.prototype.ha.call(this,a);null != this.a && (this.j += a,this.c += a,this.j > this.a && (this.a += a));return a;};Q.prototype.Ba = function(){return Je(this,Ga() / 1E3);};function Je(a,b){Ie(a,b);if(null == a.a || null == a.j || null == a.c)return {start:0,end:0};var c=b - a.v,d=a.a + c;null != a.f.f && (d = d - a.c - a.f.f,0 < d && (a.c += d));c = a.j + c;c = 0 < a.length()?null != M(a).a?Math.min(c,M(a).a):c:a.c;c = Math.max(c,a.c);return {start:a.c,end:c};}function Ie(a,b){if(null != a.f.f)if(null == a.a)a.length();else {for(var c=a.a + (b - a.v),d=0,e=0;e < a.u.length;++e) {var f=null;e < a.u.length - 1?f = a.u[e + 1].a:(f = a.u[e],f = null != f.a?f.a + (f.a - f.b):null);if(null != f && f < c - a.f.f)++d;else break;}0 < d && a.u.splice(0,d);}};function Ke(a,b,c,d,e,f,g){this.g = a;this.j = b;this.f = c;this.a = d;this.c = e;this.v = f;this.i = this.b = null;this.h = g;}Ke.prototype.destroy = function(){this.h = this.j = this.g = null;this.a.g();this.a = null;this.c && (this.c.g(),this.c = null);this.i && (this.i.destroy(),this.i = null);this.b = null;};Ke.prototype.create = function(){if(this.b)return this.b;var a=[qb(this.a)];"webm" == this.f && a.push(qb(this.c));return this.b = Promise.all(a).then(w(this,function(a){var c=a[0];a = a[1] || null;var d=null;"mp4" == this.f?(d = new Uc(),d = d.parse(new DataView(c),this.a.f,this.a.c,this.h)):"webm" == this.f && (d = new Vc(),d = d.parse(new DataView(c),new DataView(a),this.a.c,this.h));if(!d)return c = Error("Failed to parse SegmentReferences from " + this.a.toString() + " (or one of its fallbacks)."),c.type = "stream",Promise.reject(c);var e;"dynamic" == this.g.type?e = new Q(d,this.g,this.j,this.v):e = new K(d);return Promise.resolve(e);}));};function Le(a,b,c,d,e){this.b = a;this.c = b;this.f = c;this.h = d;this.a = null;this.g = e;}Le.prototype.destroy = function(){this.g = this.f = this.c = this.b = null;this.a && (this.a.destroy(),this.a = null);};Le.prototype.create = function(){if(this.a)return Promise.resolve(this.a);for(var a=this.f.a,b=Me(a.c,a.b || 1,this.c.a || 0),c=[],d=0;d < b.length;++d) {var e=b[d].start,f=e / a.b,g=b[d].end / a.b,e=Ne(this.g,this.f,d + a.j,e);if(!e)return a = Error("Failed to generate media URL."),a.type = "dash",Promise.reject(a);var h=(a.i || 0) / a.b;c.push(new Rc(f - h,g - h,e));}"dynamic" == this.b.type?this.a = new Q(c,this.b,this.c,this.h):this.a = new K(c);return Promise.resolve(this.a);};function Oe(){this.id = this.url = null;this.type = "static";this.c = this.j = this.s = null;this.h = 5;this.f = this.b = this.g = null;this.i = 1;this.a = [];}function Pe(){this.g = this.f = this.c = this.s = this.a = this.start = this.id = null;this.b = [];}function Qe(){this.i = this.b = this.height = this.width = this.contentType = this.lang = this.group = this.id = null;this.c = !1;this.h = this.g = this.f = this.s = null;this.j = [];this.a = [];}function Re(){this.value = null;}function Se(){this.contentType = this.lang = this.id = null;}function Te(){this.a = this.b = this.g = this.s = this.h = this.f = this.height = this.width = this.bandwidth = this.lang = this.id = null;this.c = [];}function Ue(){this.value = this.schemeIdUri = this.b = null;this.children = [];this.a = this.pssh = null;}function Ve(){this.parsedPssh = this.psshBox = null;}function We(){this.url = null;}function Xe(){this.url = null;}function Ze(){this.s = null;this.g = 1;this.c = this.b = this.a = this.f = null;}Ze.prototype.clone = function(){var a=new Ze();a.s = $e(this.s);a.g = this.g;a.f = this.f;a.a = R(this.a);a.b = R(this.b);a.c = R(this.c);return a;};function af(){this.a = this.url = null;}af.prototype.clone = function(){var a=new af();a.url = $e(this.url);a.a = R(this.a);return a;};function bf(){this.a = this.url = null;}bf.prototype.clone = function(){var a=new bf();a.url = $e(this.url);a.a = R(this.a);return a;};function cf(){this.s = null;this.f = 1;this.b = this.g = null;this.i = 1;this.h = null;this.a = [];this.c = null;}cf.prototype.clone = function(){var a=new cf();a.s = $e(this.s);a.f = this.f;a.g = this.g;a.b = this.b;a.i = this.i;a.h = R(this.h);a.a = $e(this.a) || [];a.c = R(this.c);return a;};function df(){this.a = this.b = null;}df.prototype.clone = function(){var a=new df();a.b = $e(this.b);a.a = R(this.a);return a;};function ef(){this.b = 1;this.a = this.i = null;this.j = 1;this.c = this.g = this.f = this.h = null;}ef.prototype.clone = function(){var a=new ef();a.b = this.b;a.i = this.i;a.a = this.a;a.j = this.j;a.h = this.h;a.f = this.f;a.g = this.g;a.c = R(this.c);return a;};function ff(){this.a = [];}ff.prototype.clone = function(){var a=new ff();a.a = $e(this.a) || [];return a;};function gf(){this.c = this.a = this.b = null;}gf.prototype.clone = function(){var a=new gf();a.b = this.b;a.a = this.a;a.c = this.c;return a;};function hf(a,b){this.na = a;this.end = b;}hf.prototype.clone = function(){return new hf(this.na,this.end);};Oe.TAG_NAME = "MPD";Pe.TAG_NAME = "Period";Qe.TAG_NAME = "AdaptationSet";Re.TAG_NAME = "Role";Se.TAG_NAME = "ContentComponent";Te.TAG_NAME = "Representation";Ue.TAG_NAME = "ContentProtection";Ve.TAG_NAME = "cenc:pssh";We.TAG_NAME = "BaseURL";Xe.TAG_NAME = "Location";Ze.TAG_NAME = "SegmentBase";af.TAG_NAME = "RepresentationIndex";bf.TAG_NAME = "Initialization";cf.TAG_NAME = "SegmentList";df.TAG_NAME = "SegmentURL";ef.TAG_NAME = "SegmentTemplate";ff.TAG_NAME = "SegmentTimeline";gf.TAG_NAME = "S";Oe.prototype.parse = function(a,b){this.url = a.s;this.id = S(b,"id",T);this.type = S(b,"type",T) || "static";this.c = S(b,"mediaPresentationDuration",jf);this.h = S(b,"minBufferTime",jf,this.h);this.g = S(b,"minimumUpdatePeriod",jf,this.g);this.b = S(b,"availabilityStartTime",kf,this.b);this.f = S(b,"timeShiftBufferDepth",jf,this.f);this.i = S(b,"suggestedPresentationDelay",jf,this.i);var c=a.s,d=U(this,b,We);this.s = lf(c,d);if(d = V(this,b,Xe))this.j = mf(c,d.url);this.a = U(this,b,Pe);};Pe.prototype.parse = function(a,b){this.id = S(b,"id",T);this.start = S(b,"start",jf);this.a = S(b,"duration",jf);var c=U(this,b,We);this.s = lf(a.s,c);this.c = V(this,b,Ze);this.f = V(this,b,cf);this.g = V(this,b,ef);this.b = U(this,b,Qe);nf(this);};function nf(a){for(var b=[],c=0;c < a.b.length;++c) {var d=a.b[c];null != d.group && (b[d.group] = !0);}for(c = 0;c < a.b.length;++c) if((d = a.b[c],null == d.group)){for(var e=1;1 == b[e];) ++e;b[e] = !0;d.group = e;}}Qe.prototype.parse = function(a,b){var c=V(this,b,Se) || {},d=V(this,b,Re);this.id = S(b,"id",T);this.group = S(b,"group",W);this.lang = S(b,"lang",T,c.lang);this.contentType = S(b,"contentType",T,c.contentType);this.width = S(b,"width",X);this.height = S(b,"height",X);this.b = S(b,"mimeType",T);this.i = S(b,"codecs",T);this.c = d && "main" == d.value;this.lang && (this.lang = Sa(this.lang));c = U(this,b,We);this.s = lf(a.s,c);this.j = U(this,b,Ue);!this.contentType && this.b && (this.contentType = this.b.split("/")[0]);this.f = a.c?of(this,b,a.c):V(this,b,Ze);this.g = a.f?of(this,b,a.f):V(this,b,cf);this.h = a.g?of(this,b,a.g):V(this,b,ef);this.a = U(this,b,Te);!this.b && this.a.length && (this.b = this.a[0].f,!this.contentType && this.b && (this.contentType = this.b.split("/")[0]));};Re.prototype.parse = function(a,b){this.value = S(b,"value",T);};Se.prototype.parse = function(a,b){this.id = S(b,"id",T);this.lang = S(b,"lang",T);this.contentType = S(b,"contentType",T);this.lang && (this.lang = Sa(this.lang));};Te.prototype.parse = function(a,b){this.id = S(b,"id",T);this.bandwidth = S(b,"bandwidth",X);this.width = S(b,"width",X,a.width);this.height = S(b,"height",X,a.height);this.f = S(b,"mimeType",T,a.b);this.h = S(b,"codecs",T,a.i);this.lang = a.lang;var c=U(this,b,We);this.s = lf(a.s,c);this.c = U(this,b,Ue);this.g = a.f?of(this,b,a.f):V(this,b,Ze);this.b = a.g?of(this,b,a.g):V(this,b,cf);this.a = a.h?of(this,b,a.h):V(this,b,ef);0 == this.c.length && (this.c = a.j);};Ue.prototype.parse = function(a,b){this.b = b;this.schemeIdUri = S(b,"schemeIdUri",T);this.value = S(b,"value",T);var c=S(b,"cenc:default_KID",T);c && (this.a = c.replace(/[-]/g,""));this.pssh = V(this,b,Ve);this.children = Array.prototype.slice.call(b.childNodes);};Ve.prototype.parse = function(a,b){var c=pf(b);if(c){this.psshBox = sa(c);try{this.parsedPssh = new Rb(this.psshBox);}catch(d) {if(!(d instanceof RangeError))throw d;}}};We.prototype.parse = function(a,b){this.url = pf(b);};Xe.prototype.parse = function(a,b){this.url = pf(b);};Ze.prototype.parse = function(a,b){this.s = a.s || this.s;this.g = S(b,"timescale",X,this.g);this.f = S(b,"presentationTimeOffset",W,this.f);this.a = S(b,"indexRange",qf,this.a);this.b = V(this,b,af) || this.b;this.c = V(this,b,bf) || this.c;};af.prototype.parse = function(a,b){var c=S(b,"sourceURL",T);this.url = mf(a.s,c);this.a = S(b,"range",qf,R(a.a));};bf.prototype.parse = function(a,b){var c=S(b,"sourceURL",T);this.url = mf(a.s,c);this.a = S(b,"range",qf);};cf.prototype.parse = function(a,b){this.s = a.s || this.s;this.f = S(b,"timescale",X,this.f);this.g = S(b,"presentationTimeOffset",W,this.g);this.b = S(b,"duration",X,this.b);this.i = S(b,"startNumber",W,this.i);this.h = V(this,b,bf) || this.h;var c=U(this,b,df);this.a = c && 0 < c.length?c:this.a;this.c = V(this,b,ff) || this.c;};df.prototype.parse = function(a,b){var c=S(b,"media",T);this.b = mf(a.s,c);this.a = S(b,"mediaRange",qf);};ef.prototype.parse = function(a,b){this.b = S(b,"timescale",X,this.b);this.i = S(b,"presentationTimeOffset",W,this.i);this.a = S(b,"duration",X,this.a);this.j = S(b,"startNumber",W,this.j);this.h = S(b,"media",T,this.h);this.f = S(b,"index",T,this.f);this.g = S(b,"initialization",T,this.g);this.c = V(this,b,ff) || this.c;};ff.prototype.parse = function(a,b){this.a = U(this,b,gf);};gf.prototype.parse = function(a,b){this.b = S(b,"t",W);this.a = S(b,"d",W);this.c = S(b,"r",rf);};function lf(a,b){if(!b || 0 === b.length)return a;for(var c=[],d=0;d < b.length;d++) {var e=b[d].url;null == a || 0 === a.length?c.push(new J(e)):(e = mf(a.slice(0,1),e),c.push(e[0]));}return c;}function mf(a,b){if(!b)return a;var c=new J(b);return a?a.map(function(a){return a.resolve(c);}):[c];}function of(a,b,c){var d=R(c);(b = sf(b,c.constructor.TAG_NAME)) && d.parse(a,b);return d;}function V(a,b,c){var d=null;if(b = sf(b,c.TAG_NAME))d = new c(),d.parse(a,b);return d;}function sf(a,b){for(var c=null,d=0;d < a.childNodes.length;d++) if(a.childNodes[d].tagName == b){if(c)return null;c = a.childNodes[d];}return c;}function U(a,b,c){for(var d=[],e=0;e < b.childNodes.length;e++) if(b.childNodes[e].tagName == c.TAG_NAME){var f=new c();f.parse.call(f,a,b.childNodes[e]);d.push(f);}return d;}function pf(a){a = a.firstChild;return a.nodeType != Node.TEXT_NODE?null:a.nodeValue;}function $e(a){return a?a.map(function(a){return a.clone();}):null;}function R(a){return a?a.clone():null;}function S(a,b,c,d){a = c(a.getAttribute(b));return null != a?a:void 0 !== d?d:null;}function kf(a){if(!a)return null;a = Date.parse(a);return isNaN(a)?null:Math.floor(a / 1E3);}function jf(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a = 0;var c=W(b[1]);c && (a += 31536E3 * c);(c = W(b[2])) && (a += 2592E3 * c);(c = W(b[3])) && (a += 86400 * c);(c = W(b[4])) && (a += 3600 * c);(c = W(b[5])) && (a += 60 * c);b = window.parseFloat(b[6]);(b = isNaN(b)?null:b) && (a += b);return a;}function qf(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a = W(b[1]);if(null == a)return null;b = W(b[2]);return null == b?null:new hf(a,b);}function rf(a){a = window.parseInt(a,10);return isNaN(a)?null:a;}function X(a){a = window.parseInt(a,10);return 0 < a?a:null;}function W(a){a = window.parseInt(a,10);return 0 <= a?a:null;}function T(a){return a;};function tf(a,b,c,d){for(var e=b.a,f=[],g=0;g < d;++g) {var h=g + c,k=(h - 1) * e.a,m=k / e.b,k=(k + e.a) / e.b,h=Ne(a,b,h - 1 + e.j,(h - 1) * e.a);if(!h)return null;f.push(new Rc(m,k,h));}return f;}function Ne(a,b,c,d){if(!b.a)return null;var e=b.a.h;if(!e)return b.s?new G(a,b.s,0,null):null;c = uf(e,b.id,c,b.bandwidth,d);if(!c)return null;b = Oc(b.s,c);return new G(a,b,0,null);}function uf(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a = a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$" == a)return "$";var d=f[b];if(null == d)return a;"RepresentationID" == b && c && (c = void 0);a = d.toString();c = window.parseInt(c,10) || 1;c = Math.max(0,c - a.length);return Array(c + 1).join("0") + a;});try{return new J(a);}catch(g) {if(g instanceof URIError)return null;throw g;}}function Me(a,b,c){var d=0;b *= c;a = a.a;c = [];for(var e=0;e < a.length && a[e].a;++e) {var f=a[e].b,f=null != f?f:d,g=a[e].c || 0;0 > g && (g = a[e].a,g = e + 1 === a.length?Math.ceil((a[0].b + b - f) / g) - 1:Math.ceil((a[e + 1].b - f) / g) - 1);0 < c.length && f != d && (c[c.length - 1].end = f);for(var h=0;h <= g;++h) d = f + a[e].a,c.push({start:f,end:d}),f = d;}return c;};function vf(a,b){this.a = new pb();this.a.f = "text";this.a.a = 3;this.a.c = 1E3 * (null != b?b:0);this.a.g = !0;this.b = a;}function wf(a){var b=a.b;return qb(b,a.a).then(function(a){var d;d = b.c;d = (a = new DOMParser().parseFromString(a,"text/xml"))?V({s:d},a,Oe):null;if(d)return Promise.resolve(d);d = Error("MPD parse failure.");d.type = "dash";return Promise.reject(d);});};function xf(a,b,c,d,e){this.c = a;this.b = b;this.g = c;this.a = null;this.h = d;this.f = e;}xf.prototype.destroy = function(){this.f = this.g = this.b = this.c = null;this.a && (this.a.destroy(),this.a = null);};xf.prototype.create = function(){if(this.a)return Promise.resolve(this.a);var a=this.g.b,b=[];a.c && (b = Me(a.c,a.f || 1,this.b.a || 0));var c=0;a.b && a.i?c = a.b * a.i:0 < b.length && (c = b[0].start - (a.g || 0));var d=a.a.length;0 < b.length && b.length != a.a.length && (d = Math.min(b.length,a.a.length));for(var e=[],f=0;f < d;++f) {var g=a.a[f],h=c / a.f,k=null,m=null;a.b?(k = c + a.b,m = k / a.f):0 < b.length?(k = b[f].end - (a.g || 0),m = k / a.f):(m = h + this.b.a,k = m * a.f);var c=k,k=0,p=null;g.a && (k = g.a.na,p = g.a.end);e.push(new Rc(h,m,new G(this.f,g.b,k,p)));}"dynamic" == this.c.type?this.a = new Q(e,this.c,this.b,this.h):this.a = new K(e);return Promise.resolve(this.a);};function yf(a,b,c,d,e){var f=1,g=0,h;if(a.b > d)h = null;else {var k=a.i || 0,m=a.f || 0;h = c.a;h = h.a / h.b;var p=d - (a.b + b.start);0 > p?h = null:(m = p - 2 * h - m,0 > m && (m = 0),m = Math.ceil(m / h) * h,p -= h,0 > p?h = null:(k = Math.floor(p / h) * h - k,0 > k && (k = 0),k = Math.floor(k / h) * h,h = {Na:m / h + 1,current:(k >= m?k:m) / h + 1}));}h && (f = h.Na,g = h.current - h.Na + 1);f = tf(e,c,f,g);if(null == f)throw (a = Error("Failed to generate SegmentReferences."),a.type = "stream",a);Q.call(this,f,a,b,d);this.l = c;this.i = this.b = 0 < this.length()?a.b + b.start + M(this).a:null;this.h = h?h.current + 1:null;this.w = e;}q(yf,Q);yf.prototype.destroy = function(){this.w = this.l = null;Q.prototype.destroy.call(this);};yf.prototype.ia = function(a){var b=Ga() / 1E3;zf(this,b);Ie(this,b);return K.prototype.ia.call(this,a);};yf.prototype.Ca = function(a){if(null != this.b || !(a instanceof yf) || null == a.b)return !1;this.b = a.b;this.i = a.i;this.h = a.h;Wc(this,a);zf(this,Ga() / 1E3);He(this);return !0;};yf.prototype.ha = function(a){a = Q.prototype.ha.call(this,a);null != this.b && (this.b += a,this.i += a);return a;};yf.prototype.Ba = function(){var a=Ga() / 1E3;zf(this,a);return Je(this,a);};function zf(a,b){if(null != a.b && null != a.i && null != a.h){var c=a.l.a,c=c.a / c.b,d=Math.floor((a.i + (b - a.v) - a.b) / c);if(0 != d){var e=tf(a.w,a.l,a.h,d);Array.prototype.push.apply(a.u,Tc(e,a.g));a.b += d * c;a.h += d;}}};function Af(a,b,c,d,e){this.f = a;this.b = b;this.c = c;this.h = d;this.a = null;this.g = e;}Af.prototype.destroy = function(){this.g = this.c = this.b = this.f = null;this.a && (this.a.destroy(),this.a = null);};Af.prototype.create = function(){if(this.a)return Promise.resolve(this.a);if("dynamic" == this.f.type)try{this.a = new yf(this.f,this.b,this.c,this.h,this.g);}catch(a) {return Promise.reject(a);}else {var b;b = this.c.a;if(b = tf(this.g,this.c,1,Math.ceil(this.b.a / (b.a / b.b)))){if(0 < b.length){var c=b[b.length - 1];b[b.length - 1] = Sc(c,c.b,this.b.a);}b = new K(b);}else b = null;this.a = b;if(!this.a)return b = Error("Failed to generate SegmentReferences"),b.type = "stream",Promise.reject(b);}return Promise.resolve(this.a);};function Bf(a){this.a = a;}function Cf(a,b,c){for(var d=Ga() / 1E3,e=0;e < b.a.length;++e) for(var f=b.a[e],g=0;g < f.b.length;++g) {var h=f.b[g];if("text" != h.contentType)for(var k=0;k < h.a.length;++k) {var m=h.a[k],p=0,p=p + (m.g?1:0),p=p + (m.b?1:0),p=p + (m.a?1:0);0 == p?(h.a.splice(k,1),--k):1 != p && (m.g?(m.b = null,m.a = null):m.b && (m.a = null));}}Df(b);for(e = 0;e < b.a.length;++e) for(f = b.a[e],g = 0;g < f.b.length;++g) {k = h = f.b[g];m = null;for(p = 0;p < k.a.length;++p) {var t=k.a[p].f || "";m?t != m && (k.a.splice(p,1),--p):m = t;}0 == h.a.length && (f.b.splice(g,1),--g);}"dynamic" == b.type && null == b.b && (b.b = d);e = new gd();"dynamic" == b.type && (e.b = !0,e.f = b.g,e.g = new G(c,b.j || b.url));e.c = b.h || 5;for(f = 0;f < b.a.length;++f) {g = b.a[f];if(null == g.start)break;g = Ef(a,b,g,d,c);e.a.push(g);}return e;}function Df(a){if(a.a.length){null == a.a[0].start && (a.a[0].start = 0);var b=function b(a){return 0 == a || !!a;};"dynamic" == a.type && (a.c = null);b(a.c) && 1 == a.a.length && !b(a.a[0].a) && (a.a[0].a = a.c);for(var c=0,d=!0,e=0;e < a.a.length;++e) {var f=a.a[e - 1],g=a.a[e],h=a.a[e + 1] || {start:a.c};!b(g.start) && f && b(f.start) && b(f.a) && (g.start = f.start + f.a);!b(g.a) && b(h.start) && (g.a = h.start - g.start);null != g.start && null != g.a?c += g.a:d = !1;}b(a.c) || (e = a.a[a.a.length - 1],d?a.c = c:b(e.start) && b(e.a)?a.c = e.start + e.a:"dynamic" != a.type && (a.c = c));}}function Ef(a,b,c,d,e){var f=new fd();f.id = c.id;f.start = c.start;f.b = c.a;var g=new A();c.b.forEach(function(a){g.push(a.contentType || "",a);});for(var h=Ea(g),k=0;k < h.length;++k) {var m=new A();g.get(h[k]).forEach(function(a){m.push(a.group,a);});for(var p=Ea(m),t=0;t < p.length;++t) {var y=new A();m.get(p[t]).forEach(function(a){y.push(a.lang,a);});for(var u=Ea(y),v=0;v < u.length;++v) {var ma=y.get(u[v]),ma=Ff(a,b,c,ma,d,e);f.a.push(ma);}}}return f;}function Ff(a,b,c,d,e,f){Ia(d.every(function(a){return a.group == d[0].group && (a.lang || "") == (d[0].lang || "") && (a.contentType || "") == (d[0].contentType || "");}));var g=new bd(),h=d.filter(function(a){return null != a.id;});h.length == d.length && (g.id = h.map(function(a){return a.id;}).sort().reduce(function(a,b){return a + "," + b;}));g.lang = d[0].lang || "";g.contentType = d[0].contentType || "";g.b = d.some(function(a){return a.c;});for(var h={},k=0;k < d.length;++k) for(var m=d[k],p=0;p < m.a.length;++p) {var t=m.a[p],y=Gf(a,t),u=g.a.slice(0);Hf(y,u);0 == u.length && 0 < g.a.length || !(t = If(b,c,t,e,f)) || (g.m.push(t),g.a = u,h[t.A] = m);}if(g.a.some(function(a){return "" == a.a;}))return g.m.forEach(function(a){a.L = !0;}),g;a = Jf(d);for(k = 0;k < g.m.length;++k) t = g.m[k],m = h[t.A],m == a && (t.L = !0);return g;}function Jf(a){for(var b=null,c=null,d=0;d < a.length;++d) for(var e=a[d],f=0;f < e.a.length;++f) {var g=e.a[f],g=(g.width || 1) * (g.height || 1) * (g.bandwidth || 1);if(null == b || g < b)b = g,c = e;}return c;}function Hf(a,b){if(0 == b.length)Array.prototype.push.apply(b,a);else for(var c=0;c < b.length;++c) {for(var d=!1,e=0;e < a.length;++e) {var f=b[c],g=a[e];if(f.a == g.a && f.j == g.j && f.l == g.l && f.h == g.h && f.i == g.i && f.g == g.g && f.o == g.o && f.f == g.f && f.v == g.v && ua(f.c,g.c)){d = !0;break;}}d || (b.splice(c,1),--c);}}function Gf(a,b){var c=[];if(0 == b.c.length)c.push(new Ja());else if(a.a)for(var d=0;d < b.c.length;++d) c.push.apply(c,Kf(a,b.c[d]));return c;}function Kf(a,b){var c=[];if(2 == a.a.length){var d=a.a(b.schemeIdUri,b.b);if(!(d && d instanceof Array))return [];for(var e=0;e < d.length;++e) {var f=Ka(d[e]);0 == f.b.length && b.pssh && b.pssh.psshBox && La(f,[{initData:b.pssh.psshBox,initDataType:"cenc"}]);c.push(f);}}else {d = a.a(b);if(!(d && d instanceof Ma))return [];e = new Ja();e.a = d.g;e.j = d.j;e.l = d.o;e.h = d.h;e.i = d.i;e.g = d.f;e.o = d.v;e.f = d.c;e.v = d.l;e.c = d.b?new Uint8Array(d.b.buffer):null;La(e,d.a);c.push(e);}return c;}function If(a,b,c,d,e){if(!c.s || 0 === c.s.length)return null;var f=null,g=1,h=0;if(c.g)f = c.f.split("/")[1],"mp4" != f && "webm" != f?f = null:(g = c.g,"webm" != f || g.c?g.a || g.b && g.b.a?(h = g.b,h || (h = new af(),h.url = c.s,h.a = g.a?g.a.clone():null),h = Lf(h,e),g = g.c?Lf(g.c,e):null,a = new Ke(a,b,f,h,g,d,e),b = new Qc(g),d = new Zc(),d.F = a,d.C = b,f = d):f = null:f = null),g = c.g.g,h = c.g.f;else if(c.b)f = c.b,!f.b && !f.c && 1 < f.a.length?f = null:f.b || b.a || f.c || 1 != f.a.length?f.c && 0 === f.c.a.length?f = null:(f = f.h?Lf(f.h,e):null,a = new xf(a,b,c,d,e),b = new Qc(f),d = new Zc(),d.F = a,d.C = b,f = d):f = null,g = c.b.f,h = c.b.g;else if(c.a){a: if((f = c.a,g = 0 + (f.f?1:0),g += f.c?1:0,g += f.a?1:0,0 == g?g = !1:(1 != g && (f.f?(f.c = null,f.a = null):f.c && (f.a = null)),g = !0),g)){g = null;if(f.g && (g = (f = c.a.g)?Mf(c,f,bf):null,!g)){f = null;break a;}f = g?Lf(g,e):null;g = c.a;g.f?(g = c.f.split("/")[1],"mp4" != g && "webm" != g?a = null:"webm" != g || f?Ne(e,c,1,0)?(h = (h = c.a.f)?Mf(c,h,af):null)?(h = Lf(h,e),a = new Ke(a,b,g,h,f,d,e)):a = null:a = null:a = null):a = g.h?g.c?new Le(a,b,c,d,e):g.a?"dynamic" != a.type && null == b.a?null:new Af(a,b,c,d,e):null:null;a?(b = new Qc(f),d = new Zc(),d.F = a,d.C = b,f = d):f = null;}else f = null;g = c.a.b;h = c.a.i;}else "text" == c.f.split("/")[0] && (f = new Zc(),f.F = new Xc(new G(e,c.s)));if(!f)return null;f.id = c.id;h && (f.c = -1 * h / g);f.bandwidth = c.bandwidth;f.width = c.width;f.height = c.height;f.a = c.f || "";f.b = c.h || "";for(a = 0;a < c.c.length;++a) b = c.c[a],b.a && f.f.push(b.a);return f;}function Mf(a,b,c){b = uf(b,a.id,null,a.bandwidth,null);if(!b)return null;c = new c();c.url = Oc(a.s,b);return c;}function Lf(a,b){var c=a.url,d=0,e=null;a.a && (d = a.a.na,e = a.a.end);return new G(b,c,d,e);};function Y(a,b,c){b || (b = new Xa());c || (c = new O());P.call(this,null,b,c);this.T = a;this.M = [];this.timeoutMs = 3E4;this.l = {};this.j = this.O = null;}q(Y,P);n("shaka.player.OfflineVideoSource",Y);Y.prototype.I = function(a){null != a.licenseRequestTimeout && (this.l.licenseRequestTimeout = a.licenseRequestTimeout);null != a.segmentRequestTimeout && (this.l.segmentRequestTimeout = a.segmentRequestTimeout);P.prototype.I.call(this,a);};n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Fb(),b=xb(a).then(function(){return Gb(a);});b.then(function(){H(a);})["catch"](function(){H(a);});return b;});Y.prototype.ya = function(a,b,c,d){var e,f=null,g={},h=[];a = new G(this.O,[new J(a)]);return wf(new vf(a,this.ba)).then(w(this,function(a){this.a = Cf(new Bf(c),a,this.O);if(this.a.b)return a = Error("Unable to store live streams offline."),a.type = "app",Promise.reject(a);this.I({preferredLanguage:b});return P.prototype.U.call(this);})).then(w(this,function(){var a=document.createElement("video");a.src = window.URL.createObjectURL(this.g);e = new wd(null,a,this);null != this.l.licenseRequestTimeout && (e.w = Number(this.l.licenseRequestTimeout));F(this.i,e,"sessionReady",this.ka.bind(this));F(this.i,e,"error",function(a){f = a;});return e.initialize();})).then(w(this,function(){for(var a=Ca(this.b),b=0;b < a.length;++b) for(var c=a[b],e=0;e < c.m.length;++e) {var f=c.m[e];g[f.A] = f;}return d();})).then(w(this,function(a){for(var b=0;b < a.length;++b) {var c=a[b],d=g[c];if(d)h.push(d);else return Promise.reject(Error("Invalid stream ID chosen: " + c));}var e=["audio","video"];h = h.filter(function(a){return 0 > e.indexOf(a.a.split("/")[0])?!1:!0;});a = h.map(function(a){return a.C.create();});return Promise.all(a);})).then(w(this,function(a){for(var b=h,c=[],d=0;d < b.length;++d) try{c[d] = this.g.addSourceBuffer(ad(b[d]));}catch(e) {}if(b.length != c.length)a = Error("Error initializing streams."),a.type = "storage",a = Promise.reject(a);else {for(d = 0;d < a.length;++d) (b = a[d]) && c[d].appendBuffer(b);a = Promise.resolve();}return a;})).then(w(this,function(){return zd(e,this.timeoutMs);})).then(w(this,function(){return f?Promise.reject(f):Nf(this,h,e.a,this.a.a[0].b);})).then(w(this,function(a){this.T = a;return f?(Of(this),Promise.reject(f)):Promise.resolve(a);}));};n("shaka.player.OfflineVideoSource.prototype.store",Y.prototype.ya);Y.prototype.ma = function(a){this.O = a;};Y.prototype.setNetworkCallback = Y.prototype.ma;Y.prototype.ka = function(a){this.M.push(a.detail.sessionId);};function Nf(a,b,c,d){var e=new Ae(a.X,a);null != a.l.segmentRequestTimeout && (e.b = Number(a.l.segmentRequestTimeout));return xb(e).then(w(a,function(){return Be(e,b,this.M,d,c);})).then(function(a){H(e);return Promise.resolve(a);})["catch"](function(a){H(e);return Promise.reject(a);});}Y.prototype.U = function(){var a=new Fb(),b,c;return xb(a).then(w(this,function(){return Hb(a,this.T);})).then(w(this,function(d){var e=[];this.M = d.session_ids;b = d.duration;c = {keySystem:d.key_system,distinctiveIdentifierRequired:d.distinctive_identifier,persistentStorageRequired:!0,audioRobustness:d.audio_robustness,videoRobustness:d.video_robustness,withCredentials:d.with_credentials,licenseServerUrl:d.license_server};for(var f=0;f < d.stream_ids.length;++f) e.push(Ib(a,d.stream_ids[f]));return Promise.all(e);})).then(w(this,function(a){var e=b,f=c,g=new gd();g.c = 5;for(var h=new fd(),k=0;k < a.length;++k) {var m=a[k],p=new Zc(),t=new Yc(m.references),y=new Uint8Array(m.init_segment),y=new J("data:application/octet-stream;base64," + ra(y)),y=new Qc(new G(this.O,[y],0,null));p.F = t;p.C = y;p.a = m.mime_type;p.b = m.codecs;p.L = !0;this.j && (null != this.j.licenseServerUrl && (f.licenseServerUrl = this.j.licenseServerUrl),null != this.j.withCredentials && (f.withCredentials = this.j.withCredentials),f.licensePostProcessor = this.j.licensePostProcessor,f.licensePreProcessor = this.j.licensePreProcessor,f.serverCertificate = this.j.serverCertificate);m = Ka(f);t = new bd();t.m.push(p);t.a.push(m);t.contentType = p.a.split("/")[0];h.a.push(t);h.b = e;}g.a.push(h);this.a = g;return P.prototype.U.call(this);})).then(function(){H(a);return Promise.resolve();})["catch"](function(b){H(a);return Promise.reject(b);});};Y.prototype.la = function(a,b){a && (this.j = {licenseServerUrl:a.licenseServerUrl,withCredentials:a.withCredentials,serverCertificate:a.serverCertificate,licensePreProcessor:a.licensePreProcessor,licensePostProcessor:a.licensePostProcessor});var c=null;return Pf(this)["catch"](function(a){return b?(c = a,Promise.resolve()):Promise.reject(a);}).then(w(this,function(){return Of(this);})).then(function(){return Promise.resolve(c);});};Y.prototype.deleteGroup = Y.prototype.la;Y.prototype.va = function(){return this.M;};Y.prototype.ea = function(){return !0;};function Of(a){var b=new Ae(null,null);return xb(b).then(w(a,function(){return Ee(b,this.T);})).then(function(){H(b);return Promise.resolve();})["catch"](function(a){H(b);return Promise.reject(a);});}function Pf(a){var b=document.createElement("video");b.src = window.URL.createObjectURL(a.g);var c=new wd(null,b,a);null != a.l.licenseRequestTimeout && (c.w = Number(a.l.licenseRequestTimeout));return a.U().then(function(){return c.initialize();}).then(w(a,function(){return zd(c,this.timeoutMs);})).then(function(){return Ad(c);}).then(w(a,function(){c.destroy();this.destroy();return Promise.resolve();}))["catch"](w(a,function(a){c.destroy();this.destroy();return Promise.reject(a);}));};function Z(a,b,c,d){c || (c = new Xa());d || (d = new O());P.call(this,null,c,d);this.ka = a;this.M = b;this.l = [];this.O = [];this.T = [];this.j = null;}q(Z,P);n("shaka.player.DashVideoSource",Z);Z.prototype.la = function(a,b,c){this.l.push(a);this.O.push(b || "");this.T.push(c || "");};Z.prototype.addExternalCaptions = Z.prototype.la;Z.prototype.ma = function(a){this.j = a;};Z.prototype.setNetworkCallback = Z.prototype.ma;Z.prototype.destroy = function(){this.j = this.M = null;P.prototype.destroy.call(this);};Z.prototype.U = function(){var a=new G(this.j,[new J(this.ka)]);return wf(new vf(a,this.ba)).then(w(this,function(a){for(var c=0;c < this.l.length;c++) {var d=a,e=this.l[c],f=this.O[c],g=this.T[c];if(0 !== d.a.length){var h=new Qe();h.contentType = "text";h.lang = f || "en";h.c = !0;f = new Te();f.bandwidth = 0;f.f = g || "text/vtt";f.s = [new J(e)];h.a.push(f);d.a[0].b.push(h);nf(d.a[0]);}}this.a = Cf(new Bf(this.M),a,this.j);return P.prototype.U.call(this);}));};Z.prototype.Ta = function(a){return wf(new vf(a,this.ba)).then(w(this,function(a){a = Cf(new Bf(this.M),a,this.j);return Promise.resolve(a);}));};}).bind(g,this)();if(typeof module != "undefined" && module.exports)module.exports = g.shaka;else if(true)!(__WEBPACK_AMD_DEFINE_RESULT__ = function(){return g.shaka;}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));else this.shaka = g.shaka;})();

/***/ }
/******/ ])
});
;