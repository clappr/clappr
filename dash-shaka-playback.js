(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("Clappr"));
	else if(typeof define === 'function' && define.amd)
		define(["Clappr"], factory);
	else if(typeof exports === 'object')
		exports["DashShakaPlayback"] = factory(require("Clappr"));
	else
		root["DashShakaPlayback"] = factory(root["Clappr"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};

/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {

/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;

/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};

/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);

/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;

/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}


/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;

/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;

/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";

/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	'use strict';Object.defineProperty(exports,'__esModule',{value:true});var _createClass=(function(){function defineProperties(target,props){for(var i=0;i < props.length;i++) {var descriptor=props[i];descriptor.enumerable = descriptor.enumerable || false;descriptor.configurable = true;if('value' in descriptor)descriptor.writable = true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};})();var _get=function get(_x2,_x3,_x4){var _again=true;_function: while(_again) {var object=_x2,property=_x3,receiver=_x4;_again = false;if(object === null)object = Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc === undefined){var parent=Object.getPrototypeOf(object);if(parent === null){return undefined;}else {_x2 = parent;_x3 = property;_x4 = receiver;_again = true;desc = parent = undefined;continue _function;}}else if('value' in desc){return desc.value;}else {var getter=desc.get;if(getter === undefined){return undefined;}return getter.call(receiver);}}};function _interopRequireDefault(obj){return obj && obj.__esModule?obj:{'default':obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function');}}function _inherits(subClass,superClass){if(typeof superClass !== 'function' && superClass !== null){throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass);}subClass.prototype = Object.create(superClass && superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__ = superClass;}var _clappr=__webpack_require__(1);var _shakaPlayer=__webpack_require__(2);var _shakaPlayer2=_interopRequireDefault(_shakaPlayer);var SEND_STATS_AT=30 * 1000;var AUTO=-1;var DashShakaPlayback=(function(_HTML5Video){_inherits(DashShakaPlayback,_HTML5Video);_createClass(DashShakaPlayback,[{key:'name',get:function get(){return 'dash_shaka_playback';}},{key:'shakaVersion',get:function get(){return _shakaPlayer2['default'].player.Player.version;}},{key:'levels',get:function get(){return this._levels;}},{key:'currentLevel',set:function set(id){var _this=this;this._currentLevelId = id;var isAuto=this._currentLevelId === AUTO;this._player.configure({abr:{enable:!isAuto}});this.trigger(_clappr.Events.PLAYBACK_LEVEL_SWITCH_START);if(!isAuto){this.selectTrack(this.videoTracks.filter(function(t){return t.id === _this._currentLevelId;})[0]);}this.trigger(_clappr.Events.PLAYBACK_LEVEL_SWITCH_END);},get:function get(){return this._currentLevelId || AUTO;}}]);function DashShakaPlayback(options){_classCallCheck(this,DashShakaPlayback);_get(Object.getPrototypeOf(DashShakaPlayback.prototype),'constructor',this).call(this,options);this._levels = [];options.autoPlay && this.play();}_createClass(DashShakaPlayback,[{key:'play',value:function play(){!this._player && this._setup();if(!this.isReady){this.once(_clappr.Events.PLAYBACK_READY,this.play);return;}_get(Object.getPrototypeOf(DashShakaPlayback.prototype),'play',this).call(this);} // skipping setup `setupSrc` on tag video
	},{key:'setupSrc',value:function setupSrc(){} // skipping ready event on video tag in favor of ready on shaka
	},{key:'ready',value:function ready(){}},{key:'error', // skipping error handling on video tag in favor of error on shaka
	value:function error(event){_clappr.Log.error('an error was raised support=',DashShakaPlayback.support);_clappr.Log.error('an error was raised by the video tag',event,this.el.error);}},{key:'isHighDefinitionInUse',value:function isHighDefinitionInUse(){return !!this.highDefinition;}},{key:'stop',value:function stop(){var _this2=this;clearInterval(this.sendStatsId);this.trigger(_clappr.Events.PLAYBACK_STOP,this.name);this._sendStats();this._player.unload().then(function(){_this2._player = null;_this2._isShakaReadyState = false;})['catch'](function(){_clappr.Log.error('shaka could not be unloaded');});}},{key:'getPlaybackType',value:function getPlaybackType(){return (this._player && this._player.isLive()?'live':'vod') || '';}},{key:'selectTrack',value:function selectTrack(track){this._player.selectTrack(track);this._onAdaptation();}},{key:'destroy',value:function destroy(){var _this3=this;clearInterval(this.sendStatsId);this._player.destroy().then(function(){return _this3._destroy();})['catch'](function(){_this3._destroy();_clappr.Log.error('shaka could not be destroyed');});}},{key:'_setup',value:function _setup(){var _this4=this;this._isShakaReadyState = false;this._player = this._createPlayer();this._options.shakaConfiguration && this._player.configure(this._options.shakaConfiguration);var playerLoaded=this._player.load(this._options.src);playerLoaded.then(function(){return _this4._loaded();})['catch'](function(e){return _this4._setupError(e);});}},{key:'_createPlayer',value:function _createPlayer(){var _this5=this;var player=new _shakaPlayer2['default'].Player(this.el);player.addEventListener('error',function(type,shakaError){return _this5._error(type,shakaError);});player.addEventListener('adaptation',function(){return _this5._onAdaptation();});player.addEventListener('buffering',function(e){return _this5._onBuffering(e);});return player;}},{key:'_onBuffering',value:function _onBuffering(e){var event=e.buffering?_clappr.Events.PLAYBACK_BUFFERING:_clappr.Events.PLAYBACK_BUFFERFULL;this.trigger(event);}},{key:'_loaded',value:function _loaded(){this._isShakaReadyState = true;this._ready();this._startToSendStats();this._fillLevels();}},{key:'_fillLevels',value:function _fillLevels(){if(this._levels.length === 0){this._levels = this.videoTracks.map(function(videoTrack){return {id:videoTrack.id,label:videoTrack.height + 'p'};}).reverse();this.trigger(_clappr.Events.PLAYBACK_LEVELS_AVAILABLE,this.levels);}}},{key:'_startToSendStats',value:function _startToSendStats(){var _this6=this;this.sendStatsId = setInterval(function(){return _this6._sendStats();},SEND_STATS_AT);}},{key:'_sendStats',value:function _sendStats(){this.trigger(_clappr.Events.PLAYBACK_STATS_ADD,this._player.getStats());}},{key:'_setupError',value:function _setupError(e){this._error('error',{detail:e.detail});}},{key:'_error',value:function _error(type,shakaError){_clappr.Log.error('an error was raised support=',DashShakaPlayback.support);_clappr.Log.error('an error was raised by shaka player',shakaError.detail);this.trigger(_clappr.Events.PLAYBACK_ERROR,shakaError.detail,this.name);}},{key:'_onAdaptation',value:function _onAdaptation(){var activeVideo=this.videoTracks.filter(function(t){return t.active === true;})[0];this._fillLevels();_clappr.Log.debug('an adaptation has happened:',activeVideo);this.highDefinition = activeVideo.height >= 720;this.trigger(_clappr.Events.PLAYBACK_HIGHDEFINITIONUPDATE,this.highDefinition);this.trigger(_clappr.Events.PLAYBACK_BITRATE,{bandwidth:activeVideo.bandwidth,width:activeVideo.width,height:activeVideo.height,level:activeVideo.id});}},{key:'_destroy',value:function _destroy(){_get(Object.getPrototypeOf(DashShakaPlayback.prototype),'destroy',this).call(this);this._isShakaReadyState = false;_clappr.Log.debug('shaka was destroyed');}},{key:'_ready',value:function _ready(){_get(Object.getPrototypeOf(DashShakaPlayback.prototype),'_ready',this).call(this);}},{key:'isReady',get:function get(){return this._isShakaReadyState;}},{key:'textTracks',get:function get(){return this._player && this._player.getTracks().filter(function(t){return t.type === 'text';});}},{key:'audioTracks',get:function get(){return this._player && this._player.getTracks().filter(function(t){return t.type === 'audio';});}},{key:'videoTracks',get:function get(){return this._player && this._player.getTracks().filter(function(t){return t.type === 'video';});}}]);return DashShakaPlayback;})(_clappr.HTML5Video);exports['default'] = DashShakaPlayback;DashShakaPlayback.canPlay = function(resource){var mimeType=arguments.length <= 1 || arguments[1] === undefined?'':arguments[1];_shakaPlayer2['default'].polyfill.installAll();_shakaPlayer2['default'].Player.support().then(function(support){DashShakaPlayback.support = support;});var basic=!!window.Promise && !!window.Uint8Array && !!Array.prototype.forEach;var mediaSource=window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"');var basicAndMediaSource=basic && mediaSource;var resourceParts=resource.split('?')[0].match(/.*\.(.*)$/) || [];return basicAndMediaSource && ('mpd' === resourceParts[1] || mimeType.indexOf('application/dash+xml') > -1);};module.exports = exports['default'];

/***/ },
/* 1 */
/***/ function(module, exports) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	var __WEBPACK_AMD_DEFINE_RESULT__;"use strict";(function(){var g={};(function(window){var k,aa=this;aa.Lb = !0;function m(a,b){var c=a.split("."),d=aa;c[0] in d || !d.execScript || d.execScript("var " + c[0]);for(var e;c.length && (e = c.shift());) c.length || void 0 === b?d[e]?d = d[e]:d = d[e] = {}:d[e] = b;}function ba(a){var b=ca;function c(){}c.prototype = b.prototype;a.Ob = b.prototype;a.prototype = new c();a.prototype.constructor = a;a.Mb = function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2));};}; /*

	 Copyright 2016 Google Inc.

	 Licensed under the Apache License, Version 2.0 (the "License");
	 you may not use this file except in compliance with the License.
	 You may obtain a copy of the License at

	     http://www.apache.org/licenses/LICENSE-2.0

	 Unless required by applicable law or agreed to in writing, software
	 distributed under the License is distributed on an "AS IS" BASIS,
	 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 See the License for the specific language governing permissions and
	 limitations under the License.
	*/function da(a){this.c = Math.exp(Math.log(.5) / a);this.a = this.b = 0;}function ea(a,b,c){var d=Math.pow(a.c,b);a.b = c * (1 - d) + d * a.b;a.a += b;}function fa(a){return a.b / (1 - Math.pow(a.c,a.a));};function ga(){this.a = new da(3);this.c = new da(10);this.b = 5E5;}function ia(a){return .5 > a.a.a?a.b:Math.min(fa(a.a),fa(a.c));};function ja(){this.h = null;this.c = !1;this.b = new ga();this.g = {};this.a = {};this.i = !1;this.f = null;}m("shaka.abr.SimpleAbrManager",ja);k = ja.prototype;k.stop = function(){this.h = null;this.c = !1;this.g = {};this.a = {};this.f = null;};k.init = function(a){this.h = a;};k.chooseStreams = function(a){this.g = a;this.a = {};return ka(this);};k.enable = function(){this.c = !0;};k.disable = function(){this.c = !1;};k.segmentDownloaded = function(a,b,c){var d=this.b;a = b - a;65536 > c || 200 > a || (a = Math.max(a,50),c = 8E3 * c / a,a /= 1E3,ea(d.a,a,c),ea(d.c,a,c));if(null != this.f && this.c)a: {d = Date.now() - this.f;if(!this.i){if(4E3 > d)break a;this.i = !0;}else if(8E3 > d)break a;d = this.a.audio;c = this.a.video;a = ka(this);a.audio == d && a.video == c || this.h(a);}};k.getBandwidthEstimate = function(){return ia(this.b);};k.setDefaultEstimate = function(a){this.b.b = a;};function ka(a){var b={},c;(c = a.g.audio)?(c = la(c),c = c[Math.floor(c.length / 2)]):c = null;c && (b.audio = c,a.a.audio = c);if(c = a.g.video){c = la(c);for(var d=a.a.audio,d=d && d.bandwidth || 0,e=ia(a.b),f=c[0],g=0;g < c.length;++g) {var l=c[g],h=g + 1 < c.length?c[g + 1]:{bandwidth:Number.POSITIVE_INFINITY};l.bandwidth && (h = (h.bandwidth + d) / .85,e >= (l.bandwidth + d) / .95 && e <= h && (f = l));}c = f;}else c = null;c && (b.video = c,a.a.video = c);a.f = Date.now();return b;}function la(a){return a.streams.slice(0).filter(function(a){return a.allowedByApplication && a.allowedByKeySystem;}).sort(function(a,c){return a.bandwidth - c.bandwidth;});};var ma={},na={};m("shaka.media.ManifestParser.registerParserByExtension",function(a,b){na[a] = b;});m("shaka.media.ManifestParser.registerParserByMime",function(a,b){ma[a] = b;});function oa(){var a={basic:!0},b;for(b in ma) a[b] = !0;for(b in na) a[b] = !0;["application/dash+xml","application/x-mpegurl","application/vnd.apple.mpegurl","application/vnd.ms-sstr+xml"].forEach(function(b){a[b] = !!ma[b];});["mpd","m3u8","ism"].forEach(function(b){a[b] = !!na[b];});return a;};function pa(a){this.h = a;this.c = this.a = Number.POSITIVE_INFINITY;this.b = 1;this.g = this.f = 0;}m("shaka.media.PresentationTimeline",pa);function qa(a,b,c){0 != c.length && (a.b = c.reduce(function(a,b){return Math.max(a,b.a - b.startTime);},a.b),0 == b && (a.f = Math.max(a.f,c[0].startTime)));}pa.prototype.aa = function(){return this.a == Number.POSITIVE_INFINITY || this.c < Number.POSITIVE_INFINITY;};function ra(a){return Math.max(Math.min(a.f,n(a)),sa(a));}function sa(a){return a.c == Number.POSITIVE_INFINITY?0:Math.max(0,n(a) - a.c);}function n(a){return null != a.h && a.aa()?Math.min(Math.max(0,(Date.now() + a.g) / 1E3 - a.b - a.h),a.a):a.a;};function ta(a,b,c){this.uris = a;this.c = b;this.b = c;}m("shaka.media.InitSegmentReference",ta);function w(a,b,c,d,e,f){this.position = a;this.startTime = b;this.a = c;this.uris = d;this.c = e;this.b = f;}m("shaka.media.SegmentReference",w);function ua(a,b){if(!a)return 0;for(var c=0;c < a.length;++c) if(b + 1E-4 >= a.start(c) && b < a.end(c))return a.end(c) - b;return 0;};m("shaka.polyfill.installAll",function(){for(var a=0;a < va.length;++a) va[a]();});var va=[];function wa(a){va.push(a);}m("shaka.polyfill.register",wa);function xa(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b);}wa(function(){if(window.Document){var a=Element.prototype;a.requestFullscreen = a.requestFullscreen || a.mozRequestFullScreen || a.msRequestFullscreen || a.webkitRequestFullscreen;a = Document.prototype;a.exitFullscreen = a.exitFullscreen || a.mozCancelFullScreen || a.msExitFullscreen || a.webkitExitFullscreen;"fullscreenElement" in document || Object.defineProperty(document,"fullscreenElement",{get:function get(){return document.mozFullScreenElement || document.msFullscreenElement || document.webkitFullscreenElement;}});document.addEventListener("webkitfullscreenchange",xa);document.addEventListener("webkitfullscreenerror",xa);document.addEventListener("mozfullscreenchange",xa);document.addEventListener("mozfullscreenerror",xa);document.addEventListener("MSFullscreenChange",xa);document.addEventListener("MSFullscreenError",xa);}});function ya(){return Promise.reject(Error("The key system specified is not supported."));}function za(a){return null == a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."));}function Aa(){throw new TypeError("Illegal constructor.");}Aa.prototype.createSession = function(){};Aa.prototype.setServerCertificate = function(){};function Ba(){throw new TypeError("Illegal constructor.");}Ba.prototype.getConfiguration = function(){};Ba.prototype.createMediaKeys = function(){};function x(a){this.c = [];this.b = [];this.X = Ca;if(a)try{a(this.N.bind(this),this.a.bind(this));}catch(b) {this.a(b);}}var Ca=0;function Ea(a){var b=new x();b.N(a);return b;}function Fa(a){var b=new x();b.a(a);return b;}function Ga(a){function b(a,b,c){a.X == Ca && (e[b] = c,d++,d == e.length && a.N(e));}var c=new x();if(!a.length)return c.N([]),c;for(var d=0,e=Array(a.length),f=c.a.bind(c),g=0;g < a.length;++g) a[g] && a[g].then?a[g].then(b.bind(null,c,g),f):b(c,g,a[g]);return c;}function Ha(a){for(var b=new x(),c=b.N.bind(b),d=b.a.bind(b),e=0;e < a.length;++e) a[e] && a[e].then?a[e].then(c,d):c(a[e]);return b;}x.prototype.then = function(a,b){var c=new x();switch(this.X){case 1:Ia(this,c,a);break;case 2:Ia(this,c,b);break;case Ca:this.c.push({D:c,ta:a}),this.b.push({D:c,ta:b});}return c;};x.prototype.then = x.prototype.then;x.prototype["catch"] = function(a){return this.then(void 0,a);};x.prototype["catch"] = x.prototype["catch"];x.prototype.N = function(a){if(this.X == Ca){this.ra = a;this.X = 1;for(a = 0;a < this.c.length;++a) Ia(this,this.c[a].D,this.c[a].ta);this.c = [];this.b = [];}};x.prototype.a = function(a){if(this.X == Ca){this.ra = a;this.X = 2;for(a = 0;a < this.b.length;++a) Ia(this,this.b[a].D,this.b[a].ta);this.c = [];this.b = [];}};function Ia(a,b,c){Ja.push((function(){if(c && "function" == typeof c){try{var a=c(this.ra);}catch(f) {b.a(f);return;}var e;try{e = a && a.then;}catch(f) {b.a(f);return;}a instanceof x?a == b?b.a(new TypeError("Chaining cycle detected")):a.then(b.N.bind(b),b.a.bind(b)):e?Ka(a,e,b):b.N(a);}else 1 == this.X?b.N(this.ra):b.a(this.ra);}).bind(a));null == La && (La = Ma(Na));}function Ka(a,b,c){try{var d=!1;b.call(a,function(a){if(!d){d = !0;var b;try{b = a && a.then;}catch(g) {c.a(g);return;}b?Ka(a,b,c):c.N(a);}},c.a.bind(c));}catch(e) {c.a(e);}}function Na(){for(;Ja.length;) {null != La && (Oa(La),La = null);var a=Ja;Ja = [];for(var b=0;b < a.length;++b) a[b]();}}function Ma(){return 0;}function Oa(){}var La=null,Ja=[];wa(function(){window.Promise || (window.Promise = x,window.Promise.resolve = Ea,window.Promise.reject = Fa,window.Promise.all = Ga,window.Promise.race = Ha,window.setImmediate?(Ma = function(a){return window.setImmediate(a);},Oa = function(a){return window.clearImmediate(a);}):(Ma = function(a){return window.setTimeout(a,0);},Oa = function(a){return window.clearTimeout(a);}));});function Pa(){return {droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0};}wa(function(){if(window.HTMLVideoElement){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality && "webkitDroppedFrameCount" in a && (a.getVideoPlaybackQuality = Pa);}});function Qa(a,b,c){for(var d=0;d < a.length;++d) if(c(a[d],b))return d;return -1;};function z(a,b,c){this.category = a;this.code = b;this.data = Array.prototype.slice.call(arguments,2);}m("shaka.util.Error",z);z.prototype.toString = function(){return "shaka.util.Error " + JSON.stringify(this,null,"  ");};z.Category = {NETWORK:1,TEXT:2,MEDIA:3,MANIFEST:4,STREAMING:5,DRM:6};z.Code = {UNSUPPORTED_SCHEME:1E3,BAD_HTTP_STATUS:1001,HTTP_ERROR:1002,TIMEOUT:1003,MALFORMED_DATA_URI:1004,UNKNOWN_DATA_URI_ENCODING:1005,INVALID_TEXT_HEADER:2E3,INVALID_TEXT_CUE:2001,INVALID_TEXT_SETTINGS:2002,UNABLE_TO_DETECT_ENCODING:2003,BAD_ENCODING:2004,BUFFER_READ_OUT_OF_BOUNDS:3E3,JS_INTEGER_OVERFLOW:3001,EBML_OVERFLOW:3002,EBML_BAD_FLOATING_POINT_SIZE:3003,MP4_SIDX_WRONG_BOX_TYPE:3004,MP4_SIDX_INVALID_TIMESCALE:3005,MP4_SIDX_TYPE_NOT_SUPPORTED:3006,WEBM_CUES_ELEMENT_MISSING:3007,WEBM_EBML_HEADER_ELEMENT_MISSING:3008,WEBM_SEGMENT_ELEMENT_MISSING:3009,WEBM_INFO_ELEMENT_MISSING:3010,WEBM_DURATION_ELEMENT_MISSING:3011,WEBM_CUE_TRACK_POSITIONS_ELEMENT_MISSING:3012,WEBM_CUE_TIME_ELEMENT_MISSING:3013,MEDIA_SOURCE_OPERATION_FAILED:3014,MEDIA_SOURCE_OPERATION_THREW:3015,VIDEO_ERROR:3016,UNABLE_TO_GUESS_MANIFEST_TYPE:4E3,DASH_INVALID_XML:4001,DASH_NO_SEGMENT_INFO:4002,DASH_EMPTY_ADAPTATION_SET:4003,DASH_EMPTY_PERIOD:4004,DASH_WEBM_MISSING_INIT:4005,DASH_UNSUPPORTED_CONTAINER:4006,DASH_PSSH_BAD_ENCODING:4007,DASH_NO_COMMON_KEY_SYSTEM:4008,DASH_MULTIPLE_KEY_IDS_NOT_SUPPORTED:4009,DASH_CONFLICTING_KEY_IDS:4010,UNPLAYABLE_PERIOD:4011,ALL_STREAMS_RESTRICTED:4012,INCONSISTENT_BUFFER_STATE:5E3,INVALID_STREAMS_CHOSEN:5005,NO_RECOGNIZED_KEY_SYSTEMS:6E3,REQUESTED_KEY_SYSTEMS_UNAVAILABLE:6001,FAILED_TO_CREATE_CDM:6002,FAILED_TO_ATTACH_TO_VIDEO:6003,INVALID_SERVER_CERTIFICATE:6004,FAILED_TO_CREATE_SESSION:6005,FAILED_TO_GENERATE_LICENSE_REQUEST:6006,LICENSE_REQUEST_FAILED:6007,LICENSE_RESPONSE_REJECTED:6008,ENCRYPTED_CONTENT_WITHOUT_DRM_INFO:6010,WRONG_KEYS:6011};function Ra(a){this.b = a;this.c = 0 == Sa;this.a = 0;}var Sa=1;function Ta(a){return a.a < a.b.byteLength;}function Ua(a){try{var b=a.b.getUint8(a.a);}catch(c) {Va();}a.a += 1;return b;}function A(a){try{var b=a.b.getUint32(a.a,a.c);}catch(c) {Va();}a.a += 4;return b;}function Wa(a){var b,c;try{a.c?(b = a.b.getUint32(a.a,!0),c = a.b.getUint32(a.a + 4,!0)):(c = a.b.getUint32(a.a,!1),b = a.b.getUint32(a.a + 4,!1));}catch(d) {Va();}if(2097151 < c)throw new z(3,3001);a.a += 8;return c * Math.pow(2,32) + b;}function Xa(a){a.a + 16 > a.b.byteLength && Va();var b=new Uint8Array(a.b.buffer,a.a,16);a.a += 16;return b;}function B(a,b){a.a + b > a.b.byteLength && Va();a.a += b;}function Va(){throw new z(3,3E3);};function C(a){this.b = a;this.a = new Ra(a);Ya || (Ya = [new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])]);}var Ya;function D(a){var b;b = Za(a);if(7 < b.length)throw new z(3,3002);for(var c=0,d=0;d < b.length;d++) c = 256 * c + b[d];b = c;c = Za(a);a: {for(d = 0;d < Ya.length;d++) if(E(c,Ya[d])){d = !0;break a;}d = !1;}if(d)c = a.b.byteLength - a.a.a;else {if(8 == c.length && c[1] & 224)throw new z(3,3001);for(var d=c[0] & (1 << 8 - c.length) - 1,e=1;e < c.length;e++) d = 256 * d + c[e];c = d;}c = a.a.a + c <= a.b.byteLength?c:a.b.byteLength - a.a.a;d = new DataView(a.b.buffer,a.b.byteOffset + a.a.a,c);B(a.a,c);return new $a(b,d);}function Za(a){var b=Ua(a.a),c;for(c = 1;8 >= c && !(b & 1 << 8 - c);c++);if(8 < c)throw new z(3,3002);var d=new Uint8Array(c);d[0] = b;for(b = 1;b < c;b++) d[b] = Ua(a.a);return d;}function $a(a,b){this.id = a;this.a = b;}function ab(a){if(8 < a.a.byteLength)throw new z(3,3002);if(8 == a.a.byteLength && a.a.getUint8(0) & 224)throw new z(3,3001);for(var b=0,c=0;c < a.a.byteLength;c++) var d=a.a.getUint8(c),b=256 * b + d;return b;};function F(a,b){var c=b || {},d;for(d in c) this[d] = c[d];this.defaultPrevented = this.cancelable = this.bubbles = !1;this.timeStamp = window.performance?window.performance.now():Date.now();this.type = a;this.isTrusted = !1;this.target = this.currentTarget = null;this.a = !1;}F.prototype.preventDefault = function(){};F.prototype.stopImmediatePropagation = function(){this.a = !0;};F.prototype.stopPropagation = function(){};function bb(a,b){return a.reduce((function(a,b,e){return b["catch"](a.bind(null,e));}).bind(null,b),Promise.reject());}function cb(a,b){return a.concat(b);}function G(){}function db(a){return null != a;}function eb(a){return function(b){return b != a;};};function H(a){this.a = a;}m("shaka.media.SegmentIndex",H);H.prototype.s = function(){this.a = null;return Promise.resolve();};H.prototype.b = function(a){for(var b=this.a.length - 1;0 <= b;--b) {var c=this.a[b];if(a >= c.startTime && a < c.a)return c.position;}return null;};H.prototype.get = function(a){if(0 == this.a.length)return null;a -= this.a[0].position;return 0 > a || a >= this.a.length?null:this.a[a];};function fb(a,b){for(var c=[],d=0,e=0;d < a.a.length && e < b.length;) {var f=a.a[d],g=b[e];f.startTime < g.startTime?(c.push(f),d++):(f.startTime > g.startTime || (.1 < Math.abs(f.a - g.a)?c.push(g):c.push(f),d++),e++);}for(;d < a.a.length;) c.push(a.a[d++]);if(c.length)for(d = c[c.length - 1].position + 1;e < b.length;) g = b[e++],g = new w(d++,g.startTime,g.a,g.uris,g.c,g.b),c.push(g);else c = b;a.a = c;}function gb(a,b){for(var c=0;c < a.a.length && !(a.a[c].a > b);++c);a.a.splice(0,c);};function hb(a,b){this.g = ib[b];this.c = a;this.h = 0;this.f = Number.POSITIVE_INFINITY;this.a = this.b = null;}var ib={};m("shaka.media.TextEngine.registerParser",function(a,b){ib[a] = b;});m("shaka.media.TextEngine.unregisterParser",function(a){delete ib[a];});hb.prototype.s = function(){this.c && jb(this,function(){return !0;});this.c = this.g = null;return Promise.resolve();};function kb(a,b,c,d){var e=a.h;c += e;d += e;return Promise.resolve().then((function(){for(var a=this.g(b),g=0;g < a.length;++g) {a[g].startTime += e;a[g].endTime += e;if(a[g].startTime >= this.f)break;this.c.addCue(a[g]);}null == this.b && (this.b = c);this.a = Math.min(d,this.f);}).bind(a));}function lb(a,b,c){return Promise.resolve().then((function(){jb(this,function(a){return a.startTime >= c || a.endTime <= b?!1:!0;});null == this.b || c <= this.b || b >= this.a || (b <= this.b && c >= this.a?this.b = this.a = null:b <= this.b && c < this.a?this.b = c:b > this.b && c >= this.a && (this.a = b));}).bind(a));}function mb(a,b){return null == a.a || a.a < b || b < a.b?0:a.a - b;}function jb(a,b){for(var c=a.c.cues,d=[],e=0;e < c.length;++e) b(c[e]) && d.push(c[e]);for(e = 0;e < d.length;++e) a.c.removeCue(d[e]);};function nb(a){a = a.toLowerCase().split("-");var b=ob[a[0]];b && (a[0] = b);return a.join("-");}var ob={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function J(a){return Object.keys(a).map(function(b){return a[b];});}function pb(a,b){return Object.keys(a).reduce(function(c,d){c[d] = b(a[d],d);return c;},{});}function qb(a,b){return Object.keys(a).reduce(function(c,d){b(d,a[d]) && (c[d] = a[d]);return c;},{});};function L(){this.a = {};}L.prototype.push = function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a] = [b];};L.prototype.get = function(a){return (a = this.a[a])?a.slice():null;};function rb(a,b,c){if(a = a.a[b])for(b = 0;b < a.length;++b) a[b] == c && (a.splice(b,1),--b);}L.prototype.keys = function(){var a=[],b;for(b in this.a) a.push(b);return a;};L.prototype.clear = function(){this.a = {};};function M(){this.a = new L();}M.prototype.s = function(){sb(this);this.a = null;return Promise.resolve();};function N(a,b,c,d){b = new tb(b,c,d);a.a.push(c,b);}M.prototype.Y = function(a,b){for(var c=this.a.get(b) || [],d=0;d < c.length;++d) {var e=c[d];e.target == a && (e.Y(),rb(this.a,b,e));}};function sb(a){var b=a.a,c=[],d;for(d in b.a) c.push.apply(c,b.a[d]);for(b = 0;b < c.length;++b) c[b].Y();a.a.clear();}function tb(a,b,c){this.target = a;this.type = b;this.a = c;this.target.addEventListener(b,c,!1);}tb.prototype.Y = function(){this.target && (this.target.removeEventListener(this.type,this.a,!1),this.a = this.target = null);};function ub(a,b,c,d,e,f){this.a = a;this.c = b;this.i = c;this.o = d;this.l = e;this.m = f;this.b = new M();this.h = !1;this.g = 1;this.f = null;0 < a.readyState?this.Ia():N(this.b,a,"loadedmetadata",this.Ia.bind(this));N(this.b,a,"ratechange",this.cb.bind(this));}k = ub.prototype;k.s = function(){var a=this.b.s();this.b = null;null != this.f && (window.clearInterval(this.f),this.f = null);this.m = this.l = this.c = this.a = null;return a;};function vb(a){return 0 < a.a.readyState?wb(a,a.a.currentTime):xb(a);}function xb(a){return a.o?wb(a,a.o):a.c.a < Number.POSITIVE_INFINITY?ra(a.c):Math.max(n(a.c) - a.i,ra(a.c));}function yb(a,b){b != a.h && (a.h = b,zb(a,a.g),a.l(b));}k.va = function(){return this.g;};function zb(a,b){null != a.f && (window.clearInterval(a.f),a.f = null);a.g = b;a.a.playbackRate = a.h || 0 > b?0:b;!a.h && 0 > b && (a.f = window.setInterval((function(){this.a.currentTime += b / 4;}).bind(a),250));}k.cb = function(){this.a.playbackRate != (this.h || 0 > this.g?0:this.g) && zb(this,this.a.playbackRate);};k.Ia = function(){this.b.Y(this.a,"loadedmetadata");var a=xb(this);this.a.currentTime.toFixed(3) == a.toFixed(3)?(N(this.b,this.a,"seeking",this.Ka.bind(this)),N(this.b,this.a,"playing",this.Ja.bind(this))):(N(this.b,this.a,"seeking",this.eb.bind(this)),this.a.currentTime = a);};k.eb = function(){this.b.Y(this.a,"seeking");N(this.b,this.a,"seeking",this.Ka.bind(this));N(this.b,this.a,"playing",this.Ja.bind(this));};k.Ka = function(){var a=this.a.currentTime,b=Ab(this,a);b != a?Bb(this,a,b):this.m();};k.Ja = function(){var a=this.a.currentTime,b=Ab(this,a);b != a && Bb(this,a,b);};function Ab(a,b){var c=a.c,d=ra(c),e=n(c);if(!c.aa() || c.c == Number.POSITIVE_INFINITY)return b < d?d:b > e?e:b;c = d + 1;d = c + a.i;return b >= d && b <= e || 0 != ua(a.a.buffered,b) && b >= c && b <= e?b:b > e?e:e < d && b >= c && b <= e?b:Math.min(d + 2,e);}function Bb(a,b,c){a.a.currentTime = c;var d=0,e=(function(){!this.a || 10 <= d++ || this.a.currentTime != b || (this.a.currentTime = c,setTimeout(e,100));}).bind(a);setTimeout(e,100);}function wb(a,b){var c=ra(a.c);if(b < c)return c;c = n(a.c);return b > c?c:b;};function ca(){this.w = new L();}ca.prototype.addEventListener = function(a,b){this.w.push(a,b);};ca.prototype.removeEventListener = function(a,b){rb(this.w,a,b);};ca.prototype.dispatchEvent = function(a){for(var b=this.w.get(a.type) || [],c=0;c < b.length;++c) {a.target = this;a.currentTarget = this;var d=b[c];try{d.handleEvent?d.handleEvent(a):d.call(this,a);}catch(e) {}if(a.a)break;}return a.defaultPrevented;};function O(){var a,b,c=new Promise(function(c,e){a = c;b = e;});c.resolve = a;c.reject = b;return c;};function Cb(a,b,c){this.i = a;this.f = b;this.l = c;this.c = {};this.b = null;this.a = {};this.g = new M();this.h = !1;}function Db(){var a={basic:!!window.MediaSource},b=navigator.vendor,c=navigator.appVersion;b && 0 <= b.indexOf("Apple") && c && 0 <= c.indexOf("Version/8") && (a.basic = !1);a.basic && 'video/mp4; codecs="avc1.42E01E",audio/mp4; codecs="mp4a.40.2",video/webm; codecs="vp8",video/webm; codecs="vp9",audio/webm; codecs="vorbis",audio/webm; codecs="opus",video/mp2t; codecs="avc1.42E01E",video/mp2t; codecs="mp4a.40.2",text/vtt,application/mp4; codecs="wvtt",application/ttml+xml,application/mp4; codecs="stpp"'.split(",").forEach(function(b){a[b] = !!ib[b] || MediaSource.isTypeSupported(b);var c=b.split(";")[0];a[c] = a[c] || a[b];});return a;}k = Cb.prototype;k.s = function(){this.h = !0;var a=[],b;for(b in this.a) {var c=this.a[b],d=c[0];this.a[b] = c.slice(0,1);d && a.push(d.p["catch"](G));for(d = 1;d < c.length;++d) c[d].p["catch"](G),c[d].p.reject();}this.b && a.push(this.b.s());return Promise.all(a).then((function(){this.g.s();this.b = this.l = this.f = this.i = this.g = null;this.c = {};this.a = {};}).bind(this));};k.init = function(a){for(var b in a) {var c=a[b];"text" == b?this.b = new hb(this.l,c):(c = this.f.addSourceBuffer(c),N(this.g,c,"error",this.Gb.bind(this,b)),N(this.g,c,"updateend",this.za.bind(this,b)),this.c[b] = c,this.a[b] = []);}};function Eb(a,b){var c;c = "text" == b?a.b.b:(c = a.c[b].buffered)?c.length?c.start(0):null:null;return c;}function Fb(a,b,c){"text" == b?(b = mb(a.b,c),b || (b = mb(a.b,c + .1)) && (b += .1)):(a = a.c[b].buffered,b = ua(a,c),b || (b = ua(a,c + .1)) && (b += .1));return b;}function Gb(a,b,c,d,e){return "text" == b?kb(a.b,c,d,e):Hb(a,b,a.Fb.bind(a,b,c));}function Ib(a,b,c,d){return "text" == b?lb(a.b,c,d):Hb(a,b,a.La.bind(a,b,c,d));}k.clear = function(a){return "text" == a?lb(this.b,0,Number.POSITIVE_INFINITY):Hb(this,a,this.La.bind(this,a,0,this.f.duration));};function Kb(a,b,c){return "text" == b?(a.b.h = c,Promise.resolve()):Hb(a,b,a.yb.bind(a,b,c));}function Mb(a,b,c){return "text" == b?(a.b.f = c,Promise.resolve()):Hb(a,b,a.wb.bind(a,b,c));}k.endOfStream = function(a){return Nb(this,(function(){a?this.f.endOfStream(a):this.f.endOfStream();}).bind(this));};function Ob(a,b){Nb(a,(function(){this.f.duration = b;}).bind(a));}k.Fb = function(a,b){this.c[a].appendBuffer(b);};k.La = function(a,b,c){this.c[a].remove(b,c);};k.yb = function(a,b){this.c[a].timestampOffset = b;this.za(a);};k.wb = function(a,b){this.c[a].appendWindowEnd = b + 1 / 15;this.za(a);};k.Gb = function(a){this.a[a][0].p.reject(new z(3,3014,this.i.error?this.i.error.code:0));};k.za = function(a){var b=this.a[a][0];b && (b.p.resolve(),Pb(this,a));};function Hb(a,b,c){if(a.h)return Promise.reject();c = {start:c,p:new O()};a.a[b].push(c);if(1 == a.a[b].length)try{c.start();}catch(d) {c.p.reject(new z(3,3015,d)),Pb(a,b);}return c.p;}function Nb(a,b){if(a.h)return Promise.reject();var c=[],d;for(d in a.c) {var e=new O(),f={start:(function(a){a.resolve();}).bind(null,e),p:e};a.a[d].push(f);c.push(e);1 == a.a[d].length && f.start();}return Promise.all(c).then((function(){var a,c;try{b();}catch(d) {c = Promise.reject(new z(3,3015,d));}for(a in this.c) Pb(this,a);return c;}).bind(a),(function(){return Promise.reject();}).bind(a));}function Pb(a,b){a.a[b].shift();var c=a.a[b][0];if(c)try{c.start();}catch(d) {c.p.reject(new z(3,3015,d)),Pb(a,b);}};function Qb(a){if(!a)return "";a = Rb(new Uint8Array(a));a = escape(a);try{return decodeURIComponent(a);}catch(b) {throw new z(2,2004);}}function Sb(a,b){if(!a)return "";if(0 != a.byteLength % 2)throw new z(2,2004);var c;if(a instanceof ArrayBuffer)c = a;else {var d=new Uint8Array(a.byteLength);d.set(new Uint8Array(a));c = d.buffer;}var d=a.byteLength / 2,e=new Uint16Array(d);c = new DataView(c);for(var f=0;f < d;f++) e[f] = c.getUint16(2 * f,b);return Rb(e);}function Tb(a){var b=new Uint8Array(a);if(239 == b[0] && 187 == b[1] && 191 == b[2])return Qb(b.subarray(3));if(254 == b[0] && 255 == b[1])return Sb(b.subarray(2),!1);if(255 == b[0] && 254 == b[1])return Sb(b.subarray(2),!0);var c=(function(a,b){return a.byteLength <= b || 32 <= a[b] && 126 >= a[b];}).bind(null,b);if(0 == b[0] && 0 == b[2])return Sb(a,!1);if(0 == b[1] && 0 == b[3])return Sb(a,!0);if(c(0) && c(1) && c(2) && c(3))return Qb(a);throw new z(2,2003);}function Ub(a){a = unescape(encodeURIComponent(a));for(var b=new Uint8Array(a.length),c=0;c < a.length;++c) b[c] = a.charCodeAt(c);return b.buffer;}function Rb(a){for(var b="",c=0;c < a.length;c += 16E3) b += String.fromCharCode.apply(null,a.subarray(c,c + 16E3));return b;};function Vb(a){this.b = a;this.a = 0;}function Wb(a,b){var c;b.lastIndex = a.a;c = b.exec(a.b);c = null == c?null:{position:c.index,length:c[0].length,tb:c};if(a.a == a.b.length || null == c || c.position != a.a)return null;a.a += c.length;return c.tb;}function Xb(a){return a.a == a.b.length?null:(a = Wb(a,/[^ \t\n]*/gm))?a[0]:null;};function P(a){a = Tb(a);a = a.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");a = a.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(a[0]))throw new z(2,2E3);for(var b=[],c=1;c < a.length;c++) {var d=P.b(a[c].split("\n"));d && b.push(d);}return b;}P.b = function(a){if(1 == a.length && !a[0] || /^NOTE($|[ \t])/.test(a[0]))return null;var b=null;0 > a[0].indexOf("--\x3e") && (b = a[0],a.splice(0,1));var c=new Vb(a[0]),d=P.a(c),e=Wb(c,/[ \t]+--\x3e[ \t]+/g),f=P.a(c);if(null == d || null == e || null == f)throw new z(2,2001);a = a.slice(1).join("\n");if(window.VTTCue)for(d = new VTTCue(d,f,a),Wb(c,/[ \t]+/gm),f = Xb(c);f;) {if(!P.c(d,f))throw new z(2,2002);Wb(c,/[ \t]+/gm);f = Xb(c);}else d = new TextTrackCue(d,f,a);null != b && (d.id = b);return d;};P.c = function(a,b){var c=null;if(c = /^align:(start|middle|end)$/.exec(b))a.align = c[1];else if(c = /^vertical:(lr|rl)$/.exec(b))a.c = c[1];else if(c = /^size:(\d{1,2}|100)%$/.exec(b))a.size = Number(c[1]);else if(c = /^position:(\d{1,2}|100)%$/.exec(b))a.position = Number(c[1]);else if(c = /^line:(\d{1,2}|100)%$/.exec(b))a.b = !1,a.a = Number(c[1]);else if(c = /^line:(-?\d+)$/.exec(b))a.b = !0,a.a = Number(c[1]);else return !1;return !0;};P.a = function(a){a = Wb(a,/(?:(\d{2,}):)?(\d{2}):(\d{2})\.(\d{3})/g);if(null == a)return null;var b=Number(a[2]),c=Number(a[3]);return 59 < b || 59 < c?null:Number(a[4]) / 1E3 + c + 60 * b + 3600 * (Number(a[1]) || 0);};ib["text/vtt"] = P;function Yb(a){return window.btoa(String.fromCharCode.apply(null,a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/,"");}function Zb(a){a = window.atob(a.replace(/-/g,"+").replace(/_/g,"/"));for(var b=new Uint8Array(a.length),c=0;c < a.length;++c) b[c] = a.charCodeAt(c);return b;}function $b(a){for(var b=new Uint8Array(a.length / 2),c=0;c < a.length;c += 2) b[c / 2] = window.parseInt(a.substr(c,2),16);return b;}function ac(a){for(var b="",c=0;c < a.length;++c) {var d=a[c].toString(16);1 == d.length && (d = "0" + d);b += d;}return b;}function E(a,b){if(!a && !b)return !0;if(!a || !b || a.length != b.length)return !1;for(var c=0;c < a.length;++c) if(a[c] != b[c])return !1;return !0;};function bc(a,b,c){this.l = "";this.m = null;this.o = [];this.h = this.i = null;this.u = !1;this.c = new M();this.w = "";this.a = [];this.A = a;this.f = null;this.g = b;this.F = c;this.b = !1;}k = bc.prototype;k.s = function(){this.b = !0;this.a.forEach(function(a){a.pa.close()["catch"](G);});var a=[];this.c && a.push(this.c.s());this.h && a.push(this.h.setMediaKeys(null)["catch"](G));this.o = [];this.c = this.h = this.i = this.m = null;this.a = [];this.g = this.f = this.A = null;return Promise.all(a);};k.configure = function(a){this.f = a;};k.init = function(a,b){var c={},d=[];cc(this,a,b,c,d);return d.length?dc(this,c,d):(this.u = !0,Promise.resolve());};function ec(a,b){if(!a.i)return N(a.c,b,"encrypted",(function(){this.c.Y(b,"encrypted");this.g(new z(6,6010));}).bind(a)),Promise.resolve();var c=[],d=[],e=[];fc(a,c,d,e);a.w = c[0];a.h = b;var c=a.h.setMediaKeys(a.i),c=c["catch"](function(a){return Promise.reject(new z(6,6003,a.message));}),f=null;d.length && (f = a.i.setServerCertificate(d[0]),f = f["catch"](function(a){return Promise.reject(new z(6,6004,a.message));}));N(a.c,a.h,"waitingforkey",a.hb.bind(a));return Promise.all([c,f]).then((function(){if(this.b)return Promise.reject();e.length?e.forEach((function(a){gc(this,a.initDataType,a.initData);}).bind(this)):N(this.c,this.h,"encrypted",this.Ya.bind(this));}).bind(a))["catch"]((function(a){return this.b?Promise.resolve():Promise.reject(a);}).bind(a));}k.keySystem = function(){return this.l;};function cc(a,b,c,d,e){var f=hc(a);b.periods.forEach((function(a){a.streamSets.forEach((function(a){"text" != a.type && (f && (a.drmInfos = [f]),a.drmInfos.forEach((function(b){ic(this,b);var f=d[b.keySystem];f || (f = {initDataTypes:void 0,audioCapabilities:[],videoCapabilities:[],distinctiveIdentifier:"optional",persistentState:c?"required":"optional",sessionTypes:[c?"persistent-license":"temporary"],label:b.keySystem,drmInfos:[]},d[b.keySystem] = f,e.push(b.keySystem));f.drmInfos.push(b);b.distinctiveIdentifierRequired && (f.distinctiveIdentifier = "required");b.persistentStateRequired && (f.persistentState = "required");var g="video" == a.type?f.videoCapabilities:f.audioCapabilities,t=("video" == a.type?b.videoRobustness:b.audioRobustness) || "";a.streams.forEach((function(a){var c=a.mimeType;a.codecs && (c += '; codecs="' + a.codecs + '"');"com.microsoft.playready" == b.keySystem && g.length || g.push({robustness:t,contentType:c});}).bind(this));}).bind(this)));}).bind(this));}).bind(a));}function dc(a,b,c){var d=new O(),e=d;if(1 == c.length && "" == c[0])return Promise.reject(new z(6,6E3));c.forEach((function(a){var c=b[a];c.drmInfos.some(function(a){return !!a.licenseServerUri;}) && (0 == c.audioCapabilities.length && (c.audioCapabilities = void 0),0 == c.videoCapabilities.length && (c.videoCapabilities = void 0),e = e["catch"]((function(){return this.b?Promise.reject():navigator.requestMediaKeySystemAccess(a,[c]);}).bind(this)));}).bind(a));e = e["catch"](function(){return Promise.reject(new z(6,6001));});e = e.then((function(a){if(this.b)return Promise.reject();var c=a.getConfiguration();this.m = (c.audioCapabilities || []).concat(c.videoCapabilities || []).map(function(a){return a.contentType;});0 == this.m.length && (this.m = null);this.o = b[a.keySystem].drmInfos;this.l = a.keySystem;return a.createMediaKeys();}).bind(a)).then((function(a){if(this.b)return Promise.reject();this.i = a;this.u = !0;}).bind(a))["catch"]((function(a){if(this.b)return Promise.resolve();if(a instanceof z)return Promise.reject(a);this.l = "";this.o = [];this.m = null;return Promise.reject(new z(6,6002,a.message));}).bind(a));d.reject();return e;}function ic(a,b){var c=b.keySystem;if(c){if(!b.licenseServerUri){var d=a.f.servers[c];d && (b.licenseServerUri = d);}if(c = a.f.advanced[c])b.distinctiveIdentifierRequired || (b.distinctiveIdentifierRequired = c.distinctiveIdentifierRequired),b.persistentStateRequired || (b.persistentStateRequired = c.persistentStateRequired),b.videoRobustness || (b.videoRobustness = c.videoRobustness),b.audioRobustness || (b.audioRobustness = c.audioRobustness),b.serverCertificate || (b.serverCertificate = c.serverCertificate);}}function hc(a){var b=a.f.clearKeys;if(!b || 0 == Object.keys(b).length)return null;var c=[],b=[],d;for(d in a.f.clearKeys) {var e=a.f.clearKeys[d],f=$b(d),e=$b(e),f={kty:"oct",kid:Yb(f),k:Yb(e)};c.push(f);b.push(f.kid);}a = JSON.stringify({keys:c});b = JSON.stringify({kids:b});b = [{initData:new Uint8Array(Ub(b)),initDataType:"keyids"}];return {keySystem:"org.w3.clearkey",licenseServerUri:"data:application/json;base64," + window.btoa(a),distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:b};}function fc(a,b,c,d){function e(a,b){return a.initDataType == b.initDataType && E(a.initData,b.initData);}a.o.forEach(function(a){-1 == b.indexOf(a.licenseServerUri) && b.push(a.licenseServerUri);a.serverCertificate && -1 == Qa(c,a.serverCertificate,E) && c.push(a.serverCertificate);a.initData && a.initData.forEach(function(a){-1 == Qa(d,a,e) && d.push(a);});});}k.hb = function(){this.a.some(function(a){return !a.loaded;}) || this.g(new z(6,6011));};k.Ya = function(a){for(var b=new Uint8Array(a.initData),c=0;c < this.a.length;++c) if(E(b,this.a[c].initData))return;gc(this,a.initDataType,b);};function gc(a,b,c){var d;try{d = a.i.createSession();}catch(e) {a.g(new z(6,6005,e.message));return;}N(a.c,d,"message",a.fb.bind(a));N(a.c,d,"keystatuseschange",a.Za.bind(a));b = d.generateRequest(b,c.buffer);a.a.push({initData:c,pa:d,loaded:!1});b["catch"]((function(a){if(!this.b){for(var b=0;b < this.a.length;++b) if(this.a[b].pa == d){this.a.splice(b,1);break;}this.g(new z(6,6006,a.message));}}).bind(a));}k.fb = function(a){var b=a.target,c=jc,d=kc([this.w],this.f.retryParameters);d.body = a.message;d.method = "POST";"com.microsoft.playready" == this.l && lc(d);this.A.request(c,d).then((function(a){return this.b?Promise.reject():b.update(a.data);}).bind(this),(function(a){if(this.b)return Promise.resolve();this.g(new z(6,6007,a));}).bind(this))["catch"]((function(a){if(this.b)return Promise.resolve();this.g(new z(6,6008,a.message));}).bind(this));};function lc(a){for(var b=Sb(a.body,!0),b=new DOMParser().parseFromString(b,"application/xml"),c=b.getElementsByTagName("HttpHeader"),d=0;d < c.length;++d) a.headers[c[d].querySelector("name").textContent] = c[d].querySelector("value").textContent;a.body = Zb(b.querySelector("Challenge").textContent).buffer;}k.Za = function(a){var b=a.target;a = b.keyStatuses;void 0 === a.forEach && (a = []);var c={};a.forEach((function(a,e){if("string" == typeof a){var f=a;a = e;e = f;}if("com.microsoft.playready" == this.l && 16 == a.byteLength){var f=new DataView(a),g=f.getUint32(0,!0),l=f.getUint16(4,!0),h=f.getUint16(6,!0);f.setUint32(0,g,!1);f.setUint16(4,l,!1);f.setUint16(6,h,!1);}"com.microsoft.playready" == this.l && "status-pending" == e && (e = "usable");"status-pending" != e && "internal-error" != e && (this.a.filter(function(a){return a.pa == b;})[0].loaded = !0);f = ac(new Uint8Array(a));c[f] = e;}).bind(this));if(b.expiration < Date.now()){for(a = 0;a < this.a.length;++a) if(this.a[a].pa == b){this.a.splice(a,1);break;}b.close();}this.F(c);};function mc(){var a={basic:!!window.MediaKeys && !!window.navigator && !!window.navigator.requestMediaKeySystemAccess && !!window.MediaKeySystemAccess && !!window.MediaKeySystemAccess.prototype.getConfiguration},b=[];a.basic && "org.w3.clearkey com.widevine.alpha com.microsoft.playready com.apple.fps.2_0 com.apple.fps.1_0 com.apple.fps com.adobe.primetime".split(" ").forEach(function(c){var d=navigator.requestMediaKeySystemAccess(c,[{}]).then(function(){a[c] = !0;},function(){a[c] = !1;});b.push(d);});return Promise.all(b).then(function(){return a;});};function nc(a,b){try{var c=new oc(a,b);return Promise.resolve(c);}catch(d) {return Promise.reject(d);}}function pc(a){var b=this.mediaKeys;b && b != a && qc(b,null);delete this.mediaKeys;(this.mediaKeys = a) && qc(a,this);return Promise.resolve();}function oc(a,b){this.a = this.keySystem = a;var c=!0;"org.w3.clearkey" == a && (this.a = "webkit-org.w3.clearkey",c = !1);var d=!1,e;e = document.getElementsByTagName("video");e = e.length?e[0]:document.createElement("video");for(var f=0;f < b.length;++f) {var g=b[f],l={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes,sessionTypes:["temporary"],label:g.label},h=!1;if(g.audioCapabilities)for(var p=0;p < g.audioCapabilities.length;++p) {var q=g.audioCapabilities[p];q.contentType && (h = !0,e.canPlayType(q.contentType.split(";")[0],this.a) && (l.audioCapabilities.push(q),d = !0));}if(g.videoCapabilities)for(p = 0;p < g.videoCapabilities.length;++p) q = g.videoCapabilities[p],q.contentType && (h = !0,e.canPlayType(q.contentType,this.a) && (l.videoCapabilities.push(q),d = !0));h || (d = e.canPlayType("video/mp4",this.a) || e.canPlayType("video/webm",this.a));"required" == g.persistentState && (c?(l.persistentState = "required",l.sessionTypes = ["persistent-license"]):d = !1);if(d){this.b = l;return;}}c = "Unsupported keySystem";if("org.w3.clearkey" == a || "com.widevine.alpha" == a)c = "None of the requested configurations were supported.";c = Error(c);c.name = "NotSupportedError";c.code = DOMException.NOT_SUPPORTED_ERR;throw c;}oc.prototype.createMediaKeys = function(){var a=new rc(this.a);return Promise.resolve(a);};oc.prototype.getConfiguration = function(){return this.b;};function rc(a){this.g = a;this.b = null;this.a = new M();this.c = [];this.f = {};}function qc(a,b){a.b = b;sb(a.a);b && (N(a.a,b,"webkitneedkey",a.lb.bind(a)),N(a.a,b,"webkitkeymessage",a.kb.bind(a)),N(a.a,b,"webkitkeyadded",a.ib.bind(a)),N(a.a,b,"webkitkeyerror",a.jb.bind(a)));}k = rc.prototype;k.createSession = function(a){var b=a || "temporary";if("temporary" != b && "persistent-license" != b)throw new TypeError("Session type " + a + " is unsupported on this platform.");a = this.b || document.createElement("video");a.src || (a.src = "about:blank");b = new sc(a,this.g,b);this.c.push(b);return b;};k.setServerCertificate = function(){return Promise.reject(Error("setServerCertificate not supported on this platform."));};k.lb = function(a){this.b.dispatchEvent(new F("encrypted",{initDataType:"webm",initData:a.initData}));};k.kb = function(a){var b=tc(this,a.sessionId);b && (a = new F("message",{messageType:void 0 == b.keyStatuses.wa()?"licenserequest":"licenserenewal",message:a.message}),b.b && (b.b.resolve(),b.b = null),b.dispatchEvent(a));};k.ib = function(a){if(a = tc(this,a.sessionId))uc(a,"usable"),a.a && a.a.resolve(),a.a = null;};k.jb = function(a){var b=tc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode = a.errorCode;c.errorCode.systemCode = a.systemCode;!a.sessionId && b.b?(c.method = "generateRequest",45 == a.systemCode && (c.message = "Unsupported session type."),b.b.reject(c),b.b = null):a.sessionId && b.a?(c.method = "update",b.a.reject(c),b.a = null):(c = a.systemCode,a.errorCode.code == MediaKeyError.MEDIA_KEYERR_OUTPUT?uc(b,"output-restricted"):1 == c?uc(b,"expired"):uc(b,"internal-error"));}};function tc(a,b){var c=a.f[b];return c?c:(c = a.c.shift())?(c.sessionId = b,a.f[b] = c):null;}function sc(a,b,c){this.w = new L();this.f = a;this.h = !1;this.a = this.b = null;this.c = b;this.g = c;this.sessionId = "";this.expiration = NaN;this.closed = new O();this.keyStatuses = new vc();}ba(sc);function wc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h = !0;var d;try{if("persistent-license" == a.g)if(c)d = new Uint8Array(Ub("LOAD_SESSION|" + c));else {var e=Ub("PERSISTENT|"),f=new Uint8Array(e.byteLength + b.byteLength);f.set(new Uint8Array(e),0);f.set(new Uint8Array(b),e.byteLength);d = f;}else d = new Uint8Array(b);}catch(g) {return Promise.reject(g);}a.b = new O();try{a.f.webkitGenerateKeyRequest(a.c,d);}catch(g) {if("InvalidStateError" != g.name)return a.b = null,Promise.reject(g);setTimeout((function(){try{this.f.webkitGenerateKeyRequest(this.c,d);}catch(a) {this.b.reject(a),this.b = null;}}).bind(a),10);}return a.b;}k = sc.prototype;k.Da = function(a,b){if(this.a)this.a.then(this.Da.bind(this,a,b))["catch"](this.Da.bind(this,a,b));else {this.a = a;var c,d;"webkit-org.w3.clearkey" == this.c?(c = Qb(b),d = JSON.parse(c),"oct" != d.keys[0].kty && (this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a = null),c = Zb(d.keys[0].k),d = Zb(d.keys[0].kid)):(c = new Uint8Array(b),d = null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId);}catch(e) {this.a.reject(e),this.a = null;}}};function uc(a,b){a.keyStatuses.Aa(b);a.dispatchEvent(new F("keystatuseschange"));}k.generateRequest = function(a,b){return wc(this,b,null);};k.load = function(a){return "persistent-license" == this.g?wc(this,null,a):Promise.reject(Error("Not a persistent session."));};k.update = function(a){var b=new O();this.Da(b,a);return b;};k.close = function(){if("persistent-license" != this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId);}this.closed.resolve();return this.closed;};k.remove = function(){return "persistent-license" != this.g?Promise.reject(Error("Not a persistent session.")):this.close();};function vc(){this.size = 0;this.a = void 0;}var xc;k = vc.prototype;k.Aa = function(a){this.size = void 0 == a?0:1;this.a = a;};k.wa = function(){return this.a;};k.forEach = function(a){this.a && a(xc,this.a);};k.get = function(a){if(this.has(a))return this.a;};k.has = function(a){var b=xc;return this.a && E(new Uint8Array(a),new Uint8Array(b))?!0:!1;};function yc(a){this.systemIds = [];this.cencKeyIds = [];this.a = [];for(a = new Ra(new DataView(a.buffer));Ta(a);) {var b=a.a,c=A(a),d=A(a);1 == c?c = Wa(a):0 == c && (c = a.b.byteLength - b);if(1886614376 != d)B(a,c - (a.a - b));else {var e=Ua(a);if(1 < e)B(a,c - (a.a - b));else {B(a,3);var d=ac(Xa(a)),f=[];if(0 < e)for(var e=A(a),g=0;g < e;++g) {var l=ac(Xa(a));f.push(l);}e = A(a);B(a,e);this.cencKeyIds.push.apply(this.cencKeyIds,f);this.systemIds.push(d);this.a.push({start:b,end:a.a - 1});a.a != b + c && B(a,c - (a.a - b));}}}};function zc(a,b){try{var c=new Ac(a,b);return Promise.resolve(c);}catch(d) {return Promise.reject(d);}}function Ac(a,b){this.keySystem = a;for(var c=!1,d=0;d < b.length;++d) {var e=b[d],f={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:e.initDataTypes,sessionTypes:["temporary"],label:e.label},g=!1;if(e.audioCapabilities)for(var l=0;l < e.audioCapabilities.length;++l) {var h=e.audioCapabilities[l];if(h.contentType){var g=!0,p=h.contentType.split(";")[0];MSMediaKeys.isTypeSupported(this.keySystem,p) && (f.audioCapabilities.push(h),c = !0);}}if(e.videoCapabilities)for(l = 0;l < e.videoCapabilities.length;++l) h = e.videoCapabilities[l],h.contentType && (g = !0,p = h.contentType.split(";")[0],MSMediaKeys.isTypeSupported(this.keySystem,p) && (f.videoCapabilities.push(h),c = !0));g || (c = MSMediaKeys.isTypeSupported(this.keySystem,"video/mp4"));"required" == e.persistentState && (f.persistentState = "required",f.sessionTypes = ["persistent-license"]);if(c){this.a = f;return;}}c = Error("Unsupported keySystem");c.name = "NotSupportedError";c.code = DOMException.NOT_SUPPORTED_ERR;throw c;}Ac.prototype.createMediaKeys = function(){var a=new Bc(this.keySystem);return Promise.resolve(a);};Ac.prototype.getConfiguration = function(){return this.a;};function Cc(a){var b=this.mediaKeys;b && b != a && Dc(b,null);delete this.mediaKeys;return (this.mediaKeys = a)?Dc(a,this):Promise.resolve();}function Bc(a){this.a = new MSMediaKeys(a);this.b = new M();}Bc.prototype.createSession = function(a){if("temporary" != (a || "temporary"))throw new TypeError("Session type " + a + " is unsupported on this platform.");return new Ec(this.a);};Bc.prototype.setServerCertificate = function(){return Promise.reject(Error("setServerCertificate not supported on this platform."));};function Dc(a,b){function c(){b.msSetMediaKeys(d.a);b.removeEventListener("loadedmetadata",c);}sb(a.b);if(!b)return Promise.resolve();N(a.b,b,"msneedkey",Fc);var d=a;try{return 1 <= b.readyState?b.msSetMediaKeys(a.a):b.addEventListener("loadedmetadata",c),Promise.resolve();}catch(e) {return Promise.reject(e);}}function Ec(a){this.w = new L();this.c = null;this.g = a;this.b = this.a = null;this.f = new M();this.sessionId = "";this.expiration = NaN;this.closed = new O();this.keyStatuses = new Gc();}ba(Ec);k = Ec.prototype;k.generateRequest = function(a,b){this.a = new O();try{this.c = this.g.createSession("video/mp4",new Uint8Array(b),null),N(this.f,this.c,"mskeymessage",this.bb.bind(this)),N(this.f,this.c,"mskeyadded",this.$a.bind(this)),N(this.f,this.c,"mskeyerror",this.ab.bind(this)),Hc(this,"status-pending");}catch(c) {this.a.reject(c);}return this.a;};k.load = function(){return Promise.reject(Error("MediaKeySession.load not yet supported"));};k.update = function(a){this.b = new O();try{this.c.update(new Uint8Array(a));}catch(b) {this.b.reject(b);}return this.b;};k.close = function(){try{this.c.close(),this.closed.resolve(),sb(this.f);}catch(a) {this.closed.reject(a);}return this.closed;};k.remove = function(){return Promise.reject(Error("MediaKeySession.remove is only applicable for persistent licenses, which are not supported on this platform"));};function Fc(a){var b=document.createEvent("CustomEvent");b.initCustomEvent("encrypted",!1,!1,null);b.initDataType = "cenc";if(a = a.initData){var c=new yc(a);if(!(1 >= c.a.length)){for(var d=[],e=0;e < c.a.length;e++) d.push(a.subarray(c.a[e].start,c.a[e].end + 1));e = Ic;a = [];for(c = 0;c < d.length;++c) {for(var f=!1,g=0;g < a.length && !(f = e?e(d[c],a[g]):d[c] === a[g]);++g);f || a.push(d[c]);}for(e = d = 0;e < a.length;e++) d += a[e].length;d = new Uint8Array(d);for(e = c = 0;e < a.length;e++) d.set(a[e],c),c += a[e].length;a = d;}}b.initData = a;this.dispatchEvent(b);}function Ic(a,b){return E(a,b);}k.bb = function(a){this.a && (this.a.resolve(),this.a = null);this.dispatchEvent(new F("message",{messageType:void 0 == this.keyStatuses.wa()?"licenserequest":"licenserenewal",message:a.message.buffer}));};k.$a = function(){this.a?(Hc(this,"usable"),this.a.resolve(),this.a = null):this.b && (Hc(this,"usable"),this.b.resolve(),this.b = null);};k.ab = function(){var a=Error("EME v20140218 key error");a.errorCode = this.c.error;if(null != this.a)this.a.reject(a),this.a = null;else if(null != this.b)this.b.reject(a),this.b = null;else switch(this.c.error.code){case MSMediaKeyError.MS_MEDIA_KEYERR_OUTPUT:case MSMediaKeyError.MS_MEDIA_KEYERR_HARDWARECHANGE:Hc(this,"output-not-allowed");default:Hc(this,"internal-error");}};function Hc(a,b){a.keyStatuses.Aa(b);a.dispatchEvent(new F("keystatuseschange"));}function Gc(){this.size = 0;this.a = void 0;}var Jc;k = Gc.prototype;k.Aa = function(a){this.size = void 0 == a?0:1;this.a = a;};k.wa = function(){return this.a;};k.forEach = function(a){this.a && a(Jc,this.a);};k.get = function(a){if(this.has(a))return this.a;};k.has = function(a){var b=Jc;return this.a && E(new Uint8Array(a),new Uint8Array(b))?!0:!1;};wa(function(){!window.HTMLVideoElement || navigator.requestMediaKeySystemAccess && MediaKeySystemAccess.prototype.getConfiguration || (HTMLMediaElement.prototype.webkitGenerateKeyRequest?(xc = new Uint8Array([0]).buffer,navigator.requestMediaKeySystemAccess = nc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys = null,HTMLMediaElement.prototype.setMediaKeys = pc,window.MediaKeys = rc,window.MediaKeySystemAccess = oc):window.MSMediaKeys?(Jc = new Uint8Array([0]).buffer,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys = null,HTMLMediaElement.prototype.setMediaKeys = Cc,window.MediaKeys = Bc,window.MediaKeySystemAccess = Ac,navigator.requestMediaKeySystemAccess = zc):(navigator.requestMediaKeySystemAccess = ya,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys = null,HTMLMediaElement.prototype.setMediaKeys = za,window.MediaKeys = Aa,window.MediaKeySystemAccess = Ba));});function Kc(a,b){var c=R(a,b);return 1 != c.length?null:c[0];}function R(a,b){return Array.prototype.filter.call(a.childNodes,function(a){return a.tagName == b;});}function Lc(a){return (a = a.firstChild) && a.nodeType == Node.TEXT_NODE?a.nodeValue.trim():null;}function S(a,b,c,d){var e=null;a = a.getAttribute(b);null != a && (e = c(a));return null == e?void 0 !== d?d:null:e;}function Mc(a){if(!a)return null;a = Date.parse(a);return isNaN(a)?null:Math.floor(a / 1E3);}function T(a){if(!a)return null;a = /^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!a)return null;a = 31536E3 * Number(a[1] || null) + 2592E3 * Number(a[2] || null) + 86400 * Number(a[3] || null) + 3600 * Number(a[4] || null) + 60 * Number(a[5] || null) + Number(a[6] || null);return isFinite(a)?a:null;}function Nc(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a = Number(b[1]);if(!isFinite(a))return null;b = Number(b[2]);return isFinite(b)?{start:a,end:b}:null;}function Oc(a){a = Number(a);return 0 === a % 1?a:null;}function Pc(a){a = Number(a);return 0 === a % 1 && 0 < a?a:null;}function Qc(a){a = Number(a);return 0 === a % 1 && 0 <= a?a:null;};var Rc={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};function Sc(a,b){var c=Uc(a),d=null,e=c.filter(function(a){return "urn:mpeg:dash:mp4protection:2011" == a.Ma?(d = a.init || d,!1):!0;}),f=c.map(function(a){return a.keyId;}).filter(db),g=null;if(0 < f.length && (g = f[0],f.some(eb(g))))throw new z(4,4010);f = [];0 < e.length?(f = Vc(d,b,e),0 == f.length && (f = [Wc("",d)])):0 < c.length && (f = J(Rc).map(function(a){return Wc(a,d);}));return {Ga:g,Nb:d,drmInfos:f,Ha:!0};}function Xc(a,b,c){var d=Sc(a,b);if(c.Ha){a = 1 == c.drmInfos.length && !c.drmInfos[0].keySystem;b = 0 == d.drmInfos.length;if(0 == c.drmInfos.length || a && !b)c.drmInfos = d.drmInfos;c.Ha = !1;}else if(0 < d.drmInfos.length && (c.drmInfos = c.drmInfos.filter(function(a){return d.drmInfos.some(function(b){return b.keySystem == a.keySystem;});}),0 == c.drmInfos.length))throw new z(4,4008);return d.Ga || c.Ga;}function Wc(a,b){return {keySystem:a,licenseServerUri:"",distinctiveIdentifierRequired:!1,persistentStateRequired:!1,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:b || []};}function Vc(a,b,c){return c.map(function(c){var e=Rc[c.Ma];return e?[Wc(e,c.init || a)]:b(c.node) || [];}).reduce(cb,[]);}function Uc(a){return a.map(function(a){var c=a.getAttribute("schemeIdUri"),d=a.getAttribute("cenc:default_KID"),e=R(a,"cenc:pssh").map(Lc);if(!c)return null;c = c.toLowerCase();if(d && (d = d.replace(/-/g,"").toLowerCase(),0 <= d.indexOf(" ")))throw new z(4,4009);var f=[];try{f = e.map(function(a){return {initDataType:"cenc",initData:Zb(a)};});}catch(g) {throw new z(4,4007);}return {node:a,Ma:c,keyId:d,init:0 < f.length?f:null};}).filter(db);};var Yc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function U(a){var b;a instanceof U?(Zc(this,a.K),this.Z = a.Z,this.M = a.M,$c(this,a.ca),this.H = a.H,ad(this,bd(a.a)),this.V = a.V):a && (b = String(a).match(Yc))?(Zc(this,b[1] || "",!0),this.Z = cd(b[2] || ""),this.M = cd(b[3] || "",!0),$c(this,b[4]),this.H = cd(b[5] || "",!0),ad(this,b[6] || "",!0),this.V = cd(b[7] || "")):this.a = new V(null);}k = U.prototype;k.K = "";k.Z = "";k.M = "";k.ca = null;k.H = "";k.V = "";k.toString = function(){var a=[],b=this.K;b && a.push(dd(b,ed,!0),":");if(b = this.M){a.push("//");var c=this.Z;c && a.push(dd(c,ed,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b = this.ca;null != b && a.push(":",String(b));}if(b = this.H)this.M && "/" != b.charAt(0) && a.push("/"),a.push(dd(b,"/" == b.charAt(0)?fd:gd,!0));(b = this.a.toString()) && a.push("?",b);(b = this.V) && a.push("#",dd(b,hd));return a.join("");};k.resolve = function(a){var b=new U(this);"data" === b.K && (b = new U());var c=!!a.K;c?Zc(b,a.K):c = !!a.Z;c?b.Z = a.Z:c = !!a.M;c?b.M = a.M:c = null != a.ca;var d=a.H;if(c)$c(b,a.ca);else if(c = !!a.H){if("/" != d.charAt(0))if(this.M && !this.H)d = "/" + d;else {var e=b.H.lastIndexOf("/");-1 != e && (d = b.H.substr(0,e + 1) + d);}if(".." == d || "." == d)d = "";else if(-1 != d.indexOf("./") || -1 != d.indexOf("/.")){for(var e=0 == d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g < d.length;) {var l=d[g++];"." == l?e && g == d.length && f.push(""):".." == l?((1 < f.length || 1 == f.length && "" != f[0]) && f.pop(),e && g == d.length && f.push("")):(f.push(l),e = !0);}d = f.join("/");}}c?b.H = d:c = "" !== a.a.toString();c?ad(b,bd(a.a)):c = !!a.V;c && (b.V = a.V);return b;};function Zc(a,b,c){a.K = c?cd(b,!0):b;a.K && (a.K = a.K.replace(/:$/,""));}function $c(a,b){if(b){b = Number(b);if(isNaN(b) || 0 > b)throw Error("Bad port number " + b);a.ca = b;}else a.ca = null;}function id(a){return a.H;}function ad(a,b,c){b instanceof V?a.a = b:(c || (b = dd(b,jd)),a.a = new V(b));}function cd(a,b){return a?b?decodeURI(a):decodeURIComponent(a):"";}function dd(a,b,c){return "string" == typeof a?(a = encodeURI(a).replace(b,kd),c && (a = a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null;}function kd(a){a = a.charCodeAt(0);return "%" + (a >> 4 & 15).toString(16) + (a & 15).toString(16);}var ed=/[#\/\?@]/g,gd=/[\#\?:]/g,fd=/[\#\?]/g,jd=/[\#\?@]/g,hd=/#/g;function V(a){this.b = a || null;}V.prototype.a = null;V.prototype.c = null;V.prototype.toString = function(){if(this.b)return this.b;if(!this.a)return "";var a=[],b;for(b in this.a) for(var c=encodeURIComponent(b),d=this.a[b],e=0;e < d.length;e++) {var f=c;"" !== d[e] && (f += "=" + encodeURIComponent(d[e]));a.push(f);}return this.b = a.join("&");};function bd(a){var b=new V();b.b = a.b;if(a.a){var c={},d;for(d in a.a) c[d] = a.a[d].concat();b.a = c;b.c = a.c;}return b;};var ld=1 / 15;function md(a,b,c,d,e){null !== e && (e = Math.round(e));var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};return a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$" == a)return "$";var d=f[b];if(null == d)return a;"RepresentationID" == b && c && (c = void 0);a = d.toString();c = window.parseInt(c,10) || 1;return Array(Math.max(0,c - a.length) + 1).join("0") + a;});}function nd(a,b){if(0 != b.length){var c=b[0];c.startTime <= ld && (b[0] = new w(c.position,0,c.a,c.uris,c.c,c.b));null != a && a != Number.POSITIVE_INFINITY && (c = b[b.length - 1],c.startTime > a || (b[b.length - 1] = new w(c.position,c.startTime,a,c.uris,c.c,c.b)));}}function W(a,b){if(0 == b.length)return a;var c=b.map(function(a){return new U(a);});return a.map(function(a){return new U(a);}).map(function(a){return c.map(a.resolve.bind(a));}).reduce(cb,[]).map(function(a){return a.toString();});}function od(a,b){var c=X(a,b,"timescale"),d=1;c && (d = Pc(c) || 1);c = X(a,b,"duration");(c = Pc(c || "")) && (c /= d);var e=X(a,b,"startNumber"),f=X(a,b,"presentationTimeOffset"),g=Qc(e || "");if(null == e || null == g)g = 1;var l=pd(a,b,"SegmentTimeline"),e=null;if(l){for(var e=d,h=Number(f),p=a.C.duration || Number.POSITIVE_INFINITY,l=R(l,"S"),q=[],t=0,I=0;I < l.length;++I) {var u=l[I],y=S(u,"t",Qc),Q=S(u,"d",Qc),u=S(u,"r",Oc);null != y && (y -= h);if(!Q)break;y = null != y?y:t;u = u || 0;if(0 > u)if(I + 1 < l.length){u = S(l[I + 1],"t",Qc);if(null == u)break;else if(y >= u)break;u = Math.ceil((u - y) / Q) - 1;}else {if(p == Number.POSITIVE_INFINITY)break;else if(y / e >= p)break;u = Math.ceil((p * e - y) / Q) - 1;}0 < q.length && y != t && (q[q.length - 1].end = y / e);for(var ha=0;ha <= u;++ha) t = y + Q,q.push({start:y / e,end:t / e}),y = t;}e = q;}return {qa:d,L:c,ja:g,presentationTimeOffset:Number(f) / d || 0,I:e};}function X(a,b,c){return [b(a.j),b(a.v),b(a.B)].filter(db).map(function(a){return a.getAttribute(c);}).reduce(function(a,b){return a || b;});}function pd(a,b,c){return [b(a.j),b(a.v),b(a.B)].filter(db).map(function(a){return Kc(a,c);}).reduce(function(a,b){return a || b;});};function qd(a,b){var c=pd(a,b,"Initialization");if(!c)return null;var d=a.j.G,e=c.getAttribute("sourceURL");e && (d = W(a.j.G,[e]));var e=0,f=null;if(c = S(c,"range",Nc))e = c.start,f = c.end;return new ta(d,e,f);}function rd(a,b){var c=X(a,sd,"presentationTimeOffset"),d=qd(a,sd),e;e = Number(c);var f=a.j.mimeType.split("/")[1];if("text" != a.j.contentType && "mp4" != f && "webm" != f)throw new z(4,4006);if("webm" == f && !d)throw new z(4,4005);var g=pd(a,sd,"RepresentationIndex"),l=X(a,sd,"indexRange"),h=a.j.G,l=Nc(l || "");if(g){var p=g.getAttribute("sourceURL");p && (h = W(a.j.G,[p]));l = S(g,"range",Nc,l);}if(!l)throw new z(4,4002);e = td(a,b,d,h,l.start,l.end,f,e);return {createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:d,presentationTimeOffset:Number(c) || 0};}function td(a,b,c,d,e,f,g,l){var h=a.presentationTimeline,p=a.C.start,q=a.C.duration,t=b,I=null;return {createSegmentIndex:function createSegmentIndex(){var a=[t(d,e,f),"webm" == g?t(c.uris,c.c,c.b):null];t = null;return Promise.all(a).then(function(a){var b,c,f,t=a[0];a = a[1] || null;var r=null;if("mp4" == g){a = [];var r=new Ra(new DataView(t)),u=A(r);if(1936286840 != A(r))throw new z(3,3004);1 == u && (u = Wa(r));t = Ua(r);B(r,3);B(r,4);b = A(r);if(0 == b)throw new z(3,3005);var K;0 == t?(c = A(r),K = A(r)):(c = Wa(r),K = Wa(r));B(r,2);try{var v=r.b.getUint16(r.a,r.c);}catch(xe) {Va();}r.a += 2;t = v;v = c - l;u = e + u + K;for(K = 0;K < t;K++) {f = A(r);c = (f & 2147483648) >>> 31;f &= 2147483647;var Da=A(r);B(r,4);if(1 == c)throw new z(3,3006);a.push(new w(a.length,v / b,(v + Da) / b,d,u,u + f - 1));v += Da;u += f;}r = a;}else {a = new C(new DataView(a));if(440786851 != D(a).id)throw new z(3,3008);r = D(a);if(408125543 != r.id)throw new z(3,3009);a = r.a.byteOffset;r = new C(r.a);for(b = null;Ta(r.a);) if((v = D(r),357149030 == v.id)){b = v;break;}if(!b)throw new z(3,3010);r = new C(b.a);b = 1E6;for(v = null;Ta(r.a);) if((u = D(r),2807729 == u.id))b = ab(u);else if(17545 == u.id)if((v = u,4 == v.a.byteLength))v = v.a.getFloat32(0);else if(8 == v.a.byteLength)v = v.a.getFloat64(0);else throw new z(3,3003);if(null == v)throw new z(3,3011);r = b / 1E9;b = v * r;v = D(new C(new DataView(t)));if(475249515 != v.id)throw new z(3,3007);t = [];v = new C(v.a);for(K = u = -1;Ta(v.a);) if((c = D(v),187 == c.id)){f = new C(c.a);c = D(f);if(179 != c.id)throw new z(3,3013);c = ab(c);f = D(f);if(183 != f.id)throw new z(3,3012);Da = new C(f.a);for(f = 0;Ta(Da.a);) {var Tc=D(Da);if(241 == Tc.id){f = ab(Tc);break;}}c = r * (c - l);f = a + f;0 <= u && t.push(new w(t.length,u,c,d,K,f - 1));u = c;K = f;}0 <= u && t.push(new w(t.length,u,b,d,K,null));r = t;}nd(q,r);qa(h,p,r);I = new H(r);});},findSegmentPosition:function findSegmentPosition(a){return I.b(a);},getSegmentReference:function getSegmentReference(a){return I.get(a);}};}function sd(a){return a.ha;};function ud(a,b){var c,d,e,f,g,l=qd(a,vd),h=wd(a);g = od(a,vd);e = g.ja;0 === e && (e = 1);f = 0;g.L?f = g.L * (e - 1) - g.presentationTimeOffset:g.I && 0 < g.I.length && (f = g.I[0].start);c = g.L;d = f;f = g.presentationTimeOffset;g = g.I;if(!c && !g && 1 < h.length)throw new z(4,4002);if(!c && !a.C.duration && !g && 1 == h.length)throw new z(4,4002);if(g && 0 == g.length)throw new z(4,4002);var p=null,q=null;a.B.id && a.j.id && (q = a.B.id + "," + a.j.id,p = b[q]);var t=a.C.duration,I=a.j.G,u=h.length;g && g.length != h.length && (u = Math.min(g.length,h.length));var y=[],Q=d;for(d = 0;d < u;d++) {var ha=h[d],ee=W(I,[ha.Xa]),Jb;Jb = null != c?Q + c:g?g[d].end:Q + t;y.push(new w(d + e,Q,Jb,ee,ha.start,ha.end));Q = Jb;}nd(a.C.duration,y);p?(fb(p,y),gb(p,sa(a.presentationTimeline))):(qa(a.presentationTimeline,a.C.start,y),p = new H(y),q && (b[q] = p));return {createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:p.b.bind(p),getSegmentReference:p.get.bind(p),initSegmentReference:l,presentationTimeOffset:f};}function vd(a){return a.S;}function wd(a){return [a.j.S,a.v.S,a.B.S].filter(db).map(function(a){return R(a,"SegmentURL");}).reduce(function(a,c){return 0 < a.length?a:c;}).map(function(a){var c=a.getAttribute("media");a = S(a,"mediaRange",Nc,{start:0,end:null});return {Xa:c,start:a.start,end:a.end};});};function xd(a,b,c,d){var e;(e = X(a,yd,"initialization"))?(e = md(e,a.j.id,null,a.bandwidth || null,null),e = W(a.j.G,[e]),e = new ta(e,0,null)):e = null;var f;f = od(a,yd);var g=X(a,yd,"media"),l=X(a,yd,"index");f = {L:f.L,qa:f.qa,ja:f.ja,presentationTimeOffset:f.presentationTimeOffset,I:f.I,xa:g,fa:l};g = 0 + (f.fa?1:0);g += f.I?1:0;g += f.L?1:0;if(0 == g)throw new z(4,4002);1 != g && (f.fa && (f.I = null),f.L = null);if(!f.fa && !f.xa)throw new z(4,4002);g = null;if(f.fa){c = e;d = a.j.mimeType.split("/")[1];if("mp4" != d && "webm" != d)throw new z(4,4006);if("webm" == d && !c)throw new z(4,4005);g = md(f.fa,a.j.id,null,a.bandwidth || null,null);g = W(a.j.G,[g]);g = td(a,b,c,g,0,null,d,f.presentationTimeOffset);}else if(f.L)d || (c = a.presentationTimeline,c.b = Math.max(c.b,f.L)),g = zd(a,f);else {d = b = null;a.B.id && a.j.id && (d = a.B.id + "," + a.j.id,b = c[d]);g = [];for(l = 0;l < f.I.length;l++) {var h=f.I[l].start,p=f.I[l].end,q=l + f.ja,t=md(f.xa,a.j.id,q,a.bandwidth || null,(h + f.presentationTimeOffset) * f.qa),t=W(a.j.G,[t]);g.push(new w(q,h,p,t,0,null));}nd(a.C.duration,g);b?(fb(b,g),gb(b,sa(a.presentationTimeline))):(qa(a.presentationTimeline,a.C.start,g),b = new H(g),d && (c[d] = b));g = {createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:b.b.bind(b),getSegmentReference:b.get.bind(b)};}return {createSegmentIndex:g.createSegmentIndex,findSegmentPosition:g.findSegmentPosition,getSegmentReference:g.getSegmentReference,initSegmentReference:e,presentationTimeOffset:f.presentationTimeOffset};}function yd(a){return a.ia;}function zd(a,b){var c=a.C.duration,d=b.L,e=b.ja,f=b.qa,g=b.xa,l=a.bandwidth || null,h=a.j.id,p=a.j.G;return {createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function findSegmentPosition(a){return 0 > a || c && a >= c?null:Math.floor(a / d);},getSegmentReference:function getSegmentReference(a){var b=a * d,c=md(g,h,a + e,l,b * f),c=W(p,[c]);return new w(a,b,b + d,c,0,null);}};};function Y(a){this.f = !1;this.a = [];this.b = [];this.c = [];this.h = a || null;}var jc=2;m("shaka.net.NetworkingEngine.RequestType",{MANIFEST:0,SEGMENT:1,LICENSE:jc});var Ad={};m("shaka.net.NetworkingEngine.registerScheme",function(a,b){Ad[a] = b;});m("shaka.net.NetworkingEngine.unregisterScheme",function(a){delete Ad[a];});Y.prototype.ob = function(a){this.b.push(a);};Y.prototype.registerRequestFilter = Y.prototype.ob;Y.prototype.Jb = function(a){var b=this.b;a = b.indexOf(a);0 <= a && b.splice(a,1);};Y.prototype.unregisterRequestFilter = Y.prototype.Jb;Y.prototype.Ra = function(){this.b = [];};Y.prototype.clearAllRequestFilters = Y.prototype.Ra;Y.prototype.pb = function(a){this.c.push(a);};Y.prototype.registerResponseFilter = Y.prototype.pb;Y.prototype.Kb = function(a){var b=this.c;a = b.indexOf(a);0 <= a && b.splice(a,1);};Y.prototype.unregisterResponseFilter = Y.prototype.Kb;Y.prototype.Sa = function(){this.c = [];};Y.prototype.clearAllResponseFilters = Y.prototype.Sa;function Bd(){return {maxAttempts:1,baseDelay:1E3,backoffFactor:2,fuzzFactor:.5,timeout:0};}function kc(a,b){return {uris:a,method:"GET",body:null,headers:{},allowCrossSiteCredentials:!1,retryParameters:b};}Y.prototype.s = function(){this.f = !0;this.b = [];this.c = [];for(var a=[],b=0;b < this.a.length;++b) a.push(this.a[b]["catch"](G));return Promise.all(a);};Y.prototype.request = function(a,b){if(this.f)return Promise.reject();for(var c=Date.now(),d=this.b,e=0;e < d.length;e++) try{d[e](a,b);}catch(h) {return Promise.reject(h);}for(var e=b.retryParameters || {},d=e.maxAttempts || 1,f=e.backoffFactor || 2,g=null == e.baseDelay?1E3:e.baseDelay,l=this.g(a,b,0),e=1;e < d;e++) l = l["catch"](this.i.bind(this,a,b,g,e % b.uris.length)),g *= f;this.a.push(l);return l.then((function(b){this.a.splice(this.a.indexOf(l),1);var d=Date.now();this.h && 1 == a && this.h(c,d,b.data.byteLength);return b;}).bind(this))["catch"]((function(a){this.a.splice(this.a.indexOf(l),1);return Promise.reject(a);}).bind(this));};Y.prototype.request = Y.prototype.request;Y.prototype.g = function(a,b,c){if(this.f)return Promise.reject();var d=new U(b.uris[c]),e=d.K;e || (e = location.protocol,e = e.slice(0,-1),Zc(d,e),b.uris[c] = d.toString());return (e = Ad[e])?e(b.uris[c],b).then((function(b){for(var c=this.c,d=0;d < c.length;d++) c[d](a,b);return b;}).bind(this)):Promise.reject(new z(1,1E3,d));};Y.prototype.i = function(a,b,c,d){var e=new O(),f=b.retryParameters || {};window.setTimeout(e.resolve,c * (1 + (2 * Math.random() - 1) * (null == f.fuzzFactor?.5:f.fuzzFactor)));return e.then(this.g.bind(this,a,b,d));};function Cd(){this.m = this.l = this.c = this.a = null;this.g = [];this.b = null;this.h = [];this.u = 1;this.i = {};this.o = 0;this.f = null;}k = Cd.prototype;k.configure = function(a){this.c = a;};k.start = function(a,b,c,d){this.g = [a];this.a = b;this.l = c;this.m = d;return Dd(this).then((function(){this.a && Ed(this,0);return this.b;}).bind(this));};k.stop = function(){this.c = this.m = this.l = this.a = null;this.g = [];this.b = null;this.h = [];this.i = {};null != this.f && (window.clearTimeout(this.f),this.f = null);return Promise.resolve();};function Dd(a){return a.a.request(0,kc(a.g,a.c.retryParameters)).then((function(a){if(this.a)return Fd(this,a.data,a.uri);}).bind(a));}function Fd(a,b,c){var d=Tb(b),e=new DOMParser(),f=null;b = null;try{f = e.parseFromString(d,"text/xml");}catch(q) {}f && "MPD" == f.documentElement.tagName && (b = f.documentElement);if(!b)throw new z(4,4001);c = [c];d = R(b,"Location").map(Lc).filter(db);0 < d.length && (c = a.g = d);var d=R(b,"BaseURL").map(Lc),e=W(c,d),g=S(b,"minBufferTime",T);a.o = S(b,"minimumUpdatePeriod",T,-1);f = S(b,"availabilityStartTime",Mc);c = S(b,"timeShiftBufferDepth",T);var l=S(b,"suggestedPresentationDelay",T),d=S(b,"maxSegmentDuration",T),h;a.b?h = a.b.presentationTimeline:(null != f && (f += null != l?l:5),h = new pa(f));var e=Gd(a,{presentationTimeline:h,B:null,C:null,v:null,j:null,bandwidth:void 0},e,b),p=e.periods;h.a = e.duration || Number.POSITIVE_INFINITY;h.c = null != c?c:Number.POSITIVE_INFINITY;h.b = Math.max(h.b,d || 1);if(a.b)return Promise.resolve();b = R(b,"UTCTiming");return Hd(a,b,h.aa()).then((function(a){this.a && (h.g = a,this.b = {presentationTimeline:h,periods:p,minBufferTime:g || 0});}).bind(a));}function Gd(a,b,c,d){var e=S(d,"mediaPresentationDuration",T),f=[],g=0;d = R(d,"Period");for(var l=0;l < d.length;l++) {var h=d[l],g=S(h,"start",T,g),p=S(h,"duration",T);if(null == p)if(l + 1 != d.length){var q=S(d[l + 1],"start",T);null != q && (p = q - g);}else null != e && (p = e - g);var q=a,t=b,h={start:g,duration:p,node:h};t.B = Id(h.node,null,c);t.C = h;t.B.id || (t.B.id = "__shaka_period_" + h.start);q = R(h.node,"AdaptationSet").map(q.mb.bind(q,t));if(0 == q.length)throw new z(4,4004);q = Jd(q);h = {startTime:h.start,streamSets:q};f.push(h);q = b.B.id;a.h.every(eb(q)) && (a.l(h),a.h.push(q),a.b && a.b.periods.push(h));if(null == p){g = null;break;}g += p;}return null != e?{periods:f,duration:e}:{periods:f,duration:g};}k.mb = function(a,b){a.v = Id(b,a.B,null);a.v.contentType || (a.v.contentType = a.v.mimeType.split("/")[0]);var c=!1,d=Kc(b,"Role"),e=void 0;"text" == a.v.contentType && (e = "subtitle");if(d){var f=d.getAttribute("schemeIdUri");if(null == f || "urn:mpeg:dash:role:2011" == f)switch((d = d.getAttribute("value"),d)){case "main":c = !0;break;case "caption":case "subtitle":e = d;}}var g=[];R(b,"SupplementalProperty").forEach(function(a){"http://dashif.org/descriptor/AdaptationSetSwitching" == a.getAttribute("schemeIdURI") && (a = a.getAttribute("value")) && g.push.apply(g,a.split(","));});d = R(b,"ContentProtection");d = Sc(d,this.c.dash.customScheme);e = R(b,"Representation").map(this.nb.bind(this,a,d,e));if(0 == e.length)throw new z(4,4003);a.v.contentType || (a.v.contentType = e[0].mimeType.split("/")[0]);return {id:a.v.id || "__fake__" + this.u++,contentType:a.v.contentType,language:nb(b.getAttribute("lang") || "und"),Wa:c,streams:e,drmInfos:d.drmInfos,Hb:g};};k.nb = function(a,b,c,d){a.j = Id(d,a.v,null);a.bandwidth = S(d,"bandwidth",Pc) || void 0;"text" != a.j.contentType && Kd(a.j);var e;e = this.qb.bind(this);if(a.j.ha)e = rd(a,e);else if(a.j.S)e = ud(a,this.i);else if(a.j.ia)e = xd(a,e,this.i,!!this.b);else {var f=a.j.G,g=a.C.duration || 0;e = {createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function findSegmentPosition(a){return 0 <= a && a < g?1:null;},getSegmentReference:function getSegmentReference(a){return 1 != a?null:new w(1,0,g,f,0,null);},initSegmentReference:null,presentationTimeOffset:0};}d = R(d,"ContentProtection");d = Xc(d,this.c.dash.customScheme,b);return {id:this.u++,createSegmentIndex:e.createSegmentIndex,findSegmentPosition:e.findSegmentPosition,getSegmentReference:e.getSegmentReference,initSegmentReference:e.initSegmentReference,presentationTimeOffset:e.presentationTimeOffset,mimeType:a.j.mimeType,codecs:a.j.ua,bandwidth:a.bandwidth,width:a.j.width,height:a.j.height,kind:c,encrypted:0 < b.drmInfos.length,keyId:d,allowedByApplication:!0,allowedByKeySystem:!0};};k.Eb = function(){this.f = null;var a=Date.now();Dd(this).then((function(){this.a && Ed(this,(Date.now() - a) / 1E3);}).bind(this))["catch"]((function(a){this.m(a);this.a && Ed(this,0);}).bind(this));};function Ed(a,b){0 > a.o || (a.f = window.setTimeout(a.Eb.bind(a),1E3 * Math.max(Math.max(3,a.o) - b,0)));}function Id(a,b,c){b = b || {contentType:"",mimeType:"",ua:""};c = c || b.G;var d=R(a,"BaseURL").map(Lc);return {G:W(c,d),ha:Kc(a,"SegmentBase") || b.ha,S:Kc(a,"SegmentList") || b.S,ia:Kc(a,"SegmentTemplate") || b.ia,width:S(a,"width",Qc) || b.width,height:S(a,"height",Qc) || b.height,contentType:a.getAttribute("contentType") || b.contentType,mimeType:a.getAttribute("mimeType") || b.mimeType,ua:a.getAttribute("codecs") || b.ua,id:a.getAttribute("id")};}function Jd(a){var b={};a.forEach(function(a){b[a.id] = [a];});a.forEach(function(a){var c=b[a.id];a.Hb.forEach(function(a){(a = b[a]) && a != c && (c.push.apply(c,a),a.forEach(function(a){b[a.id] = c;}));});});var c=[],d=[];J(b).forEach(function(a){if(!(0 <= d.indexOf(a))){d.push(a);var b=new L();a.forEach(function(a){b.push(a.contentType || "",a);});b.keys().forEach(function(a){var d=new L();b.get(a).forEach(function(a){d.push(a.language,a);});d.keys().forEach(function(b){var e=d.get(b);b = {language:b,type:a,primary:e.some(function(a){return a.Wa;}),drmInfos:e.map(function(a){return a.drmInfos;}).reduce(cb,[]),streams:e.map(function(a){return a.streams;}).reduce(cb,[])};c.push(b);});});}});return c;}function Kd(a){var b;b = 0 + (a.ha?1:0);b += a.S?1:0;b += a.ia?1:0;if(0 == b)throw new z(4,4002);1 != b && (a.ha && (a.S = null),a.ia = null);}function Ld(a,b,c){b = kc([b],a.c.retryParameters);b.method = c;return a.a.request(0,b).then(function(a){if("HEAD" == c){if(!a.headers || !a.headers.date)return 0;a = a.headers.date;}else a = Tb(a.data);a = Date.parse(a);return isNaN(a)?0:a - Date.now();});}function Hd(a,b,c){b = b.map(function(a){return {scheme:a.getAttribute("schemeIdUri"),value:a.getAttribute("value")};});var d=a.c.dash.clockSyncUri;c && !b.length && d && b.push({scheme:"urn:mpeg:dash:utc:http-head:2014",value:d});return bb(b,(function(a){var b=a.value;switch(a.scheme){case "urn:mpeg:dash:utc:http-head:2014":case "urn:mpeg:dash:utc:http-head:2012":return Ld(this,b,"HEAD");case "urn:mpeg:dash:utc:http-xsdate:2014":case "urn:mpeg:dash:utc:http-iso:2014":case "urn:mpeg:dash:utc:http-xsdate:2012":case "urn:mpeg:dash:utc:http-iso:2012":return Ld(this,b,"GET");case "urn:mpeg:dash:utc:direct:2014":case "urn:mpeg:dash:utc:direct:2012":return a = Date.parse(b),isNaN(a)?0:a - Date.now();case "urn:mpeg:dash:utc:http-ntp:2014":case "urn:mpeg:dash:utc:ntp:2014":case "urn:mpeg:dash:utc:sntp:2014":return Promise.reject();default:return Promise.reject();}}).bind(a))["catch"](function(){return 0;});}k.qb = function(a,b,c){a = kc(a,this.c.retryParameters);null != b && (a.headers.Range = "bytes=" + b + "-" + (null != c?c:""));return this.a.request(1,a).then(function(a){return a.data;});};na.mpd = Cd;ma["application/dash+xml"] = Cd;function Md(a,b,c,d,e,f,g,l,h){this.h = a;this.c = b;this.R = c;this.a = d;this.O = e;this.u = f;this.m = g;this.w = l || null;this.A = h || null;this.l = null;this.F = Promise.resolve();this.g = [];this.i = {};this.b = {};this.f = this.o = !1;}Md.prototype.s = function(){for(var a in this.b) Nd(this.b[a]);this.l = this.b = this.i = this.g = this.A = this.w = this.m = this.u = this.O = this.F = this.a = this.R = this.c = this.h = null;this.f = !0;return Promise.resolve();};Md.prototype.configure = function(a){this.l = a;this.h.i = Math.max(this.a.minBufferTime || 0,this.l.rebufferingGoal);};Md.prototype.init = function(){var a=this.O(this.a.periods[Od(this,vb(this.h))]);return a && 0 != Object.keys(a).length?Pd(this,a).then((function(){this.w && this.w();}).bind(this)):Promise.reject(new z(5,5005));};function Qd(a){return a.a.periods[Od(a,vb(a.h))];}function Rd(a){return pb(a.b,function(a){return a.stream;});}function Sd(a,b){var c={};c.text = b;return Pd(a,c);}function Td(a,b,c,d){if(b = a.b[b]){var e=a.g[Ud(a,c)];e && e.da && (e = a.i[c.id]) && e.da && b.stream != c && (b.stream = c,b.ya = !0,!d || b.P || b.U || (b.ba?b.P = !0:(Nd(b),Vd(a,b))));}}function Pd(a,b){var c=Od(a,vb(a.h)),d=pb(b,function(a){return a.mimeType + (a.codecs?'; codecs="' + a.codecs + '"':"");});a.c.init(d);Wd(a);d = J(b);return Xd(a,d).then((function(){for(var a in b) {var d=b[a];this.b[a] || (this.b[a] = {stream:d,type:a,W:null,J:null,ya:!0,ga:!1,oa:c,endOfStream:!1,ba:!1,T:null,P:!1,U:!1},Yd(this,this.b[a],0));}}).bind(a));}function Zd(a,b){var c=a.g[b];if(c)return c.D;c = {D:new O(),da:!1};a.g[b] = c;var d=a.a.periods[b].streamSets.map(function(a){return a.streams;}).reduce(cb,[]);a.F = a.F.then((function(){if(!this.f)return Xd(this,d);}).bind(a)).then((function(){this.f || (this.g[b].D.resolve(),this.g[b].da = !0);}).bind(a))["catch"]((function(a){this.f || (this.g[b].D.reject(),delete this.g[b],this.m(a));}).bind(a));return c.D;}function Xd(a,b){for(var c=[],d=0;d < b.length;++d) {var e=b[d],f=a.i[e.id];f?c.push(f.D):(a.i[e.id] = {D:new O(),da:!1},c.push(e.createSegmentIndex()));}return Promise.all(c).then((function(){if(!this.f)for(var a=0;a < b.length;++a) {var c=this.i[b[a].id];c.da || (c.D.resolve(),c.da = !0);}}).bind(a))["catch"]((function(a){if(!this.f)return this.i[e.id].D.reject(),delete this.i[e.id],Promise.reject(a);}).bind(a));}function Wd(a){var b=a.a.presentationTimeline.a;b < Number.POSITIVE_INFINITY?Ob(a.c,b):Ob(a.c,Math.pow(2,32));}Md.prototype.$ = function(a){if(!this.f && !a.ba && null != a.T && !a.U)if((a.T = null,a.P))Vd(this,a);else {try{var b=$d(this,a);null != b && Yd(this,a,b);}catch(c) {this.m(c);return;}b = J(this.b);yb(this.h,b.some(function(a){return a.ga;}));ae(this,a);b.every(function(a){return a.endOfStream;}) && this.c.endOfStream();}};function $d(a,b){var c=vb(a.h),d=Fb(a.c,b.type,c),e=Math.max(a.a.minBufferTime || 0,a.l.rebufferingGoal);if(d >= Math.max(e,a.l.bufferingGoal))return b.ga = !1,.5;var f=a.c,g=b.type;f = "text" == g?f.b.a:(f = f.c[g].buffered)?f.length?f.end(f.length - 1):null:null;if(0 == d && null == f){if(null != b.W || b.J)throw new z(5,5E3,b.type);f = c;}else {if(null == b.W || null == b.J)throw new z(5,5E3,b.type);f = a.a.periods[Ud(a,b.W)].startTime + b.J.a;}if(f >= a.a.presentationTimeline.a)return b.ga = !1,b.endOfStream = !0,null;b.endOfStream = !1;!a.o && d < e || 1 >= d?b.ga = !0:d >= e && (b.ga = !1);d = Ud(a,b.stream);e = Od(a,f);if(e != d)return b.oa = e,null;b.J && b.stream == b.W?(e = b.J.position + 1,e = be(a,b,d,e)):(e = b.J?b.stream.findSegmentPosition(Math.max(0,a.a.periods[Ud(a,b.W)].startTime + b.J.a - a.a.periods[d].startTime)):b.stream.findSegmentPosition(Math.max(0,c - a.a.periods[d].startTime)),e = null == e?null:be(a,b,d,Math.max(0,e - 1)) || be(a,b,d,e));if(!e)return 1;ce(a,b,c,d,e);return null;}function be(a,b,c,d){c = a.a.periods[c];b = b.stream.getSegmentReference(d);if(!b)return null;a = a.a.presentationTimeline;d = n(a);return c.startTime + b.a < sa(a) || c.startTime + b.startTime > d?null:b;}function ce(a,b,c,d,e){var f=b.stream,g=a.a.periods[d + 1],l=null,l=g?g.startTime:a.a.presentationTimeline.a;d = de(a,b,d,l);b.ba = !0;b.ya = !1;g = fe(a,e);Promise.all([d,g]).then((function(a){if(!this.f)return ge(this,b,c,f,e,a[1]);}).bind(a)).then((function(){b.ba = !1;Yd(this,b,0);this.f || he(this,f);}).bind(a))["catch"]((function(a){this.f || this.m(a);}).bind(a));}function de(a,b,c,d){if(!b.ya)return Promise.resolve();c = Kb(a.c,b.type,a.a.periods[c].startTime - b.stream.presentationTimeOffset);d = null != d?Mb(a.c,b.type,d):Promise.resolve();if(!b.stream.initSegmentReference)return Promise.all([c,d]);a = fe(a,b.stream.initSegmentReference).then((function(a){if(!this.f)return Gb(this.c,b.type,a,null,null);}).bind(a));return Promise.all([c,d,a]);}function ge(a,b,c,d,e,f){return ie(a,b,c).then((function(){if(!this.f)return Gb(this.c,b.type,f,e.startTime,e.a);}).bind(a)).then((function(){if(!this.f)return b.W = d,b.J = e,Promise.resolve();}).bind(a));}function ie(a,b,c){var d=Eb(a.c,b.type);if(null == d)return Promise.resolve();c = c - d - a.l.bufferBehind;return 0 >= c?Promise.resolve():Ib(a.c,b.type,d,d + c).then((function(){}).bind(a));}function he(a,b){if(!a.o && (a.o = J(a.b).every(function(a){return !a.P && !a.U && a.J;}),a.o)){var c=Ud(a,b);a.g[c] || Zd(a,c).then((function(){this.u();}).bind(a))["catch"](G);for(c = 0;c < a.a.periods.length;++c) Zd(a,c)["catch"](G);a.A && a.A();}}function ae(a,b){if(b.oa != Ud(a,b.stream)){var c=b.oa,d=J(a.b);d.every(function(a){return a.oa == c;}) && d.every(je) && Zd(a,c).then((function(){if(!this.f){var a=this.O(this.a.periods[c]),b;for(b in this.b) if(!a[b]){this.m(new z(5,5005));return;}for(b in a) if(!this.b[b]){this.m(new z(5,5005));return;}for(b in this.b) {Td(this,b,a[b]);var d=this.b[b];je(d) && Yd(this,d,0);}this.u();}}).bind(a))["catch"](G);}}function je(a){return !a.ba && null == a.T && !a.P && !a.U;}function Od(a,b){for(var c=a.a.periods.length - 1;0 < c;--c) if(b >= a.a.periods[c].startTime)return c;return 0;}function Ud(a,b){for(var c=0;c < a.a.periods.length;++c) for(var d=a.a.periods[c],e=0;e < d.streamSets.length;++e) if(0 <= d.streamSets[e].streams.indexOf(b))return c;return -1;}function fe(a,b){var c=kc(b.uris,a.l.retryParameters);if(0 != b.c || null != b.b){var d="bytes=" + b.c + "-";null != b.b && (d += b.b);c.headers.Range = d;}return a.R.request(1,c).then(function(a){return a.data;});}function Vd(a,b){b.P = !1;b.U = !0;a.c.clear(b.type).then((function(){this.f || (b.W = null,b.J = null,b.U = !1,Yd(this,b,0));}).bind(a));}function Yd(a,b,c){b.T = window.setTimeout(a.$.bind(a,b),1E3 * c);}function Nd(a){null != a.T && (window.clearTimeout(a.T),a.T = null);};Ad.data = function(a){return new Promise(function(b){var c=a.split(":");if(2 > c.length || "data" != c[0])throw new z(1,1004,a);c = c.slice(1).join(":").split(",");if(2 > c.length)throw new z(1,1004,a);var d=c[0],c=window.decodeURIComponent(c.slice(1).join(",")),d=d.split(";"),e=null;1 < d.length && (e = d[1]);if("base64" == e)c = Zb(c).buffer;else {if(e)throw new z(1,1005,a);c = Ub(c);}b({uri:a,data:c,headers:{}});});};function ke(a,b){return new Promise(function(c,d){var e=new XMLHttpRequest();e.open(b.method,a,!0);e.responseType = "arraybuffer";e.timeout = b.retryParameters.timeout;e.withCredentials = b.allowCrossSiteCredentials;e.onload = function(b){b = b.target;if(200 <= b.status && 299 >= b.status){var e=b.getAllResponseHeaders().split("\r\n").reduce(function(a,b){var c=b.split(": ");a[c[0].toLowerCase()] = c.slice(1).join(": ");return a;},{});b.sb && (a = b.sb);c({uri:a,data:b.response,headers:e});}else {e = null;try{e = Tb(b.response);}catch(f) {}d(new z(1,1001,a,b.status,e));}};e.onerror = function(){d(new z(1,1002,a));};e.ontimeout = function(){d(new z(1,1003,a));};for(var f in b.headers) e.setRequestHeader(f,b.headers[f]);e.send(b.body);});}Ad.http = ke;Ad.https = ke;function Z(a){this.w = new L();this.c = a;this.i = null;this.u = new M();this.Ea = new ja();this.m = new Y(this.Db.bind(this));this.f = this.o = this.b = this.h = this.la = this.O = this.A = this.g = null;this.Oa = 1E9;this.sa = !1;this.F = !0;this.na = !1;this.l = {};this.a = le(this);this.R = [];this.ka = this.$ = this.ma = 0;this.la = me(this);for(a = 0;a < this.c.textTracks.length;++a) {var b=this.c.textTracks[a];b.mode = "disabled";"Shaka Player TextTrack" == b.label && (this.i = b);}this.i || (this.i = this.c.addTextTrack("subtitles","Shaka Player TextTrack"));this.i.mode = "hidden";N(this.u,this.c,"error",this.gb.bind(this));}ba(Z);m("shaka.Player",Z);Z.prototype.s = function(){var a=Promise.all([ne(this),this.u?this.u.s():null,this.m?this.m.s():null]);this.a = this.m = this.Ea = this.u = this.i = this.c = null;return a;};Z.prototype.destroy = Z.prototype.s;Z.version = "v2.0.0-beta2";Z.support = function(){if(window.Promise && window.Uint8Array && Array.prototype.forEach){var a=oa(),b=Db();return mc().then(function(c){return {manifest:a,media:b,drm:c,supported:a.basic && b.basic && c.basic};});}return {then:function then(a){a({supported:!1});}};};Z.prototype.load = function(a,b,c){var d=c;c = Promise.resolve();var e;d || (e = id(new U(a)).split("/").pop().split("."),1 < e.length && (e = e.pop().toLowerCase(),d = na[e]));d || (c = kc([a],this.a.manifest.retryParameters),c.method = "HEAD",c = this.m.request(0,c).then(function(b){(b = b.headers["content-type"]) && (b = b.toLowerCase());d = ma[b];if(!d)return Promise.reject(new z(4,4E3,a));},function(){return Promise.reject(new z(4,4E3,a));}));c = c.then((function(){this.o = new d();this.o.configure(this.a.manifest);return this.o.start(a,this.m,this.Ba.bind(this),this.ea.bind(this));}).bind(this)).then((function(a){this.f = a;this.ka = Date.now() / 1E3;}).bind(this));e = Promise.resolve();this.c.src && (e = this.Na());this.na = !0;return Promise.all([e,c]).then((function(){this.g = new bc(this.m,this.ea.bind(this),this.Bb.bind(this));this.g.configure(this.a.drm);return this.g.init(this.f,!1);}).bind(this)).then((function(){this.f.periods.forEach(this.Ba.bind(this));return Promise.all([ec(this.g,this.c),this.la]);}).bind(this)).then((function(){this.h = new ub(this.c,this.f.presentationTimeline,Math.max(this.f.minBufferTime || 0,this.a.streaming.rebufferingGoal),b || null,this.zb.bind(this),this.Cb.bind(this));this.O = new Cb(this.c,this.A,this.i);this.b = new Md(this.h,this.O,this.m,this.f,this.Ab.bind(this),this.Pa.bind(this),this.ea.bind(this));this.b.configure(this.a.streaming);return this.b.init();}).bind(this)).then((function(){this.f.periods.forEach(this.Ba.bind(this));oe(this);pe(this);this.na = !1;this.a.abr.manager.init(this.Ca.bind(this));}).bind(this))["catch"](function(a){this.na = !1;return Promise.reject(a);});};Z.prototype.load = Z.prototype.load;function me(a){a.A = new MediaSource();var b=new O();N(a.u,a.A,"sourceopen",b.resolve);a.c.src = window.URL.createObjectURL(a.A);return b;}Z.prototype.configure = function(a){var b=a.preferredAudioLanguage?a.preferredAudioLanguage !== this.a.preferredAudioLanguage:!1,c=a.preferredTextLanguage?a.preferredTextLanguage !== this.a.preferredTextLanguage:!1;a.abr && a.abr.manager && a.abr.manager != this.a.abr.manager && (this.a.abr.manager.stop(),a.abr.manager.init(this.Ca.bind(this)));qe(this,this.a,a,le(this),"");re(this,b,c);};Z.prototype.configure = Z.prototype.configure;function re(a,b,c){a.o && a.o.configure(a.a.manifest);a.g && a.g.configure(a.a.drm);if(a.b){a.b.configure(a.a.streaming);a.f.periods.forEach(a.Fa.bind(a));var d=se(a,Qd(a.b)),e=Rd(a.b),d=qb(d,function(a){return "audio" == a && b || "text" == a && c || e[a] && (!e[a].allowedByApplication || !e[a].allowedByKeySystem);});te(a,d,!0);}a.a.abr.enabled && !a.F?a.a.abr.manager.enable():a.a.abr.manager.disable();a.a.abr.manager.setDefaultEstimate(a.a.abr.defaultBandwidthEstimate);}Z.prototype.getConfiguration = function(){var a=le(this);qe(this,a,this.a,le(this),"");return a;};Z.prototype.getConfiguration = Z.prototype.getConfiguration;Z.prototype.rb = function(){var a=le(this),b=a.preferredAudioLanguage?a.preferredAudioLanguage !== this.a.preferredAudioLanguage:!1,c=a.preferredTextLanguage?a.preferredTextLanguage !== this.a.preferredTextLanguage:!1;a.abr && a.abr.manager && a.abr.manager != this.a.abr.manager && (this.a.abr.manager.stop(),a.abr.manager.init(this.Ca.bind(this)));this.a = le(this);re(this,b,c);};Z.prototype.resetConfiguration = Z.prototype.rb;Z.prototype.Ta = function(){return this.m;};Z.prototype.getNetworkingEngine = Z.prototype.Ta;Z.prototype.aa = function(){return this.f?this.f.presentationTimeline.aa():!1;};Z.prototype.isLive = Z.prototype.aa;Z.prototype.ub = function(){var a=0,b=0;this.f && (b = this.f.presentationTimeline,a = sa(b),b = n(b));return {start:a,end:b};};Z.prototype.seekRange = Z.prototype.ub;Z.prototype.Ua = function(){return this.sa;};Z.prototype.isBuffering = Z.prototype.Ua;Z.prototype.Na = function(){return ne(this).then((function(){this.la = me(this);}).bind(this));};Z.prototype.unload = Z.prototype.Na;Z.prototype.va = function(){return this.h?this.h.va():0;};Z.prototype.getPlaybackRate = Z.prototype.va;Z.prototype.Ib = function(a){this.h && zb(this.h,a);};Z.prototype.trickPlay = Z.prototype.Ib;Z.prototype.Qa = function(){this.h && zb(this.h,1);};Z.prototype.cancelTrickPlay = Z.prototype.Qa;Z.prototype.getTracks = function(){if(!this.b)return [];var a=Rd(this.b);return Qd(this.b).streamSets.map(function(b){var c=a[b.type];return b.streams.filter(function(a){return a.allowedByApplication && a.allowedByKeySystem;}).map(function(a){return {id:a.id,active:c == a,type:b.type,bandwidth:a.bandwidth,language:b.language,kind:a.kind || null,width:a.width || null,height:a.height || null};});}).reduce(cb,[]);};Z.prototype.getTracks = Z.prototype.getTracks;Z.prototype.vb = function(a,b){if(this.b){var c;Qd(this.b).streamSets.forEach(function(b){b.streams.forEach(function(b){b.id == a.id && (c = b);});});if(c && c.allowedByApplication && c.allowedByKeySystem){this.R.push({timestamp:Date.now() / 1E3,id:c.id,type:a.type,fromAdaptation:!1});"text" != a.type && this.configure({abr:{enabled:!1}});var d={};d[a.type] = c;te(this,d,b);}}};Z.prototype.selectTrack = Z.prototype.vb;Z.prototype.Va = function(){return "showing" == this.i.mode;};Z.prototype.isTextTrackVisible = Z.prototype.Va;Z.prototype.xb = function(a){this.i.mode = a?"showing":"hidden";ue(this);};Z.prototype.setTextTrackVisibility = Z.prototype.xb;Z.prototype.getStats = function(){ve(this);var a={},b={},c=this.c && this.c.getVideoPlaybackQuality?this.c.getVideoPlaybackQuality():{};this.b && (b = Rd(this.b),a = b.video || {},b = b.audio || {});return {width:a.width || 0,height:a.height || 0,streamBandwidth:a.bandwidth + b.bandwidth || 0,decodedFrames:Number(c.totalVideoFrames),droppedFrames:Number(c.droppedVideoFrames),estimatedBandwidth:this.a.abr.manager.getBandwidthEstimate(),playTime:this.ma,bufferingTime:this.$,switchHistory:this.R.slice(0)};};Z.prototype.getStats = Z.prototype.getStats;Z.prototype.addTextTrack = function(a,b,c,d,e){if(!this.b)return Promise.reject();for(var f=Qd(this.b),g,l=0;l < this.f.periods.length;l++) if(this.f.periods[l] == f){if(l == this.f.periods.length - 1){if((g = this.f.presentationTimeline.a - f.startTime,g == Number.POSITIVE_INFINITY))return Promise.reject();}else g = this.f.periods[l + 1].startTime - f.startTime;break;}var h={id:this.Oa++,createSegmentIndex:Promise.resolve.bind(Promise),findSegmentPosition:function findSegmentPosition(){return 1;},getSegmentReference:function getSegmentReference(b){return 1 != b?null:new w(1,0,g,[a],0,null);},initSegmentReference:null,presentationTimeOffset:0,mimeType:d,codecs:e || "",bandwidth:0,kind:c,encrypted:!1,keyId:null,allowedByApplication:!0,allowedByKeySystem:!0},p={language:b,type:"text",primary:!1,drmInfos:[],streams:[h]};return Sd(this.b,h).then((function(){f.streamSets.push(p);se(this,f).text == h && te(this,{text:h});this.a.abr.enabled && !this.F?this.a.abr.manager.enable():this.a.abr.manager.disable();oe(this);return {id:h.id,active:!1,type:"text",bandwidth:0,language:b,kind:c,width:null,height:null};}).bind(this));};Z.prototype.addTextTrack = Z.prototype.addTextTrack;function ne(a){a.u && a.u.Y(a.A,"sourceopen");a.c && (a.c.removeAttribute("src"),a.c.load());var b=Promise.all([a.a.abr.manager.stop(),a.g?a.g.s():null,a.O?a.O.s():null,a.h?a.h.s():null,a.b?a.b.s():null,a.o?a.o.stop():null]);a.g = null;a.O = null;a.h = null;a.b = null;a.o = null;a.f = null;a.la = null;a.A = null;a.l = {};a.R = [];a.ma = 0;a.$ = 0;return b;}function we(a){return a.streams.some(function(a){return a.allowedByApplication && a.allowedByKeySystem;});}function qe(a,b,c,d,e){var f=!!({".drm.servers":!0,".drm.clearKeys":!0,".drm.advanced":!0})[e],g=({".drm.servers":"string",".drm.clearKeys":"string"})[e] || "",l=({".drm.advanced":{distinctiveIdentifierRequired:!1,persistentStateRequired:!1,videoRobustness:"",audioRobustness:"",serverCertificate:null}})[e],h;for(h in c) {var p=e + "." + h,q=d[h];l && (q = l);var t=!!({".abr.manager":!0})[p];(f || h in b) && (void 0 === c[h]?void 0 === q?delete b[h]:b[h] = q:t?b[h] = c[h]:"object" == typeof b[h] && "object" == typeof c[h]?qe(a,b[h],c[h],q,p):(f || typeof c[h] == typeof b[h]) && (g && typeof c[h] != g || "function" == typeof b[h] && b[h].length != c[h].length || (b[h] = c[h])));}}function le(a){return {drm:{retryParameters:Bd(),servers:{},clearKeys:{},advanced:{}},manifest:{retryParameters:Bd(),dash:{customScheme:function customScheme(a){if(a)return null;},clockSyncUri:""}},streaming:{retryParameters:Bd(),rebufferingGoal:2,bufferingGoal:30,bufferBehind:30},abr:{manager:a.Ea,enabled:!0,defaultBandwidthEstimate:5E5},preferredAudioLanguage:"",preferredTextLanguage:"",restrictions:{minWidth:0,maxWidth:Number.POSITIVE_INFINITY,minHeight:0,maxHeight:Number.POSITIVE_INFINITY,minPixels:0,maxPixels:Number.POSITIVE_INFINITY,minAudioBandwidth:0,maxAudioBandwidth:Number.POSITIVE_INFINITY,minVideoBandwidth:0,maxVideoBandwidth:Number.POSITIVE_INFINITY}};}k = Z.prototype;k.Fa = function(a){var b=this.a.restrictions,c=!1;a.streamSets.forEach(function(a){a.streams.forEach(function(e){var f=e.allowedByApplication;e.allowedByApplication = !0;if("video" == a.type){if(e.width < b.minWidth || e.width > b.maxWidth || e.height < b.minHeight || e.height > b.maxHeight || e.width * e.height < b.minPixels || e.width * e.height > b.maxPixels || e.bandwidth < b.minVideoBandwidth || e.bandwidth > b.maxVideoBandwidth)e.allowedByApplication = !1;}else "audio" == a.type && (e.bandwidth < b.minAudioBandwidth || e.bandwidth > b.maxAudioBandwidth) && (e.allowedByApplication = !1);f != e.allowedByApplication && (c = !0);});});c && oe(this);};k.Ba = function(a){var b="",c=null;this.g && this.g.u && (b = this.g.keySystem(),c = this.g.m);var d={};this.b && (d = Rd(this.b));for(var e=0;e < a.streamSets.length;++e) {var f=a.streamSets[e];if(b && 0 != f.drmInfos.length && !f.drmInfos.some(function(a){return a.keySystem == b;}))a.streamSets.splice(e,1),--e;else {for(var g=d[f.type],l=0;l < f.streams.length;++l) {var h=f.streams[l];if(g && "text" != f.type && h.mimeType != g.mimeType)f.streams.splice(l,1),--l;else {var p=h.mimeType;h.codecs && (p += '; codecs="' + h.codecs + '"');ib[p] || MediaSource.isTypeSupported(p)?c && h.encrypted && 0 > c.indexOf(p) && (f.streams.splice(l,1),--l):(f.streams.splice(l,1),--l);}}0 == f.streams.length && (a.streamSets.splice(e,1),--e);}}this.Fa(a);a.streamSets.some(we) || this.ea(new z(4,4011));};function te(a,b,c){for(var d in b) {var e=b[d],f=c || "text" == d;a.F?a.l[d] = {stream:e,clear:f}:Td(a.b,d,e,f);}}function ve(a){if(a.f){var b=Date.now() / 1E3;a.sa?a.$ += b - a.ka:a.ma += b - a.ka;a.ka = b;}}k.Db = function(a,b,c){this.a.abr.manager.segmentDownloaded(a,b,c);};k.zb = function(a){ve(this);this.sa = a;this.dispatchEvent(new F("buffering",{buffering:a}));};k.Cb = function(){if(this.b){var a=this.b,b;for(b in a.b) {var c=a.b[b];c.U || (0 < Fb(a.c,b,vb(a.h))?c.P = !1:c.P || (c.ba?c.P = !0:null == Eb(a.c,b)?null == c.T && Yd(a,c,0):(Nd(c),Vd(a,c))));}}};function se(a,b){var c={};b.streamSets.forEach(function(a){!we(a) || a.type in c || (c[a.type] = a);});b.streamSets.forEach(function(a){we(a) && a.primary && (c[a.type] = a);});var d={audio:!1,text:!1};[2,1,0].forEach((function(a){b.streamSets.forEach((function(b){if(we(b)){var e;"audio" == b.type?e = this.a.preferredAudioLanguage:"text" == b.type && (e = this.a.preferredTextLanguage);if(e){e = nb(e);var h=nb(b.language);if(h == e || 1 <= a && h == e.split("-")[0] || 2 <= a && h.split("-")[0] == e.split("-")[0])d[b.type] = !0,c[b.type] = b;}}}).bind(this));}).bind(a));J(c).some(we) || a.ea(new z(4,4012));var e=a.a.abr.manager.chooseStreams(c);c.text && (e.text = c.text.streams[0],c.audio && d.text && c.text.language != c.audio.language && (a.i.mode = "showing",ue(a)));return e;}k.Ab = function(a){this.F = !0;a = se(this,a);for(var b in this.l) a[b] = this.l[b].stream;this.l = {};for(b in a) this.R.push({timestamp:Date.now() / 1E3,id:a[b].id,type:b,fromAdaptation:!0});this.na || oe(this);return a;};k.Pa = function(){this.F = !1;this.a.abr.enabled && this.a.abr.manager.enable();for(var a in this.l) {var b=this.l[a];Td(this.b,a,b.stream,b.clear);}this.l = {};};k.Ca = function(a){var b=Rd(this.b),c;for(c in a) {var d=a[c];b[c] != d && this.R.push({timestamp:Date.now() / 1E3,id:d.id,type:c,fromAdaptation:!0});}if(this.b){for(c in a) Td(this.b,c,a[c]);pe(this);}};function pe(a){Promise.resolve().then((function(){this.c && this.dispatchEvent(new F("adaptation"));}).bind(a));}function oe(a){Promise.resolve().then((function(){this.c && this.dispatchEvent(new F("trackschanged"));}).bind(a));}function ue(a){a.dispatchEvent(new F("texttrackvisibility"));}k.ea = function(a){this.dispatchEvent(new F("error",{detail:a}));};k.gb = function(){if(this.c.error){var a=this.c.error.code;if(1 != a){var b=this.c.error.msExtendedCode;b && (0 > b && (b += Math.pow(2,32)),b = b.toString(16));this.ea(new z(3,3016,a,b));}}};k.Bb = function(a){var b=["usable","status-pending","output-downscaled"],c=Qd(this.b),d=!1;c.streamSets.forEach(function(c){c.streams.forEach(function(c){var e=c.allowedByKeySystem;c.keyId && c.keyId in a && (c.allowedByKeySystem = 0 <= b.indexOf(a[c.keyId]));e != c.allowedByKeySystem && (d = !0);});});c = se(this,c);this.a.abr.enabled && !this.F && this.a.abr.manager.enable();var e=Rd(this.b),c=qb(c,function(a){return e[a] && !e[a].allowedByKeySystem;});te(this,c,!0);d && oe(this);};}).call(g,this);if(typeof module != "undefined" && module.exports)module.exports = g.shaka;else if(true)!(__WEBPACK_AMD_DEFINE_RESULT__ = function(){return g.shaka;}.call(exports, __webpack_require__, exports, module), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));else this.shaka = g.shaka;})();

/***/ }
/******/ ])
});
;